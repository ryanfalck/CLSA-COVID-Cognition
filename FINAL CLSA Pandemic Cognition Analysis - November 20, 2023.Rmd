---
title: "Pandemic associated changes in cognition from the CLSA Comprehensive Cohort"
author: "Ryan Stanley Falck"
date: "`r Sys.Date()`"
output: 
  html_document:
    toc: true
    theme: united
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 1) Data Processing

NOTE: This includes all the set-up and processing for the CLSA Comprehensive cohort data

## 1.1) Set-up
```{r}
if (!require("pacman")) install.packages("pacman")
pacman::p_load(MASS,plyr,ggplot2,lme4,nlme, rms,dplyr, lubridate, effects,
               lmerTest,rpart,tableone,psych,Hmisc,magrittr, ggeffects,sjmisc,splines,
               lsmeans,openxlsx)

set.seed(1)

setwd("~/Desktop/UBC-Postdoctoral Fellowship/CLSA - COVID Brain/Data")
```


## 1.2) Tracking Cohort

### 1.2.1) Baseline processing

```{r}
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
#Baseline (Non-Cogs)
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#

setwd("~/Desktop/UBC-Postdoctoral Fellowship/CLSA - COVID Brain/Data/23SP001_McMaster_PRaina_BL")

trackBL<-read.csv("23SP001_McMaster_PRaina_Baseline_Trav4.csv")#Comprehensive Cohort Baseline

track.BL<-trackBL[c(1:5,104,926,798,106,892,921,32,1363,1377,1378,1379,1380,1407,1408,1433,1466,1432,1465,
                    1480,1481:1488,893,928,1093,1094,1096,1125,1124,376,1086,1089,1097:1102,1105,1106,
                    1129,1132,1133,1077,1076,1075,1078,1079,1085,1082,1130,1087,1090,1088,1131,1091,1080,
                    1128,1095,1081,334)]

#Sex
track.BL$Sex<-track.BL$SEX_ASK_TRM

#Age
track.BL$Age<-track.BL$AGE_NMBR_TRM

#Marital Status
track.BL$Relationship_status<-NA
track.BL$Relationship_status[track.BL$SDC_MRTL_TRM==1]<-"Single"
track.BL$Relationship_status[track.BL$SDC_MRTL_TRM==2]<-"Married"
track.BL$Relationship_status[track.BL$SDC_MRTL_TRM==3]<-"Widowed"
track.BL$Relationship_status[track.BL$SDC_MRTL_TRM==4]<-"Divorced"
track.BL$Relationship_status[track.BL$SDC_MRTL_TRM==5]<-"Separated"

#Education 4 Category
track.BL$Education4<-NA
track.BL$Education4[track.BL$ED_UDR04_TRM==1]<-"Less than High School Diploma"
track.BL$Education4[track.BL$ED_UDR04_TRM==2]<-"High School Diploma"
track.BL$Education4[track.BL$ED_UDR04_TRM==3]<-"Some College"
track.BL$Education4[track.BL$ED_UDR04_TRM==4]<-"College Degree or Higher"


#Household Income
track.BL$Income_Level<-NA
track.BL$Income_Level[track.BL$INC_PTOT_TRM==1]<-"<$20k"
track.BL$Income_Level[track.BL$INC_PTOT_TRM==2]<-"$20-50k"
track.BL$Income_Level[track.BL$INC_PTOT_TRM==3]<-"$50-100k"
track.BL$Income_Level[track.BL$INC_PTOT_TRM==4]<-"$100-150k"
track.BL$Income_Level[track.BL$INC_PTOT_TRM==5]<-">$150k"

#Living Status
track.BL$Living_status<-NA
track.BL$Living_status[track.BL$OWN_DWLG_TRM==1]<-"House"
track.BL$Living_status[track.BL$OWN_DWLG_TRM==2 |track.BL$OWN_DWLG_TRM==6]<-"Apartment/Condo/Townhome"
track.BL$Living_status[track.BL$OWN_DWLG_TRM==3]<-"Assisted Living"
track.BL$Living_status[track.BL$OWN_DWLG_TRM==4 | track.BL$OWN_DWLG_TRM==5 | track.BL$OWN_DWLG_TRM>=7]<-"Other"

#Alcohol      
track.BL$Alcohol<-NA
track.BL$Alcohol[track.BL$ALC_TTM_TRM==1]<-"Regular drinker (at least once a month)"
track.BL$Alcohol[track.BL$ALC_TTM_TRM==2]<-"Occasional drinker"
track.BL$Alcohol[track.BL$ALC_TTM_TRM==3]<-"Non-drinker"

#Smoking Status
track.BL$Smoking_Status<-NA
track.BL$Smoking_Status[track.BL$SMK_DSTY_TRM==1]<-"Daily Smoker"
track.BL$Smoking_Status[track.BL$SMK_DSTY_TRM==2 |track.BL$SMK_DSTY_TRM==3]<-"Occasional Smoker"
track.BL$Smoking_Status[track.BL$SMK_DSTY_TRM==4 | track.BL$SMK_DSTY_TRM==5]<-"Former Smoker"
track.BL$Smoking_Status[track.BL$SMK_DSTY_TRM==6]<-"Never Smoked"

track.BL$Ethnicity<-NA
track.BL$Ethnicity[track.BL$SDC_CULT_WH_TRM==1]<-"White"
track.BL$Ethnicity[track.BL$SDC_CULT_WH_TRM==0]<-"Other"

#############Physical Activity Scale for the Elderly######################
#Q1: Sitting Activity Frequency in Past 7 days
track.BL$PASE_Q1<-NA
track.BL$PASE_Q1[track.BL$PA2_SIT_MCQ==1]<-0
track.BL$PASE_Q1[track.BL$PA2_SIT_MCQ==2]<-0.11
track.BL$PASE_Q1[track.BL$PA2_SIT_MCQ==3]<-0.25
track.BL$PASE_Q1[track.BL$PA2_SIT_MCQ==4]<-0.43
track.BL$PASE_Q1[track.BL$PA2_SIT_MCQ>4]<-NA
track.BL$PASE_Q1[is.na(track.BL$PA2_SIT_MCQ)]<-NA

track.BL$PASE_Q1B<-NA
track.BL$PASE_Q1B[track.BL$PA2_SITHR_MCQ==1]<-0
track.BL$PASE_Q1B[track.BL$PA2_SITHR_MCQ==2]<-1
track.BL$PASE_Q1B[track.BL$PA2_SITHR_MCQ==3]<-3
track.BL$PASE_Q1B[track.BL$PA2_SITHR_MCQ==4]<-6
track.BL$PASE_Q1B[track.BL$PA2_SITHR_MCQ==5]<-10
track.BL$PASE_Q1B[track.BL$PA2_SITHR_MCQ>5]<- 0
track.BL$PASE_Q1B[is.na(track.BL$PA2_SITHR_MCQ)]<-NA
track.BL$PASE_Q1B<-as.numeric(track.BL$PASE_Q1B)

#Q2: Walking outside frequency
track.BL$PASE_Q2<- NULL
track.BL$PASE_Q2[track.BL$PA2_WALK_MCQ==1]<-0
track.BL$PASE_Q2[track.BL$PA2_WALK_MCQ==2]<-0.11
track.BL$PASE_Q2[track.BL$PA2_WALK_MCQ==3]<-0.25
track.BL$PASE_Q2[track.BL$PA2_WALK_MCQ==4]<-0.43
track.BL$PASE_Q2[track.BL$PA2_WALK_MCQ>4]<-NA
track.BL$PASE_Q2[is.na(track.BL$PA2_WALK_MCQ)]<-NA

track.BL$PASE_Q2A<- NA
track.BL$PASE_Q2A[track.BL$PA2_WALKHR_MCQ==1]<-0
track.BL$PASE_Q2A[track.BL$PA2_WALKHR_MCQ==2]<-1
track.BL$PASE_Q2A[track.BL$PA2_WALKHR_MCQ==3]<-3
track.BL$PASE_Q2A[track.BL$PA2_WALKHR_MCQ==4]<-6
track.BL$PASE_Q2A[track.BL$PA2_WALKHR_MCQ==5]<-10
track.BL$PASE_Q2A[track.BL$PA2_WALKHR_MCQ>5]<-NA
track.BL$PASE_Q2A[is.na(track.BL$PA2_WALKHR_MCQ)]<-NA
track.BL$PASE_Q2A<-as.numeric(track.BL$PASE_Q2A)


#Q3: Light Sports or Activity Frequency
track.BL$PASE_Q3<- NA
track.BL$PASE_Q3[track.BL$PA2_LSPRT_MCQ==1]<-0
track.BL$PASE_Q3[track.BL$PA2_LSPRT_MCQ==2]<-0.11
track.BL$PASE_Q3[track.BL$PA2_LSPRT_MCQ==3]<-0.25
track.BL$PASE_Q3[track.BL$PA2_LSPRT_MCQ==4]<-0.43
track.BL$PASE_Q3[track.BL$PA2_LSPRT_MCQ>4]<-NA
track.BL$PASE_Q3[is.na(track.BL$PA2_LSPRT_MCQ)]<-NA

track.BL$PASE_Q3A<- NA
track.BL$PASE_Q3A[track.BL$PA2_LSPRTHR_MCQ==1]<-0
track.BL$PASE_Q3A[track.BL$PA2_LSPRTHR_MCQ==2]<-1
track.BL$PASE_Q3A[track.BL$PA2_LSPRTHR_MCQ==3]<-3
track.BL$PASE_Q3A[track.BL$PA2_LSPRTHR_MCQ==4]<-6
track.BL$PASE_Q3A[track.BL$PA2_LSPRTHR_MCQ==5]<-10
track.BL$PASE_Q3A[track.BL$PA2_LSPRTHR_MCQ>5]<-NA
track.BL$PASE_Q3A[track.BL$PA2_LSPRT_MCQ == 1 | is.na(track.BL$PA2_LSPRTHR_MCQ)]<-0
track.BL$PASE_Q3A[is.na(track.BL$PA2_LSPRT_MCQ) & is.na(track.BL$PA2_LSPRTHR_MCQ)]<-NA
track.BL$PASE_Q3A[track.BL$PA2_LSPRT_MCQ>4 & is.na(track.BL$PA2_LSPRTHR_MCQ)]<-NA
track.BL$PASE_Q3A<-as.numeric(track.BL$PASE_Q3A)


#Q4: Moderate Sports or Activity Frequency
track.BL$PASE_Q4<-NA
track.BL$PASE_Q4[track.BL$PA2_MSPRT_MCQ==1]<-0
track.BL$PASE_Q4[track.BL$PA2_MSPRT_MCQ==2]<-0.11
track.BL$PASE_Q4[track.BL$PA2_MSPRT_MCQ==3]<-0.25
track.BL$PASE_Q4[track.BL$PA2_MSPRT_MCQ==4]<-0.43
track.BL$PASE_Q4[track.BL$PA2_MSPRT_MCQ>4]<-NA
track.BL$PASE_Q4[is.na(track.BL$PA2_MSPRT_MCQ)]<-NA

track.BL$PASE_Q4A<- NA
track.BL$PASE_Q4A[track.BL$PA2_MSPRTHR_MCQ==1]<-0
track.BL$PASE_Q4A[track.BL$PA2_MSPRTHR_MCQ==2]<-1
track.BL$PASE_Q4A[track.BL$PA2_MSPRTHR_MCQ==3]<-3
track.BL$PASE_Q4A[track.BL$PA2_MSPRTHR_MCQ==4]<-6
track.BL$PASE_Q4A[track.BL$PA2_MSPRTHR_MCQ==5]<-10
track.BL$PASE_Q4A[track.BL$PA2_MSPRTHR_MCQ>5]<-NA
track.BL$PASE_Q4A[track.BL$PA2_MSPRT_MCQ == 1 | is.na(track.BL$PA2_MSPRTHR_MCQ)]<-0
track.BL$PASE_Q4A[is.na(track.BL$PA2_MSPRT_MCQ) & is.na(track.BL$PA2_MSPRTHR_MCQ)]<-NA
track.BL$PASE_Q4A[track.BL$PA2_MSPRT_MCQ>4 & is.na(track.BL$PA2_MSPRTHR_MCQ)]<-NA
track.BL$PASE_Q4A<-as.numeric(track.BL$PASE_Q4A)


#Q5: Strenuous Sports or Activity Frequency
track.BL$PASE_Q5<-NA
track.BL$PASE_Q5[track.BL$PA2_SSPRT_MCQ==1]<-0
track.BL$PASE_Q5[track.BL$PA2_SSPRT_MCQ==2]<-0.11
track.BL$PASE_Q5[track.BL$PA2_SSPRT_MCQ==3]<-0.25
track.BL$PASE_Q5[track.BL$PA2_SSPRT_MCQ==4]<-0.43
track.BL$PASE_Q5[track.BL$PA2_SSPRT_MCQ>4]<-NA
track.BL$PASE_Q5[is.na(track.BL$PA2_SSPRT_MCQ)]<-NA

track.BL$PASE_Q5A<- NA
track.BL$PASE_Q5A[track.BL$PA2_SSPRTHR_MCQ==1]<-0
track.BL$PASE_Q5A[track.BL$PA2_SSPRTHR_MCQ==2]<-1
track.BL$PASE_Q5A[track.BL$PA2_SSPRTHR_MCQ==3]<-3
track.BL$PASE_Q5A[track.BL$PA2_SSPRTHR_MCQ==4]<-6
track.BL$PASE_Q5A[track.BL$PA2_SSPRTHR_MCQ==5]<-10
track.BL$PASE_Q5A[track.BL$PA2_SSPRTHR_MCQ>5]<-NA
track.BL$PASE_Q5A[track.BL$PA2_SSPRT_MCQ == 1 | is.na(track.BL$PA2_SSPRTHR_MCQ)]<-0
track.BL$PASE_Q5A[is.na(track.BL$PA2_SSPRT_MCQ) & is.na(track.BL$PA2_SSPRTHR_MCQ)]<-NA
track.BL$PASE_Q5A[track.BL$PA2_SSPRT_MCQ>4 & is.na(track.BL$PA2_SSPRTHR_MCQ)]<-NA
track.BL$PASE_Q5A<-as.numeric(track.BL$PASE_Q5A)


#Q6: Muscle strengthening and endurance exercise
track.BL$PASE_Q6<-NA
track.BL$PASE_Q6[track.BL$PA2_EXER_MCQ==1]<-0
track.BL$PASE_Q6[track.BL$PA2_EXER_MCQ==2]<-0.11
track.BL$PASE_Q6[track.BL$PA2_EXER_MCQ==3]<-0.25
track.BL$PASE_Q6[track.BL$PA2_EXER_MCQ==4]<-0.43
track.BL$PASE_Q6[track.BL$PA2_EXER_MCQ>4]<-NA
track.BL$PASE_Q6[is.na(track.BL$PA2_EXER_MCQ)]<-NA

track.BL$PASE_Q6A<- NA
track.BL$PASE_Q6A[track.BL$PA2_EXERHR_MCQ==1]<-0
track.BL$PASE_Q6A[track.BL$PA2_EXERHR_MCQ==2]<-1
track.BL$PASE_Q6A[track.BL$PA2_EXERHR_MCQ==3]<-3
track.BL$PASE_Q6A[track.BL$PA2_EXERHR_MCQ==4]<-6
track.BL$PASE_Q6A[track.BL$PA2_EXERHR_MCQ==5]<-10
track.BL$PASE_Q6A[track.BL$PA2_EXERHR_MCQ>5]<-NA
track.BL$PASE_Q6A[track.BL$PA2_EXER_MCQ == 1 | is.na(track.BL$PA2_EXERHR_MCQ)]<-0
track.BL$PASE_Q6A[is.na(track.BL$PA2_EXER_MCQ) & is.na(track.BL$PA2_EXERHR_MCQ)]<-NA
track.BL$PASE_Q6A[track.BL$PA2_EXER_MCQ>4 & is.na(track.BL$PA2_EXERHR_MCQ)]<-NA
track.BL$PASE_Q6A<-as.numeric(track.BL$PASE_Q6A)


#Q7: Light Housework
track.BL$PASE_Q7<-NA
track.BL$PASE_Q7[track.BL$PA2_LTHSWK_MCQ==1]<-1
track.BL$PASE_Q7[track.BL$PA2_LTHSWK_MCQ==2]<-0
track.BL$PASE_Q7[track.BL$PA2_LTHSWK_MCQ>2]<-NA
track.BL$PASE_Q7[is.na(track.BL$PA2_LTHSWK_MCQ)]<-NA
track.BL$PASE_Q7<-as.numeric(track.BL$PASE_Q7)


#Q8: Heavy Housework
track.BL$PASE_Q8<-NA
track.BL$PASE_Q8[track.BL$PA2_HVYHSWK_MCQ==1]<-1
track.BL$PASE_Q8[track.BL$PA2_HVYHSWK_MCQ==2]<-0
track.BL$PASE_Q8[track.BL$PA2_HVYHSWK_MCQ>2]<-NA
track.BL$PASE_Q8[is.na(track.BL$PA2_HVYHSWK_MCQ)]<-NA
track.BL$PASE_Q8<-as.numeric(track.BL$PASE_Q8)


#Q9: Home Repair, Yardwork, Gardening, Care for another person
track.BL$PASE_Q9A<-NA
track.BL$PASE_Q9A[track.BL$PA2_HMREPAIR_MCQ==1]<-1
track.BL$PASE_Q9A[track.BL$PA2_HMREPAIR_MCQ==2]<-0
track.BL$PASE_Q9A[track.BL$PA2_HMREPAIR_MCQ>2]<-NA
track.BL$PASE_Q9A[is.na(track.BL$PA2_HMREPAIR_MCQ)]<-NA
track.BL$PASE_Q9A<-as.numeric(track.BL$PASE_Q9A)

track.BL$PASE_Q9B<-NA
track.BL$PASE_Q9B[track.BL$PA2_HVYODA_MCQ==1]<-1
track.BL$PASE_Q9B[track.BL$PA2_HVYODA_MCQ==2]<-0
track.BL$PASE_Q9B[track.BL$PA2_HVYODA_MCQ>2]<-NA
track.BL$PASE_Q9B[is.na(track.BL$PA2_HVYODA_MCQ)]<-NA
track.BL$PASE_Q9B<-as.numeric(track.BL$PASE_Q9B)

track.BL$PASE_Q9C<-NA
track.BL$PASE_Q9C[track.BL$PA2_LTODA_MCQ==1]<-1
track.BL$PASE_Q9C[track.BL$PA2_LTODA_MCQ==2]<-0
track.BL$PASE_Q9C[track.BL$PA2_LTODA_MCQ>2]<-NA
track.BL$PASE_Q9C[is.na(track.BL$PA2_LTODA_MCQ)]<-NA
track.BL$PASE_Q9C<-as.numeric(track.BL$PASE_Q9C)

track.BL$PASE_Q9D<-NA
track.BL$PASE_Q9D[track.BL$PA2_CRPRSN_MCQ==1]<-1
track.BL$PASE_Q9D[track.BL$PA2_CRPRSN_MCQ==2]<-0
track.BL$PASE_Q9D[track.BL$PA2_CRPRSN_MCQ>2]<-NA
track.BL$PASE_Q9D[is.na(track.BL$PA2_CRPRSN_MCQ)]<-NA
track.BL$PASE_Q9D<-as.numeric(track.BL$PASE_Q9D)

#Q10: Working and Volunteering
track.BL$PASE_Q10<-NA
track.BL$PASE_Q10[track.BL$PA2_WRK_MCQ==1]<-1
track.BL$PASE_Q10[track.BL$PA2_WRK_MCQ==2]<-0
track.BL$PASE_Q10[track.BL$PA2_WRK_MCQ>2]<-NA
track.BL$PASE_Q10[is.na(track.BL$PA2_WRK_MCQ)]<-NA
track.BL$PASE_Q10<-as.numeric(track.BL$PASE_Q10)

track.BL$PASE_Q10A<-NA
track.BL$PASE_Q10A<-track.BL$PA2_WRKHRS_NB_MCQ
track.BL$PASE_Q10A[track.BL$PA2_WRKHRS_NB_MCQ>=700]<-NA
track.BL$PASE_Q10A[track.BL$PA2_WRK_MCQ == 2 | is.na(track.BL$PA2_WRKHRS_NB_MCQ)]<-0
track.BL$PASE_Q10A[is.na(track.BL$PA2_WRK_MCQ) & is.na(track.BL$PA2_WRKHRS_NB_MCQ)]<-NA
track.BL$PASE_Q10A<-as.numeric(track.BL$PASE_Q10A)
track.BL$PASE_Q10A<-track.BL$PASE_Q10A/7

#PASE TOTAL SCORE#
track.BL$PASE_TOTAL<-track.BL$PASE_Q2*track.BL$PASE_Q2A*20 + track.BL$PASE_Q3*track.BL$PASE_Q3A*21 +  track.BL$PASE_Q4*track.BL$PASE_Q4A*23 + track.BL$PASE_Q5*track.BL$PASE_Q5A*30 +
  track.BL$PASE_Q6*track.BL$PASE_Q6A*30 + (track.BL$PASE_Q7+track.BL$PASE_Q8)*25 + track.BL$PASE_Q9A*30 + track.BL$PASE_Q9B*36 + track.BL$PASE_Q9C*20 + track.BL$PASE_Q9D*35 + 
  track.BL$PASE_Q10*track.BL$PASE_Q10A*21


#BMI
track.BL$BMI<-track.BL$HWT_DBMI_TRM
track.BL$BMI[track.BL$HWT_DBMI_TRM>100]<-NA

#CESD-10
track.BL$CESD_10<-track.BL$DEP_CESD10_TRM
track.BL$CESD_10[track.BL$DEP_CESD10_TRM>50]<-NA
track.BL$CESD_10[track.BL$DEP_CESD10_TRM==-88]<-NA

#Subjective Cognitive Impairment
track.BL$SCI<- NA
track.BL$SCI[track.BL$CCT_MEMPB_TRM==1]<- "Yes"
track.BL$SCI[track.BL$CCT_MEMPB_TRM==2]<- "No"

#Dementia and AD
track.BL$Dementia<- NA
track.BL$Dementia[track.BL$CCT_ALZH_TRM==1]<- "Yes"
track.BL$Dementia[track.BL$CCT_ALZH_TRM==2]<- "No"

#Anxiety
track.BL$Anxiety<- NA
track.BL$Anxiety[track.BL$CCT_ANXI_TRM==1]<- "Yes"
track.BL$Anxiety[track.BL$CCT_ANXI_TRM==2]<- "No"

#Mood Disorders
track.BL$Mood_Disord<- NA
track.BL$Mood_Disord[track.BL$CCT_MOOD_TRM==1]<- "Yes"
track.BL$Mood_Disord[track.BL$CCT_MOOD_TRM==2]<- "No"

#Pet Ownership at Baseline
track.BL$Pet_Owner<-NA
track.BL$Pet_Owner[track.BL$SSA_PET_TRM==1]<-"Yes"
track.BL$Pet_Owner[track.BL$SSA_PET_TRM==2]<-"No"

#Number of Chronic Conditions
track.BL$Chronic_conditions<-NA

track.BL$CCT_HEART_TRM[track.BL$CCT_HEART_TRM==1]<- 1 #Heart Disease
track.BL$CCT_HEART_TRM[track.BL$CCT_HEART_TRM==2]<- 0
track.BL$CCT_HEART_TRM[track.BL$CCT_HEART_TRM==8]<- NA
track.BL$CCT_HEART_TRM[track.BL$CCT_HEART_TRM==9]<- NA

track.BL$CCT_PVD_TRM[track.BL$CCT_PVD_TRM==1]<- 1 #peripheral vascular disease
track.BL$CCT_PVD_TRM[track.BL$CCT_PVD_TRM==2]<- 0
track.BL$CCT_PVD_TRM[track.BL$CCT_PVD_TRM==8]<- NA
track.BL$CCT_PVD_TRM[track.BL$CCT_PVD_TRM==9]<- NA

track.BL$CCT_MEMPB_TRM[track.BL$CCT_MEMPB_TRM==1]<- 1 #SCI
track.BL$CCT_MEMPB_TRM[track.BL$CCT_MEMPB_TRM==2]<- 0
track.BL$CCT_MEMPB_TRM[track.BL$CCT_MEMPB_TRM==8]<- NA
track.BL$CCT_MEMPB_TRM[track.BL$CCT_MEMPB_TRM==9]<- NA

track.BL$CCT_ALZH_TRM[track.BL$CCT_ALZH_TRM==1]<- 1 #Alzheimers or demeinta
track.BL$CCT_ALZH_TRM[track.BL$CCT_ALZH_TRM==2]<- 0
track.BL$CCT_ALZH_TRM[track.BL$CCT_ALZH_TRM==8]<- NA
track.BL$CCT_ALZH_TRM[track.BL$CCT_ALZH_TRM==9]<- NA

track.BL$CCT_MS_TRM[track.BL$CCT_MS_TRM==1]<- 1 #Multiple sclerosis
track.BL$CCT_MS_TRM[track.BL$CCT_MS_TRM==2]<- 0
track.BL$CCT_MS_TRM[track.BL$CCT_MS_TRM==8]<- NA
track.BL$CCT_MS_TRM[track.BL$CCT_MS_TRM==9]<- NA

track.BL$CCT_EPIL_TRM[track.BL$CCT_EPIL_TRM==1]<- 1 #Epilepsy
track.BL$CCT_EPIL_TRM[track.BL$CCT_EPIL_TRM==2]<- 0
track.BL$CCT_EPIL_TRM[track.BL$CCT_EPIL_TRM==8]<- NA
track.BL$CCT_EPIL_TRM[track.BL$CCT_EPIL_TRM==9]<- NA

track.BL$CCT_MGRN_TRM[track.BL$CCT_MGRN_TRM==1]<- 1 #Migraine headaches
track.BL$CCT_MGRN_TRM[track.BL$CCT_MGRN_TRM==2]<- 0
track.BL$CCT_MGRN_TRM[track.BL$CCT_MGRN_TRM==8]<- NA
track.BL$CCT_MGRN_TRM[track.BL$CCT_MGRN_TRM==9]<- NA

track.BL$CCT_ULCR_TRM[track.BL$CCT_ULCR_TRM==1]<- 1 #Intenstinal or stomach ulcers
track.BL$CCT_ULCR_TRM[track.BL$CCT_ULCR_TRM==2]<- 0
track.BL$CCT_ULCR_TRM[track.BL$CCT_ULCR_TRM==8]<- NA
track.BL$CCT_ULCR_TRM[track.BL$CCT_ULCR_TRM==9]<- NA

track.BL$CCT_IBDIBS_TRM[track.BL$CCT_IBDIBS_TRM==1]<- 1 #Bowel disorder
track.BL$CCT_IBDIBS_TRM[track.BL$CCT_IBDIBS_TRM==2]<- 0
track.BL$CCT_IBDIBS_TRM[track.BL$CCT_IBDIBS_TRM==8]<- NA
track.BL$CCT_IBDIBS_TRM[track.BL$CCT_IBDIBS_TRM==9]<- NA

track.BL$CCT_BOWINC_TRM[track.BL$CCT_BOWINC_TRM==1]<- 1 #Bowel incontinence
track.BL$CCT_BOWINC_TRM[track.BL$CCT_BOWINC_TRM==2]<- 0
track.BL$CCT_BOWINC_TRM[track.BL$CCT_BOWINC_TRM==8]<- NA
track.BL$CCT_BOWINC_TRM[track.BL$CCT_BOWINC_TRM==9]<- NA

track.BL$CCT_URIINC_TRM[track.BL$CCT_URIINC_TRM==1]<- 1 #Urinary incontinence
track.BL$CCT_URIINC_TRM[track.BL$CCT_URIINC_TRM==2]<- 0
track.BL$CCT_URIINC_TRM[track.BL$CCT_URIINC_TRM==8]<- NA
track.BL$CCT_URIINC_TRM[track.BL$CCT_URIINC_TRM==9]<- NA

track.BL$CCT_MACDEG_TRM[track.BL$CCT_MACDEG_TRM==1]<- 1 #Macular degeneration
track.BL$CCT_MACDEG_TRM[track.BL$CCT_MACDEG_TRM==2]<- 0
track.BL$CCT_MACDEG_TRM[track.BL$CCT_MACDEG_TRM==8]<- NA
track.BL$CCT_MACDEG_TRM[track.BL$CCT_MACDEG_TRM==9]<- NA

track.BL$CCT_CANC_TRM[track.BL$CCT_CANC_TRM==1]<- 1 #All-cause cancer
track.BL$CCT_CANC_TRM[track.BL$CCT_CANC_TRM==2]<- 0
track.BL$CCT_CANC_TRM[track.BL$CCT_CANC_TRM==8]<- NA
track.BL$CCT_CANC_TRM[track.BL$CCT_CANC_TRM==9]<- NA

track.BL$CCT_BCKP_TRM[track.BL$CCT_BCKP_TRM==1]<- 1 #Back problems but not fibromyalgia or arthritis
track.BL$CCT_BCKP_TRM[track.BL$CCT_BCKP_TRM==2]<- 0
track.BL$CCT_BCKP_TRM[track.BL$CCT_BCKP_TRM==8]<- NA
track.BL$CCT_BCKP_TRM[track.BL$CCT_BCKP_TRM==9]<- NA

track.BL$CCT_KIDN_TRM[track.BL$CCT_KIDN_TRM==1]<- 1 #Kidney disease
track.BL$CCT_KIDN_TRM[track.BL$CCT_KIDN_TRM==2]<- 0
track.BL$CCT_KIDN_TRM[track.BL$CCT_KIDN_TRM==8]<- NA
track.BL$CCT_KIDN_TRM[track.BL$CCT_KIDN_TRM==9]<- NA

track.BL$CCT_OTCCT_TRM[track.BL$CCT_OTCCT_TRM==1]<- 1 #Other long term mental or physical condition
track.BL$CCT_OTCCT_TRM[track.BL$CCT_OTCCT_TRM==2]<- 0
track.BL$CCT_OTCCT_TRM[track.BL$CCT_OTCCT_TRM==8]<- NA
track.BL$CCT_OTCCT_TRM[track.BL$CCT_OTCCT_TRM==9]<- NA

track.BL$CCT_OAHAND_TRM[track.BL$CCT_OAHAND_TRM==1]<- 1 #Hand arthritis
track.BL$CCT_OAHAND_TRM[track.BL$CCT_OAHAND_TRM==2]<- 0
track.BL$CCT_OAHAND_TRM[track.BL$CCT_OAHAND_TRM==8]<- NA
track.BL$CCT_OAHAND_TRM[track.BL$CCT_OAHAND_TRM==9]<- NA

track.BL$CCT_OAHIP_TRM[track.BL$CCT_OAHIP_TRM==1]<- 1 #Hip arthritis
track.BL$CCT_OAHIP_TRM[track.BL$CCT_OAHIP_TRM==2]<- 0
track.BL$CCT_OAHIP_TRM[track.BL$CCT_OAHIP_TRM==8]<- NA
track.BL$CCT_OAHIP_TRM[track.BL$CCT_OAHIP_TRM==9]<- NA

track.BL$CCT_OAKNEE_TRM[track.BL$CCT_OAKNEE_TRM==1]<- 1 #Knee arthritis
track.BL$CCT_OAKNEE_TRM[track.BL$CCT_OAKNEE_TRM==2]<- 0
track.BL$CCT_OAKNEE_TRM[track.BL$CCT_OAKNEE_TRM==8]<- NA
track.BL$CCT_OAKNEE_TRM[track.BL$CCT_OAKNEE_TRM==9]<- NA

track.BL$CCT_RA_TRM[track.BL$CCT_RA_TRM==1]<- 1 #Rheumatoid arthritis
track.BL$CCT_RA_TRM[track.BL$CCT_RA_TRM==2]<- 0
track.BL$CCT_RA_TRM[track.BL$CCT_RA_TRM==8]<- NA
track.BL$CCT_RA_TRM[track.BL$CCT_RA_TRM==9]<- NA

track.BL$CCT_OTART_TRM[track.BL$CCT_OTART_TRM==1]<- 1 #Other arthritis
track.BL$CCT_OTART_TRM[track.BL$CCT_OTART_TRM==2]<- 0
track.BL$CCT_OTART_TRM[track.BL$CCT_OTART_TRM==8]<- NA
track.BL$CCT_OTART_TRM[track.BL$CCT_OTART_TRM==9]<- NA

track.BL$CCT_DIAB_TRM[track.BL$CCT_DIAB_TRM==1]<- 1 #Diabetes
track.BL$CCT_DIAB_TRM[track.BL$CCT_DIAB_TRM==2]<- 0
track.BL$CCT_DIAB_TRM[track.BL$CCT_DIAB_TRM==8]<- NA
track.BL$CCT_DIAB_TRM[track.BL$CCT_DIAB_TRM==9]<- NA

track.BL$CCT_HBP_TRM[track.BL$CCT_HBP_TRM==1]<- 1 #High blood pressure
track.BL$CCT_HBP_TRM[track.BL$CCT_HBP_TRM==2]<- 0
track.BL$CCC_HBP_COM[track.BL$CCT_HBP_TRM==8]<- NA
track.BL$CCT_HBP_TRM[track.BL$CCT_HBP_TRM==9]<- NA

track.BL$CCT_UTHYR_TRM[track.BL$CCT_UTHYR_TRM==1]<- 1 #Under active thyroid
track.BL$CCT_UTHYR_TRM[track.BL$CCT_UTHYR_TRM==2]<- 0
track.BL$CCT_UTHYR_TRM[track.BL$CCT_UTHYR_TRM==8]<- NA
track.BL$CCT_UTHYR_TRM[track.BL$CCT_UTHYR_TRM==9]<- NA

track.BL$CCT_ANGI_TRM[track.BL$CCT_ANGI_TRM==1]<- 1 #Angina
track.BL$CCT_ANGI_TRM[track.BL$CCT_ANGI_TRM==2]<- 0
track.BL$CCT_ANGI_TRM[track.BL$CCT_ANGI_TRM==8]<- NA
track.BL$CCT_ANGI_TRM[track.BL$CCT_ANGI_TRM==9]<- NA

track.BL$CCT_CVA_TRM[track.BL$CCT_CVA_TRM==1]<- 1 #Stroke or CVA
track.BL$CCT_CVA_TRM[track.BL$CCT_CVA_TRM==2]<- 0
track.BL$CCT_CVA_TRM[track.BL$CCT_CVA_TRM==8]<- NA
track.BL$CCT_CVA_TRM[track.BL$CCT_CVA_TRM==9]<- NA

track.BL$CCT_AMI_TRM[track.BL$CCT_AMI_TRM==1]<- 1 #myocardial infarction
track.BL$CCT_AMI_TRM[track.BL$CCT_AMI_TRM==2]<- 0
track.BL$CCT_AMI_TRM[track.BL$CCT_AMI_TRM==8]<- NA
track.BL$CCT_AMI_TRM[track.BL$CCT_AMI_TRM==9]<- NA

track.BL$CCT_OTHYR_TRM[track.BL$CCT_OTHYR_TRM==1]<- 1 #Overactive thyroid
track.BL$CCT_OTHYR_TRM[track.BL$CCT_OTHYR_TRM==2]<- 0
track.BL$CCT_OTHYR_TRM[track.BL$CCT_OTHYR_TRM==8]<- NA
track.BL$CCT_OTHYR_TRM[track.BL$CCT_OTHYR_TRM==9]<- NA

track.BL$CCT_TIA_TRM[track.BL$CCT_TIA_TRM==1]<- 1 #Transient Ischemic Attack
track.BL$CCT_TIA_TRM[track.BL$CCT_TIA_TRM==2]<- 0
track.BL$CCT_TIA_TRM[track.BL$CCT_TIA_TRM==8]<- NA
track.BL$CCT_TIA_TRM[track.BL$CCT_TIA_TRM==9]<- NA

track.BL$CCT_ASTHM_TRM[track.BL$CCT_ASTHM_TRM==1]<- 1 #Asthma
track.BL$CCT_ASTHM_TRM[track.BL$CCT_ASTHM_TRM==2]<- 0
track.BL$CCT_ASTHM_TRM[track.BL$CCT_ASTHM_TRM==8]<- NA
track.BL$CCT_ASTHM_TRM[track.BL$CCT_ASTHM_TRM==9]<- NA

track.BL$CCT_OSTPO_TRM[track.BL$CCT_OSTPO_TRM==1]<- 1 #Osteoperosis
track.BL$CCT_OSTPO_TRM[track.BL$CCT_OSTPO_TRM==2]<- 0
track.BL$CCT_OSTPO_TRM[track.BL$CCT_OSTPO_TRM==8]<- NA
track.BL$CCT_OSTPO_TRM[track.BL$CCT_OSTPO_TRM==9]<- NA

track.BL$CCT_PARK_TRM[track.BL$CCT_PARK_TRM==1]<- 1 #Parkinsons
track.BL$CCT_PARK_TRM[track.BL$CCT_PARK_TRM==2]<- 0
track.BL$CCT_PARK_TRM[track.BL$CCT_PARK_TRM==8]<- NA
track.BL$CCT_PARK_TRM[track.BL$CCT_PARK_TRM==9]<- NA

track.BL$CCT_COPD_TRM[track.BL$CCT_COPD_TRM==1]<- 1 #COPD
track.BL$CCT_COPD_TRM[track.BL$CCT_COPD_TRM==2]<- 0
track.BL$CCT_COPD_TRM[track.BL$CCT_COPD_TRM==8]<- NA
track.BL$CCT_COPD_TRM[track.BL$CCT_COPD_TRM==9]<- NA

track.BL$Chronic_conditions<-track.BL$CCT_HEART_TRM + track.BL$CCT_PVD_TRM + track.BL$CCT_MEMPB_TRM + track.BL$CCT_ALZH_TRM + track.BL$CCT_MS_TRM + 
  track.BL$CCT_EPIL_TRM + track.BL$CCT_MGRN_TRM + track.BL$CCT_ULCR_TRM +
  track.BL$CCT_IBDIBS_TRM + track.BL$CCT_BOWINC_TRM + track.BL$CCT_URIINC_TRM + track.BL$CCT_MACDEG_TRM + track.BL$CCT_CANC_TRM + track.BL$CCT_BCKP_TRM + track.BL$CCT_KIDN_TRM + 
  track.BL$CCT_OTCCT_TRM + track.BL$CCT_OAHAND_TRM + track.BL$CCT_OAHIP_TRM + track.BL$CCT_OAKNEE_TRM + track.BL$CCT_RA_TRM + track.BL$CCT_OTART_TRM +
  track.BL$CCT_DIAB_TRM + track.BL$CCT_HBP_TRM + track.BL$CCT_UTHYR_TRM + track.BL$CCT_ANGI_TRM + track.BL$CCT_CVA_TRM + track.BL$CCT_AMI_TRM + track.BL$CCT_OTHYR_TRM + 
  track.BL$CCT_TIA_TRM + track.BL$CCT_ASTHM_TRM + track.BL$CCT_OSTPO_TRM + track.BL$CCT_PARK_TRM + track.BL$CCT_COPD_TRM

#Restless Sleep (≥ 3-4 days/week)
track.BL$RSTLS_Sleep<-NA
track.BL$RSTLS_Sleep[track.BL$DEP_RSTLS_TRM<3]<-1
track.BL$RSTLS_Sleep[track.BL$DEP_RSTLS_TRM>=3 & track.BL$DEP_RSTLS_TRM<8]<-0
track.BL$RSTLS_Sleep[track.BL$DEP_RSTLS_TRM>4]<-NA

#Finalize data set

track.BL.1<-track.BL[c(1,3,4,72:80,101:109,82,111)]

names(track.BL.1) <-paste(names(track.BL.1),"_0", sep="")

track.BL.Final<- rename(track.BL.1, "ID" = "entity_id_0")

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
#Baseline (Cogs)
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
track.BLcogs<-trackBL[c(1,1010,1011,1068,1055,1067,1065,1066,995,1058)]

############Cognitive Function##############

#~~~~~~Animal Fluency~~~~~~~~~~~#
track.BLcogs$Animal_Fluency_Lang<-NA
track.BLcogs$Animal_Fluency_Lang[track.BLcogs$COG_AFT_STARTLANG_TRM=="en"]<-"English"
track.BLcogs$Animal_Fluency_Lang[track.BLcogs$COG_AFT_STARTLANG_TRM=="fr"]<-"French"

track.BLcogs$Animal_Fluency_Strict<-track.BLcogs$COG_AFT_SCORE_1_TRM
track.BLcogs$Animal_Fluency_Lenient<-track.BLcogs$COG_AFT_SCORE_2_TRM



#~~~~~~~~Mental Alteration Test~~~~~~~~~~#
track.BLcogs$MAT_Lang<-NA
track.BLcogs$MAT_Lang[track.BLcogs$COG_MAT_STARTLANG_TRM=="en"]<-"English"
track.BLcogs$MAT_Lang[track.BLcogs$COG_MAT_STARTLANG_TRM=="fr"]<-"French"

track.BLcogs$MAT_Score<-track.BLcogs$COG_MAT_SCORE_TRM

#~~~~~~~~RVLT~~~~~~~~~~~~~~~~#
#Rey-Immediate Recall
track.BLcogs$RVLT_Immediate_Lang<- NA
track.BLcogs$RVLT_Immediate_Lang[track.BLcogs$COG_REYI_STARTLANG_TRM=="en"]<-"English"
track.BLcogs$RVLT_Immediate_Lang[track.BLcogs$COG_REYI_STARTLANG_TRM=="fr"]<-"French"

track.BLcogs$RVLT_Immediate_Score<-track.BLcogs$COG_REYI_SCORE_TRM

#Rey-Delayed Recall
track.BLcogs$RVLT_Delayed_Lang<- NA
track.BLcogs$RVLT_Delayed_Lang[track.BLcogs$COG_REYII_STARTLANG_TRM=="en"]<-"English"
track.BLcogs$RVLT_Delayed_Lang[track.BLcogs$COG_REYII_STARTLANG_TRM=="fr"]<-"French"

track.BLcogs$RVLT_Delayed_Score<-track.BLcogs$COG_REYII_SCORE_TRM

track.BLcogs1 <- track.BLcogs[c(1,11:19)]

names(track.BLcogs1) <-paste(names(track.BLcogs1),"_0", sep="")

track.BLcogs.Final<- rename(track.BLcogs1, "ID" = "entity_id_0")
```

### 1.2.2) Follow-up 1 processing
```{r}
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
#FU1 (Non-Cogs)
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
setwd("~/Desktop/UBC-Postdoctoral Fellowship/CLSA - COVID Brain/Data/23SP001_McMaster_PRaina_FUP1")

trackFU1<-read.csv("/Users/ryan/Desktop/UBC-Postdoctoral Fellowship/CLSA - COVID Brain/Data/23SP001_McMaster_PRaina_FUP1/23SP001_McMaster_PRaina_FUP1_Trav3-1.csv")#Comprehensive Cohort Baseline

track.FU1<-trackFU1[c(1,75,76,594,83,1105,78,1859,134,155,174,181,187,204,201,210,223,228,240,
                      244,252,140,157,163,176,183,190,256,258,1832,1842,444,448,495,496,770,
                      423,434,451,575,455,458,461,462,463,470,473,514,523,537,399,396,392,401,
                      404,419,413,519,426,437,430,522,441,407,512,412,546,223,731)]

#Sex (no variable in FU1)
SexFU1 <- track.FU1 %>%
  left_join(track.BL, by = "entity_id") %>%
  select(entity_id, Sex)
track.FU1$Sex<-SexFU1$Sex


#Age
track.FU1$Age<-track.FU1$AGE_NMBR_TRF1

#Marital Status
track.FU1$Relationship_status<-NA
track.FU1$Relationship_status[track.FU1$SDC_MRTL_TRF1==1]<-"Single"
track.FU1$Relationship_status[track.FU1$SDC_MRTL_TRF1==2]<-"Married"
track.FU1$Relationship_status[track.FU1$SDC_MRTL_TRF1==3]<-"Widowed"
track.FU1$Relationship_status[track.FU1$SDC_MRTL_TRF1==4]<-"Divorced"
track.FU1$Relationship_status[track.FU1$SDC_MRTL_TRF1==5]<-"Separated"

#Education 4 Category (No variable in FU1)
EducationFU1 <- track.FU1 %>%
  left_join(track.BL, by = "entity_id") %>%
  select(entity_id,Education4)
track.FU1$Education4<-EducationFU1$Education4

#Household Income
track.FU1$Income_Level<-NA
track.FU1$Income_Level[track.FU1$INC_PTOT_TRF1==1]<-"<$20k"
track.FU1$Income_Level[track.FU1$INC_PTOT_TRF1==2]<-"$20-50k"
track.FU1$Income_Level[track.FU1$INC_PTOT_TRF1==3]<-"$50-100k"
track.FU1$Income_Level[track.FU1$INC_PTOT_TRF1==4]<-"$100-150k"
track.FU1$Income_Level[track.FU1$INC_PTOT_TRF1==5]<-">$150k"

#Living Status
track.FU1$Living_status<-NA
track.FU1$Living_status[track.FU1$OWN_DWLG_TRF1==1]<-"House"
track.FU1$Living_status[track.FU1$OWN_DWLG_TRF1==2 |track.FU1$OWN_DWLG_TRF1==6]<-"Apartment/Condo/Townhome"
track.FU1$Living_status[track.FU1$OWN_DWLG_TRF1==3]<-"Assisted Living"
track.FU1$Living_status[track.FU1$OWN_DWLG_TRF1==4 | track.FU1$OWN_DWLG_TRF1==5 | track.FU1$OWN_DWLG_TRF1>=7]<-"Other"

#Alcohol      
track.FU1$Alcohol<-NA
track.FU1$Alcohol[track.FU1$ALC_TTM_TRF1==1]<-"Regular drinker (at least once a month)"
track.FU1$Alcohol[track.FU1$ALC_TTM_TRF1==2]<-"Occasional drinker"
track.FU1$Alcohol[track.FU1$ALC_TTM_TRF1==3]<-"Non-drinker"

#Smoking Status (no variable in FU1)
SmokingFU1 <- track.FU1 %>%
  left_join(track.BL, by = "entity_id") %>%
  select(entity_id,Smoking_Status)
track.FU1$Smoking_Status<-SmokingFU1$Smoking_Status

#Ethnicity (take from baseline)
EthnicityFU1 <- track.FU1 %>%
  left_join(track.BL, by = "entity_id") %>%
  select(entity_id, Ethnicity)
track.FU1$Ethnicity<-EthnicityFU1$Ethnicity

#############Physical Activity Scale for the Elderly######################
#Q1: Sitting Activity Frequency in Past 7 days
track.FU1$PASE_Q1<-NA
track.FU1$PASE_Q1[track.FU1$PA2_SIT_TRF1==1]<-0
track.FU1$PASE_Q1[track.FU1$PA2_SIT_TRF1==2]<-0.11
track.FU1$PASE_Q1[track.FU1$PA2_SIT_TRF1==3]<-0.25
track.FU1$PASE_Q1[track.FU1$PA2_SIT_TRF1==4]<-0.43
track.FU1$PASE_Q1[track.FU1$PA2_SIT_TRF1>4]<-NA
track.FU1$PASE_Q1[is.na(track.FU1$PA2_SIT_TRF1)]<-NA

track.FU1$PASE_Q1B<-NA
track.FU1$PASE_Q1B[track.FU1$PA2_SITHR_TRF1==1]<-0
track.FU1$PASE_Q1B[track.FU1$PA2_SITHR_TRF1==2]<-1
track.FU1$PASE_Q1B[track.FU1$PA2_SITHR_TRF1==3]<-3
track.FU1$PASE_Q1B[track.FU1$PA2_SITHR_TRF1==4]<-6
track.FU1$PASE_Q1B[track.FU1$PA2_SITHR_TRF1==5]<-10
track.FU1$PASE_Q1B[track.FU1$PA2_SITHR_TRF1>5]<- 0
track.FU1$PASE_Q1B[is.na(track.FU1$PA2_SITHR_TRF1)]<-NA
track.FU1$PASE_Q1B<-as.numeric(track.FU1$PASE_Q1B)

#Q2: Walking outside frequency
track.FU1$PASE_Q2<- NULL
track.FU1$PASE_Q2[track.FU1$PA2_WALK_TRF1==1]<-0
track.FU1$PASE_Q2[track.FU1$PA2_WALK_TRF1==2]<-0.11
track.FU1$PASE_Q2[track.FU1$PA2_WALK_TRF1==3]<-0.25
track.FU1$PASE_Q2[track.FU1$PA2_WALK_TRF1==4]<-0.43
track.FU1$PASE_Q2[track.FU1$PA2_WALK_TRF1>4]<-NA
track.FU1$PASE_Q2[is.na(track.FU1$PA2_WALK_TRF1)]<-NA

track.FU1$PASE_Q2A<- NA
track.FU1$PASE_Q2A[track.FU1$PA2_WALKHR_TRF1==1]<-0
track.FU1$PASE_Q2A[track.FU1$PA2_WALKHR_TRF1==2]<-1
track.FU1$PASE_Q2A[track.FU1$PA2_WALKHR_TRF1==3]<-3
track.FU1$PASE_Q2A[track.FU1$PA2_WALKHR_TRF1==4]<-6
track.FU1$PASE_Q2A[track.FU1$PA2_WALKHR_TRF1==5]<-10
track.FU1$PASE_Q2A[track.FU1$PA2_WALKHR_TRF1>5]<-NA
track.FU1$PASE_Q2A[is.na(track.FU1$PA2_WALKHR_TRF1)]<-NA
track.FU1$PASE_Q2A<-as.numeric(track.FU1$PASE_Q2A)

#Q3: Light Sports or Activity Frequency
track.FU1$PASE_Q3<- NA
track.FU1$PASE_Q3[track.FU1$PA2_LSPRT_TRF1==1]<-0
track.FU1$PASE_Q3[track.FU1$PA2_LSPRT_TRF1==2]<-0.11
track.FU1$PASE_Q3[track.FU1$PA2_LSPRT_TRF1==3]<-0.25
track.FU1$PASE_Q3[track.FU1$PA2_LSPRT_TRF1==4]<-0.43
track.FU1$PASE_Q3[track.FU1$PA2_LSPRT_TRF1>4]<-NA
track.FU1$PASE_Q3[is.na(track.FU1$PA2_LSPRT_TRF1)]<-NA

track.FU1$PASE_Q3A<- NA
track.FU1$PASE_Q3A[track.FU1$PA2_LSPRTHR_TRF1==1]<-0
track.FU1$PASE_Q3A[track.FU1$PA2_LSPRTHR_TRF1==2]<-1
track.FU1$PASE_Q3A[track.FU1$PA2_LSPRTHR_TRF1==3]<-3
track.FU1$PASE_Q3A[track.FU1$PA2_LSPRTHR_TRF1==4]<-6
track.FU1$PASE_Q3A[track.FU1$PA2_LSPRTHR_TRF1==5]<-10
track.FU1$PASE_Q3A[track.FU1$PA2_LSPRTHR_TRF1>5]<-NA
track.FU1$PASE_Q3A[track.FU1$PA2_LSPRTHR_TRF1 == 1 | is.na(track.FU1$PA2_LSPRTHR_TRF1)]<-0
track.FU1$PASE_Q3A[is.na(track.FU1$PA2_LSPRT_TRF1) & is.na(track.FU1$PA2_LSPRTHR_TRF1)]<-NA
track.FU1$PASE_Q3A[track.FU1$PA2_LSPRTHR_TRF1>4 & is.na(track.FU1$PA2_LSPRTHR_TRF1)]<-NA
track.FU1$PASE_Q3A<-as.numeric(track.FU1$PASE_Q3A)

#Q4: Moderate Sports or Activity Frequency
track.FU1$PASE_Q4<-NA
track.FU1$PASE_Q4[track.FU1$PA2_MSPRT_TRF1==1]<-0
track.FU1$PASE_Q4[track.FU1$PA2_MSPRT_TRF1==2]<-0.11
track.FU1$PASE_Q4[track.FU1$PA2_MSPRT_TRF1==3]<-0.25
track.FU1$PASE_Q4[track.FU1$PA2_MSPRT_TRF1==4]<-0.43
track.FU1$PASE_Q4[track.FU1$PA2_MSPRT_TRF1>4]<-NA
track.FU1$PASE_Q4[is.na(track.FU1$PA2_MSPRT_TRF1)]<-NA

track.FU1$PASE_Q4A<- NA
track.FU1$PASE_Q4A[track.FU1$PA2_MSPRTHR_TRF1==1]<-0
track.FU1$PASE_Q4A[track.FU1$PA2_MSPRTHR_TRF1==2]<-1
track.FU1$PASE_Q4A[track.FU1$PA2_MSPRTHR_TRF1==3]<-3
track.FU1$PASE_Q4A[track.FU1$PA2_MSPRTHR_TRF1==4]<-6
track.FU1$PASE_Q4A[track.FU1$PA2_MSPRTHR_TRF1==5]<-10
track.FU1$PASE_Q4A[track.FU1$PA2_MSPRTHR_TRF1>5]<-NA
track.FU1$PASE_Q4A[track.FU1$PA2_MSPRT_TRF1 == 1 | is.na(track.FU1$PA2_MSPRTHR_TRF1)]<-0
track.FU1$PASE_Q4A[is.na(track.FU1$PA2_MSPRT_TRF1) & is.na(track.FU1$PA2_MSPRTHR_TRF1)]<-NA
track.FU1$PASE_Q4A[track.FU1$PA2_MSPRT_TRF1>4 & is.na(track.FU1$PA2_MSPRTHR_TRF1)]<-NA
track.FU1$PASE_Q4A<-as.numeric(track.FU1$PASE_Q4A)

#Q5: Strenuous Sports or Activity Frequency
track.FU1$PASE_Q5<-NA
track.FU1$PASE_Q5[track.FU1$PA2_SSPRT_TRF1==1]<-0
track.FU1$PASE_Q5[track.FU1$PA2_SSPRT_TRF1==2]<-0.11
track.FU1$PASE_Q5[track.FU1$PA2_SSPRT_TRF1==3]<-0.25
track.FU1$PASE_Q5[track.FU1$PA2_SSPRT_TRF1==4]<-0.43
track.FU1$PASE_Q5[track.FU1$PA2_SSPRT_TRF1>4]<-NA
track.FU1$PASE_Q5[is.na(track.FU1$PA2_SSPRT_TRF1)]<-NA

track.FU1$PASE_Q5A<- NA
track.FU1$PASE_Q5A[track.FU1$PA2_SSPRTHR_TRF1==1]<-0
track.FU1$PASE_Q5A[track.FU1$PA2_SSPRTHR_TRF1==2]<-1
track.FU1$PASE_Q5A[track.FU1$PA2_SSPRTHR_TRF1==3]<-3
track.FU1$PASE_Q5A[track.FU1$PA2_SSPRTHR_TRF1==4]<-6
track.FU1$PASE_Q5A[track.FU1$PA2_SSPRTHR_TRF1==5]<-10
track.FU1$PASE_Q5A[track.FU1$PA2_SSPRTHR_TRF1>5]<-NA
track.FU1$PASE_Q5A[track.FU1$PA2_SSPRT_TRF1 == 1 | is.na(track.FU1$PA2_SSPRTHR_TRF1)]<-0
track.FU1$PASE_Q5A[is.na(track.FU1$PA2_SSPRT_TRF1) & is.na(track.FU1$PA2_SSPRTHR_TRF1)]<-NA
track.FU1$PASE_Q5A[track.FU1$PA2_SSPRT_TRF1>4 & is.na(track.FU1$PA2_SSPRTHR_TRF1)]<-NA
track.FU1$PASE_Q5A<-as.numeric(track.FU1$PASE_Q5A)

#Q6: Muscle strengthening and endurance exercise
track.FU1$PASE_Q6<-NA
track.FU1$PASE_Q6[track.FU1$PA2_EXER_TRF1==1]<-0
track.FU1$PASE_Q6[track.FU1$PA2_EXER_TRF1==2]<-0.11
track.FU1$PASE_Q6[track.FU1$PA2_EXER_TRF1==3]<-0.25
track.FU1$PASE_Q6[track.FU1$PA2_EXER_TRF1==4]<-0.43
track.FU1$PASE_Q6[track.FU1$PA2_EXER_TRF1>4]<-NA
track.FU1$PASE_Q6[is.na(track.FU1$PA2_EXER_TRF1)]<-NA

track.FU1$PASE_Q6A<- NA
track.FU1$PASE_Q6A[track.FU1$PA2_EXERHR_TRF1==1]<-0
track.FU1$PASE_Q6A[track.FU1$PA2_EXERHR_TRF1==2]<-1
track.FU1$PASE_Q6A[track.FU1$PA2_EXERHR_TRF1==3]<-3
track.FU1$PASE_Q6A[track.FU1$PA2_EXERHR_TRF1==4]<-6
track.FU1$PASE_Q6A[track.FU1$PA2_EXERHR_TRF1==5]<-10
track.FU1$PASE_Q6A[track.FU1$PA2_EXERHR_TRF1>5]<-NA
track.FU1$PASE_Q6A[track.FU1$PA2_EXER_TRF1 == 1 | is.na(track.FU1$PA2_EXERHR_TRF1)]<-0
track.FU1$PASE_Q6A[is.na(track.FU1$PA2_EXER_TRF1) & is.na(track.FU1$PA2_EXERHR_TRF1)]<-NA
track.FU1$PASE_Q6A[track.FU1$PA2_EXER_TRF1>4 & is.na(track.FU1$PA2_EXERHR_TRF1)]<-NA
track.FU1$PASE_Q6A<-as.numeric(track.FU1$PASE_Q6A)

#Q7: Light Housework
track.FU1$PASE_Q7<-NA
track.FU1$PASE_Q7[track.FU1$PA2_LTHSWK_TRF1==1]<-1
track.FU1$PASE_Q7[track.FU1$PA2_LTHSWK_TRF1==2]<-0
track.FU1$PASE_Q7[track.FU1$PA2_LTHSWK_TRF1>2]<-NA
track.FU1$PASE_Q7[is.na(track.FU1$PA2_LTHSWK_TRF1)]<-NA
track.FU1$PASE_Q7<-as.numeric(track.FU1$PASE_Q7)

#Q8: Heavy Housework
track.FU1$PASE_Q8<-NA
track.FU1$PASE_Q8[track.FU1$PA2_HVYHSWK_TRF1==1]<-1
track.FU1$PASE_Q8[track.FU1$PA2_HVYHSWK_TRF1==2]<-0
track.FU1$PASE_Q8[track.FU1$PA2_HVYHSWK_TRF1>2]<-NA
track.FU1$PASE_Q8[is.na(track.FU1$PA2_HVYHSWK_TRF1)]<-NA
track.FU1$PASE_Q8<-as.numeric(track.FU1$PASE_Q8)

#Q9: Home Repair, Yardwork, Gardening, Care for another person
track.FU1$PASE_Q9A<-NA
track.FU1$PASE_Q9A[track.FU1$PA2_HMREPAIR_TRF1==1]<-1
track.FU1$PASE_Q9A[track.FU1$PA2_HMREPAIR_TRF1==2]<-0
track.FU1$PASE_Q9A[track.FU1$PA2_HMREPAIR_TRF1>2]<-NA
track.FU1$PASE_Q9A[is.na(track.FU1$PA2_HMREPAIR_TRF1)]<-NA
track.FU1$PASE_Q9A<-as.numeric(track.FU1$PASE_Q9A)

track.FU1$PASE_Q9B<-NA
track.FU1$PASE_Q9B[track.FU1$PA2_HVYODA_TRF1==1]<-1
track.FU1$PASE_Q9B[track.FU1$PA2_HVYODA_TRF1==2]<-0
track.FU1$PASE_Q9B[track.FU1$PA2_HVYODA_TRF1>2]<-NA
track.FU1$PASE_Q9B[is.na(track.FU1$PA2_HVYODA_TRF1)]<-NA
track.FU1$PASE_Q9B<-as.numeric(track.FU1$PASE_Q9B)

track.FU1$PASE_Q9C<-NA
track.FU1$PASE_Q9C[track.FU1$PA2_LTODA_TRF1==1]<-1
track.FU1$PASE_Q9C[track.FU1$PA2_LTODA_TRF1==2]<-0
track.FU1$PASE_Q9C[track.FU1$PA2_LTODA_TRF1>2]<-NA
track.FU1$PASE_Q9C[is.na(track.FU1$PA2_LTODA_TRF1)]<-NA
track.FU1$PASE_Q9C<-as.numeric(track.FU1$PASE_Q9C)

track.FU1$PASE_Q9D<-NA
track.FU1$PASE_Q9D[track.FU1$PA2_CRPRSN_TRF1==1]<-1
track.FU1$PASE_Q9D[track.FU1$PA2_CRPRSN_TRF1==2]<-0
track.FU1$PASE_Q9D[track.FU1$PA2_CRPRSN_TRF1>2]<-NA
track.FU1$PASE_Q9D[is.na(track.FU1$PA2_CRPRSN_TRF1)]<-NA
track.FU1$PASE_Q9D<-as.numeric(track.FU1$PASE_Q9D)

#Q10: Working and Volunteering
track.FU1$PASE_Q10<-NA
track.FU1$PASE_Q10[track.FU1$PA2_WRK_TRF1==1]<-1
track.FU1$PASE_Q10[track.FU1$PA2_WRK_TRF1==2]<-0
track.FU1$PASE_Q10[track.FU1$PA2_WRK_TRF1>2]<-NA
track.FU1$PASE_Q10[is.na(track.FU1$PA2_WRK_TRF1)]<-NA
track.FU1$PASE_Q10<-as.numeric(track.FU1$PASE_Q10)

track.FU1$PASE_Q10A<-NA
track.FU1$PASE_Q10A<-track.FU1$PA2_WRKHRS_NB_TRF1
track.FU1$PASE_Q10A[track.FU1$PA2_WRKHRS_NB_TRF1>=700]<-NA
track.FU1$PASE_Q10A[track.FU1$PA2_WRK_TRF1 == 2 | is.na(track.FU1$PA2_WRKHRS_NB_TRF1)]<-0
track.FU1$PASE_Q10A[is.na(track.FU1$PA2_WRK_TRF1) & is.na(track.FU1$PA2_WRKHRS_NB_TRF1)]<-NA
track.FU1$PASE_Q10A<-as.numeric(track.FU1$PASE_Q10A)
track.FU1$PASE_Q10A<-track.FU1$PASE_Q10A/7

#PASE TOTAL SCORE#
track.FU1$PASE_TOTAL<-track.FU1$PASE_Q2*track.FU1$PASE_Q2A*20 + track.FU1$PASE_Q3*track.FU1$PASE_Q3A*21 +  track.FU1$PASE_Q4*track.FU1$PASE_Q4A*23 + track.FU1$PASE_Q5*track.FU1$PASE_Q5A*30 +
  track.FU1$PASE_Q6*track.FU1$PASE_Q6A*30 + (track.FU1$PASE_Q7+track.FU1$PASE_Q8)*25 + track.FU1$PASE_Q9A*30 + track.FU1$PASE_Q9B*36 + track.FU1$PASE_Q9C*20 + track.FU1$PASE_Q9D*35 + 
  track.FU1$PASE_Q10*track.FU1$PASE_Q10A*21

#BMI
track.FU1$BMI<-track.FU1$HWT_DBMI_TRF1
track.FU1$BMI[track.FU1$HWT_DBMI_TRF1>100]<-NA

#CESD-10
track.FU1$CESD_10<-track.FU1$DEP_CESD10_TRF1
track.FU1$CESD_10[track.FU1$DEP_CESD10_TRF1==98]<-NA
track.FU1$CESD_10[track.FU1$DEP_CESD10_TRF1<0]<-NA

#Subjective Cognitive Impairment
track.FU1$SCI<- NA
track.FU1$SCI[track.FU1$CCT_MEMPB_TRF1==1]<- "Yes"
track.FU1$SCI[track.FU1$CCT_MEMPB_TRF1==2]<- "No"

#Dementia and AD
track.FU1$Dementia<- NA
track.FU1$Dementia[track.FU1$CCT_ALZH_TRF1==1]<- "Yes"
track.FU1$Dementia[track.FU1$CCT_ALZH_TRF1==2]<- "No"

#Anxiety
track.FU1$Anxiety<- NA
track.FU1$Anxiety[track.FU1$CCT_ANXI_TRF1==1]<- "Yes"
track.FU1$Anxiety[track.FU1$CCT_ANXI_TRF1==2]<- "No"

#Mood Disorders
track.FU1$Mood_Disord<- NA
track.FU1$Mood_Disord[track.FU1$CCT_MOOD_TRF1==1]<- "Yes"
track.FU1$Mood_Disord[track.FU1$CCT_MOOD_TRF1==2]<- "No"

#Pet Ownership at Baseline
track.FU1$Pet_Owner<-NA
track.FU1$Pet_Owner[track.FU1$SSA_PET_TRF1==1]<-"Yes"
track.FU1$Pet_Owner[track.FU1$SSA_PET_TRF1==2]<-"No"

#Number of Chronic Conditions
track.FU1$Chronic_conditions<-NA

track.FU1$CCT_HEART_TRM[track.FU1$CCT_HEART_TRF1==1]<- 1 #Heart Disease
track.FU1$CCT_HEART_TRM[track.FU1$CCT_HEART_TRF1==2]<- 0
track.FU1$CCT_HEART_TRM[track.FU1$CCT_HEART_TRF1==8]<- NA
track.FU1$CCT_HEART_TRM[track.FU1$CCT_HEART_TRF1==9]<- NA

track.FU1$CCT_PVD_TRM[track.FU1$CCT_PVD_TRF1==1]<- 1 #peripheral vascular disease
track.FU1$CCT_PVD_TRM[track.FU1$CCT_PVD_TRF1==2]<- 0
track.FU1$CCT_PVD_TRM[track.FU1$CCT_PVD_TRF1==8]<- NA
track.FU1$CCT_PVD_TRM[track.FU1$CCT_PVD_TRF1==9]<- NA

track.FU1$CCT_MEMPB_TRM[track.FU1$CCT_MEMPB_TRF1==1]<- 1 #SCI
track.FU1$CCT_MEMPB_TRM[track.FU1$CCT_MEMPB_TRF1==2]<- 0
track.FU1$CCT_MEMPB_TRM[track.FU1$CCT_MEMPB_TRF1==8]<- NA
track.FU1$CCT_MEMPB_TRM[track.FU1$CCT_MEMPB_TRF1==9]<- NA

track.FU1$CCT_ALZH_TRM[track.FU1$CCT_ALZH_TRF1==1]<- 1 #Alzheimers or demeinta
track.FU1$CCT_ALZH_TRM[track.FU1$CCT_ALZH_TRF1==2]<- 0
track.FU1$CCT_ALZH_TRM[track.FU1$CCT_ALZH_TRF1==8]<- NA
track.FU1$CCT_ALZH_TRM[track.FU1$CCT_ALZH_TRF1==9]<- NA

track.FU1$CCT_MS_TRM[track.FU1$CCT_MS_TRF1==1]<- 1 #Multiple sclerosis
track.FU1$CCT_MS_TRM[track.FU1$CCT_MS_TRF1==2]<- 0
track.FU1$CCT_MS_TRM[track.FU1$CCT_MS_TRF1==8]<- NA
track.FU1$CCT_MS_TRM[track.FU1$CCT_MS_TRF1==9]<- NA

track.FU1$CCT_EPIL_TRM[track.FU1$EPI_EVER_TRF1==1]<- 1 #Epilepsy
track.FU1$CCT_EPIL_TRM[track.FU1$EPI_EVER_TRF1==2]<- 0
track.FU1$CCT_EPIL_TRM[track.FU1$EPI_EVER_TRF1==8]<- NA
track.FU1$CCT_EPIL_TRM[track.FU1$EPI_EVER_TRF1==9]<- NA

track.FU1$CCT_MGRN_TRM[track.FU1$CCT_MGRN_TRF1==1]<- 1 #Migraine headaches
track.FU1$CCT_MGRN_TRM[track.FU1$CCT_MGRN_TRF1==2]<- 0
track.FU1$CCT_MGRN_TRM[track.FU1$CCT_MGRN_TRF1==8]<- NA
track.FU1$CCT_MGRN_TRM[track.FU1$CCT_MGRN_TRF1==9]<- NA

track.FU1$CCT_ULCR_TRM[track.FU1$CCT_ULCR_TRF1==1]<- 1 #Intenstinal or stomach ulcers
track.FU1$CCT_ULCR_TRM[track.FU1$CCT_ULCR_TRF1==2]<- 0
track.FU1$CCT_ULCR_TRM[track.FU1$CCT_ULCR_TRF1==8]<- NA
track.FU1$CCT_ULCR_TRM[track.FU1$CCT_ULCR_TRF1==9]<- NA

track.FU1$CCT_IBDIBS_TRM[track.FU1$CCT_IBDIBS_TRF1==1]<- 1 #Bowel disorder
track.FU1$CCT_IBDIBS_TRM[track.FU1$CCT_IBDIBS_TRF1==2]<- 0
track.FU1$CCT_IBDIBS_TRM[track.FU1$CCT_IBDIBS_TRF1==8]<- NA
track.FU1$CCT_IBDIBS_TRM[track.FU1$CCT_IBDIBS_TRF1==9]<- NA

track.FU1$CCT_BOWINC_TRM[track.FU1$CCT_BOWINC_TRF1==1]<- 1 #Bowel incontinence
track.FU1$CCT_BOWINC_TRM[track.FU1$CCT_BOWINC_TRF1==2]<- 0
track.FU1$CCT_BOWINC_TRM[track.FU1$CCT_BOWINC_TRF1==8]<- NA
track.FU1$CCT_BOWINC_TRM[track.FU1$CCT_BOWINC_TRF1==9]<- NA

track.FU1$CCT_URIINC_TRM[track.FU1$CCT_URIINC_TRF1==1]<- 1 #Urinary incontinence
track.FU1$CCT_URIINC_TRM[track.FU1$CCT_URIINC_TRF1==2]<- 0
track.FU1$CCT_URIINC_TRM[track.FU1$CCT_URIINC_TRF1==8]<- NA
track.FU1$CCT_URIINC_TRM[track.FU1$CCT_URIINC_TRF1==9]<- NA

track.FU1$CCT_MACDEG_TRM[track.FU1$CCT_MACDEG_TRF1==1]<- 1 #Macular degeneration
track.FU1$CCT_MACDEG_TRM[track.FU1$CCT_MACDEG_TRF1==2]<- 0
track.FU1$CCT_MACDEG_TRM[track.FU1$CCT_MACDEG_TRF1==8]<- NA
track.FU1$CCT_MACDEG_TRM[track.FU1$CCT_MACDEG_TRF1==9]<- NA

track.FU1$CCT_CANC_TRM[track.FU1$CCT_CANC_TRF1==1]<- 1 #All-cause cancer
track.FU1$CCT_CANC_TRM[track.FU1$CCT_CANC_TRF1==2]<- 0
track.FU1$CCT_CANC_TRM[track.FU1$CCT_CANC_TRF1==8]<- NA
track.FU1$CCT_CANC_TRM[track.FU1$CCT_CANC_TRF1==9]<- NA

track.FU1$CCT_BCKP_TRM[track.FU1$CCT_BCKP_TRF1==1]<- 1 #Back problems but not fibromyalgia or arthritis
track.FU1$CCT_BCKP_TRM[track.FU1$CCT_BCKP_TRF1==2]<- 0
track.FU1$CCT_BCKP_TRM[track.FU1$CCT_BCKP_TRF1==8]<- NA
track.FU1$CCT_BCKP_TRM[track.FU1$CCT_BCKP_TRF1==9]<- NA

track.FU1$CCT_KIDN_TRM[track.FU1$CCT_KIDN_TRF1==1]<- 1 #Kidney disease
track.FU1$CCT_KIDN_TRM[track.FU1$CCT_KIDN_TRF1==2]<- 0
track.FU1$CCT_KIDN_TRM[track.FU1$CCT_KIDN_TRF1==8]<- NA
track.FU1$CCT_KIDN_TRM[track.FU1$CCT_KIDN_TRF1==9]<- NA

track.FU1$CCT_OTCCT_TRM[track.FU1$CCT_OTCCT_TRF1==1]<- 1 #Other long term mental or physical condition
track.FU1$CCT_OTCCT_TRM[track.FU1$CCT_OTCCT_TRF1==2]<- 0
track.FU1$CCT_OTCCT_TRM[track.FU1$CCT_OTCCT_TRF1==8]<- NA
track.FU1$CCT_OTCCT_TRM[track.FU1$CCT_OTCCT_TRF1==9]<- NA

track.FU1$CCT_OAHAND_TRM[track.FU1$CCT_OAHAND_TRF1==1]<- 1 #Hand arthritis
track.FU1$CCT_OAHAND_TRM[track.FU1$CCT_OAHAND_TRF1==2]<- 0
track.FU1$CCT_OAHAND_TRM[track.FU1$CCT_OAHAND_TRF1==8]<- NA
track.FU1$CCT_OAHAND_TRM[track.FU1$CCT_OAHAND_TRF1==9]<- NA

track.FU1$CCT_OAHIP_TRM[track.FU1$CCT_OAHIP_TRF1==1]<- 1 #Hip arthritis
track.FU1$CCT_OAHIP_TRM[track.FU1$CCT_OAHIP_TRF1==2]<- 0
track.FU1$CCT_OAHIP_TRM[track.FU1$CCT_OAHIP_TRF1==8]<- NA
track.FU1$CCT_OAHIP_TRM[track.FU1$CCT_OAHIP_TRF1==9]<- NA

track.FU1$CCT_OAKNEE_TRM[track.FU1$CCT_OAKNEE_TRF1==1]<- 1 #Knee arthritis
track.FU1$CCT_OAKNEE_TRM[track.FU1$CCT_OAKNEE_TRF1==2]<- 0
track.FU1$CCT_OAKNEE_TRM[track.FU1$CCT_OAKNEE_TRF1==8]<- NA
track.FU1$CCT_OAKNEE_TRM[track.FU1$CCT_OAKNEE_TRF1==9]<- NA

track.FU1$CCT_RA_TRM[track.FU1$CCT_RA_TRF1==1]<- 1 #Rheumatoid arthritis
track.FU1$CCT_RA_TRM[track.FU1$CCT_RA_TRF1==2]<- 0
track.FU1$CCT_RA_TRM[track.FU1$CCT_RA_TRF1==8]<- NA
track.FU1$CCT_RA_TRM[track.FU1$CCT_RA_TRF1==9]<- NA

track.FU1$CCT_OTART_TRM[track.FU1$CCT_OTART_TRF1==1]<- 1 #Other arthritis
track.FU1$CCT_OTART_TRM[track.FU1$CCT_OTART_TRF1==2]<- 0
track.FU1$CCT_OTART_TRM[track.FU1$CCT_OTART_TRF1==8]<- NA
track.FU1$CCT_OTART_TRM[track.FU1$CCT_OTART_TRF1==9]<- NA

track.FU1$CCT_DIAB_TRM[track.FU1$CCT_DIAB_TRF1==1]<- 1 #Diabetes
track.FU1$CCT_DIAB_TRM[track.FU1$CCT_DIAB_TRF1==2]<- 0
track.FU1$CCT_DIAB_TRM[track.FU1$CCT_DIAB_TRF1==8]<- NA
track.FU1$CCT_DIAB_TRM[track.FU1$CCT_DIAB_TRF1==9]<- NA

track.FU1$CCT_HBP_TRM[track.FU1$CCT_HBP_TRF1==1]<- 1 #High blood pressure
track.FU1$CCT_HBP_TRM[track.FU1$CCT_HBP_TRF1==2]<- 0
track.FU1$CCT_HBP_TRM[track.FU1$CCT_HBP_TRF1==8]<- NA
track.FU1$CCT_HBP_TRM[track.FU1$CCT_HBP_TRF1==9]<- NA

track.FU1$CCT_UTHYR_TRM[track.FU1$CCT_UTHYR_TRF1==1]<- 1 #Under active thyroid
track.FU1$CCT_UTHYR_TRM[track.FU1$CCT_UTHYR_TRF1==2]<- 0
track.FU1$CCT_UTHYR_TRM[track.FU1$CCT_UTHYR_TRF1==8]<- NA
track.FU1$CCT_UTHYR_TRM[track.FU1$CCT_UTHYR_TRF1==9]<- NA

track.FU1$CCT_ANGI_TRM[track.FU1$CCT_ANGI_TRF1==1]<- 1 #Angina
track.FU1$CCT_ANGI_TRM[track.FU1$CCT_ANGI_TRF1==2]<- 0
track.FU1$CCT_ANGI_TRM[track.FU1$CCT_ANGI_TRF1==8]<- NA
track.FU1$CCT_ANGI_TRM[track.FU1$CCT_ANGI_TRF1==9]<- NA

track.FU1$CCT_CVA_TRM[track.FU1$CCT_CVA_TRF1==1]<- 1 #Stroke or CVA
track.FU1$CCT_CVA_TRM[track.FU1$CCT_CVA_TRF1==2]<- 0
track.FU1$CCT_CVA_TRM[track.FU1$CCT_CVA_TRF1==8]<- NA
track.FU1$CCT_CVA_TRM[track.FU1$CCT_CVA_TRF1==9]<- NA

track.FU1$CCT_AMI_TRM[track.FU1$CCT_AMI_TRF1==1]<- 1 #myocardial infarction
track.FU1$CCT_AMI_TRM[track.FU1$CCT_AMI_TRF1==2]<- 0
track.FU1$CCT_AMI_TRM[track.FU1$CCT_AMI_TRF1==8]<- NA
track.FU1$CCT_AMI_TRM[track.FU1$CCT_AMI_TRF1==9]<- NA

track.FU1$CCT_OTHYR_TRM[track.FU1$CCT_OTHYR_TRF1==1]<- 1 #Overactive thyroid
track.FU1$CCT_OTHYR_TRM[track.FU1$CCT_OTHYR_TRF1==2]<- 0
track.FU1$CCT_OTHYR_TRM[track.FU1$CCT_OTHYR_TRF1==8]<- NA
track.FU1$CCT_OTHYR_TRM[track.FU1$CCT_OTHYR_TRF1==9]<- NA

track.FU1$CCT_TIA_TRM[track.FU1$CCT_TIA_TRF1==1]<- 1 #Transient Ischemic Attack
track.FU1$CCT_TIA_TRM[track.FU1$CCT_TIA_TRF1==2]<- 0
track.FU1$CCT_TIA_TRM[track.FU1$CCT_TIA_TRF1==8]<- NA
track.FU1$CCT_TIA_TRM[track.FU1$CCT_TIA_TRF1==9]<- NA

track.FU1$CCT_ASTHM_TRM[track.FU1$CCT_ASTHM_TRF1==1]<- 1 #Asthma
track.FU1$CCT_ASTHM_TRM[track.FU1$CCT_ASTHM_TRF1==2]<- 0
track.FU1$CCT_ASTHM_TRM[track.FU1$CCT_ASTHM_TRF1==8]<- NA
track.FU1$CCT_ASTHM_TRM[track.FU1$CCT_ASTHM_TRF1==9]<- NA

track.FU1$CCT_OSTPO_TRM[track.FU1$CCT_OSTPO_TRF1==1]<- 1 #Osteoperosis
track.FU1$CCT_OSTPO_TRM[track.FU1$CCT_OSTPO_TRF1==2]<- 0
track.FU1$CCT_OSTPO_TRM[track.FU1$CCT_OSTPO_TRF1==8]<- NA
track.FU1$CCT_OSTPO_TRM[track.FU1$CCT_OSTPO_TRF1==9]<- NA

track.FU1$CCT_PARK_TRM[track.FU1$PKD_PARK_TRF1==1]<- 1 #Parkinsons
track.FU1$CCT_PARK_TRM[track.FU1$PKD_PARK_TRF1==2]<- 0
track.FU1$CCT_PARK_TRM[track.FU1$PKD_PARK_TRF1==8]<- NA
track.FU1$CCT_PARK_TRM[track.FU1$PKD_PARK_TRF1==9]<- NA

track.FU1$CCT_COPD_TRM[track.FU1$CCT_COPD_TRF1==1]<- 1 #COPD
track.FU1$CCT_COPD_TRM[track.FU1$CCT_COPD_TRF1==2]<- 0
track.FU1$CCT_COPD_TRM[track.FU1$CCT_COPD_TRF1==8]<- NA
track.FU1$CCT_COPD_TRM[track.FU1$CCT_COPD_TRF1==9]<- NA

track.FU1$Chronic_conditions<-track.FU1$CCT_HEART_TRM + track.FU1$CCT_PVD_TRM + track.FU1$CCT_MEMPB_TRM + track.FU1$CCT_ALZH_TRM + track.FU1$CCT_MS_TRM +
  track.FU1$CCT_EPIL_TRM + track.FU1$CCT_MGRN_TRM + track.FU1$CCT_ULCR_TRM +
  track.FU1$CCT_IBDIBS_TRM + track.FU1$CCT_BOWINC_TRM + track.FU1$CCT_URIINC_TRM + track.FU1$CCT_MACDEG_TRM + track.FU1$CCT_CANC_TRM + track.FU1$CCT_BCKP_TRM + track.FU1$CCT_KIDN_TRM + 
  track.FU1$CCT_OTCCT_TRM + track.FU1$CCT_OAHAND_TRM + track.FU1$CCT_OAHIP_TRM + track.FU1$CCT_OAKNEE_TRM + track.FU1$CCT_RA_TRM + track.FU1$CCT_OTART_TRM +
  track.FU1$CCT_DIAB_TRM + track.FU1$CCT_HBP_TRM + track.FU1$CCT_UTHYR_TRM + track.FU1$CCT_ANGI_TRM + track.FU1$CCT_CVA_TRM + track.FU1$CCT_AMI_TRM + track.FU1$CCT_OTHYR_TRM + 
  track.FU1$CCT_TIA_TRM + track.FU1$CCT_ASTHM_TRM + track.FU1$CCT_OSTPO_TRM + track.FU1$CCT_PARK_TRM + track.FU1$CCT_COPD_TRM

#Restless Sleep (≥ 3-4 days/week)
track.FU1$RSTLS_Sleep<-NA
track.FU1$RSTLS_Sleep[track.FU1$DEP_RSTLS_TRF1<3]<-1
track.FU1$RSTLS_Sleep[track.FU1$DEP_RSTLS_TRF1>=3 & track.FU1$DEP_RSTLS_TRF1<8]<-0
track.FU1$RSTLS_Sleep[track.FU1$DEP_RSTLS_TRF1>4]<-NA

#Finalize data set

track.FU1.1<-track.FU1[c(1:3,70:78,99:107,80,141)]

names(track.FU1.1) <-paste(names(track.FU1.1),"_1", sep="")

track.FU1.Final<- rename(track.FU1.1, "ID" = "entity_id_1")

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
#FU1 (Cogs)
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
track.FU1cogs<-trackFU1[c(1,1927,1928,1876,1875,1966,1877,1914,1878,1969)]

############Cognitive Function##############

#~~~~~~Animal Fluency~~~~~~~~~~~#
track.FU1cogs$Animal_Fluency_Lang<-NA
track.FU1cogs$Animal_Fluency_Lang[track.FU1cogs$COG_AFT_STARTLANG_TRF1=="en"]<-"English"
track.FU1cogs$Animal_Fluency_Lang[track.FU1cogs$COG_AFT_STARTLANG_TRF1=="fr"]<-"French"

track.FU1cogs$Animal_Fluency_Strict<-track.FU1cogs$COG_AFT_SCORE_1_TRF1
track.FU1cogs$Animal_Fluency_Strict[track.FU1cogs$Animal_Fluency_Strict<0]<-NA
track.FU1cogs$Animal_Fluency_Lenient<-track.FU1cogs$COG_AFT_SCORE_2_TRF1
track.FU1cogs$Animal_Fluency_Lenient[track.FU1cogs$Animal_Fluency_Lenient<0]<-NA



#~~~~~~~~Mental Alteration Test~~~~~~~~~~#
track.FU1cogs$MAT_Lang<-NA
track.FU1cogs$MAT_Lang[track.FU1cogs$COG_MAT_STARTLANG_TRF1=="en"]<-"English"
track.FU1cogs$MAT_Lang[track.FU1cogs$COG_MAT_STARTLANG_TRF1=="fr"]<-"French"

track.FU1cogs$MAT_Score<-track.FU1cogs$COG_MAT_SCORE_TRF1
track.FU1cogs$MAT_Score[track.FU1cogs$MAT_Score<0]<-NA

#~~~~~~~~RVLT~~~~~~~~~~~~~~~~#
#Rey-Immediate Recall
track.FU1cogs$RVLT_Immediate_Lang<- NA
track.FU1cogs$RVLT_Immediate_Lang[track.FU1cogs$COG_REYI_LANG_TRF1=="en"]<-"English"
track.FU1cogs$RVLT_Immediate_Lang[track.FU1cogs$COG_REYI_LANG_TRF1=="fr"]<-"French"

track.FU1cogs$RVLT_Immediate_Score<-track.FU1cogs$COG_REYI_SCORE_TRF1
track.FU1cogs$RVLT_Immediate_Score[track.FU1cogs$RVLT_Immediate_Score<0]<-NA


#Rey-Delayed Recall
track.FU1cogs$RVLT_Delayed_Lang<- NA
track.FU1cogs$RVLT_Delayed_Lang[track.FU1cogs$COG_REYII_LANG_TRF1=="en"]<-"English"
track.FU1cogs$RVLT_Delayed_Lang[track.FU1cogs$COG_REYII_LANG_TRF1=="fr"]<-"French"

track.FU1cogs$RVLT_Delayed_Score<-track.FU1cogs$COG_REYII_SCORE_TRF1
track.FU1cogs$RVLT_Delayed_Score[track.FU1cogs$RVLT_Delayed_Score<0]<-NA

track.FU1cogs1 <- track.FU1cogs[c(1,11:19)]

names(track.FU1cogs1) <-paste(names(track.FU1cogs1),"_1", sep="")

track.FU1cogs.Final<- rename(track.FU1cogs1, "ID" = "entity_id_1")
```

### 1.2.3) Follow-up 2 processing
```{r}
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
#FU2 (Non-Cogs)
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
setwd("~/Desktop/UBC-Postdoctoral Fellowship/CLSA - COVID Brain/Data/23SP001_McMaster_PRaina_FUP2")

trackFU2<-read.csv("23SP001_McMaster_PRaina_FUP2_Trav1.csv")#Comprehensive Cohort Baseline

track.FU2<-trackFU2[c(1:5,47,1239,14,78,98,111,112,113,114,194,137,157,158,184,185,
                      191,195:202,50:54,685:694,415,419,514,517,732,389,401,423,604,427,
                      431,437,441,445,457,461,542,359,356,352,363,381,375,534,393,403,397,
                      538,407,367,530,371,568)]

#Sex (no variable in FU1)
SexFU2 <- track.FU2 %>%
  left_join(track.BL, by = "entity_id") %>%
  select(entity_id, Sex)
track.FU2$Sex<-SexFU2$Sex

#Age
track.FU2$Age<-track.FU2$AGE_NMBR_TRF2

#Marital Status
track.FU2$Relationship_status<-NA
track.FU2$Relationship_status[track.FU2$SDC_MRTL_TRF2==1]<-"Single"
track.FU2$Relationship_status[track.FU2$SDC_MRTL_TRF2==2]<-"Married"
track.FU2$Relationship_status[track.FU2$SDC_MRTL_TRF2==3]<-"Widowed"
track.FU2$Relationship_status[track.FU2$SDC_MRTL_TRF2==4]<-"Divorced"
track.FU2$Relationship_status[track.FU2$SDC_MRTL_TRF2==5]<-"Separated"

#Education 4 Category (No variable in FU2)
EducationFU2 <- track.FU2 %>%
  left_join(track.BL, by = "entity_id") %>%
  select(entity_id,Education4)
track.FU2$Education4<-EducationFU2$Education4

#Household Income
track.FU2$Income_Level<-NA
track.FU2$Income_Level[track.FU2$INC_PTOT_TRF2==1]<-"<$20k"
track.FU2$Income_Level[track.FU2$INC_PTOT_TRF2==2]<-"$20-50k"
track.FU2$Income_Level[track.FU2$INC_PTOT_TRF2==3]<-"$50-100k"
track.FU2$Income_Level[track.FU2$INC_PTOT_TRF2==4]<-"$100-150k"
track.FU2$Income_Level[track.FU2$INC_PTOT_TRF2==5]<-">$150k"

#Living Status
track.FU2$Living_status<-NA
track.FU2$Living_status[track.FU2$OWN_DWLG_TRF2==1]<-"House"
track.FU2$Living_status[track.FU2$OWN_DWLG_TRF2==2 |track.FU2$OWN_DWLG_TRF2==6]<-"Apartment/Condo/Townhome"
track.FU2$Living_status[track.FU2$OWN_DWLG_TRF2==3]<-"Assisted Living"
track.FU2$Living_status[track.FU2$OWN_DWLG_TRF2==4 | track.FU2$OWN_DWLG_TRF2==5 | track.FU2$OWN_DWLG_TRF2>=7]<-"Other"

#Alcohol (Based on a different question/scale)     
track.FU2$Alcohol<-NA
track.FU2$Alcohol[track.FU2$ALC_FREQ_TRF2<=6]<-"Regular drinker (at least once a month)"
track.FU2$Alcohol[track.FU2$ALC_FREQ_TRF2==7]<-"Occasional drinker"
track.FU2$Alcohol[track.FU2$ALC_FREQ_TRF2==96]<-"Non-drinker"

#Smoking Status (no variable in FU2)
SmokingFU2 <- track.FU2 %>%
  left_join(track.BL, by = "entity_id") %>%
  select(entity_id,Smoking_Status)
track.FU2$Smoking_Status<-SmokingFU2$Smoking_Status

#Ethnicity (take from baseline))
EthnicityFU2 <- track.FU2 %>%
  left_join(track.BL, by = "entity_id") %>%
  select(entity_id,Ethnicity)
track.FU2$Ethnicity<-EthnicityFU2$Ethnicity

#############Physical Activity Scale for the Elderly######################
#Q1: Sitting Activity Frequency in Past 7 days
track.FU2$PASE_Q1<-NA
track.FU2$PASE_Q1[track.FU2$PA2_SIT_TRF2==1]<-0
track.FU2$PASE_Q1[track.FU2$PA2_SIT_TRF2==2]<-0.11
track.FU2$PASE_Q1[track.FU2$PA2_SIT_TRF2==3]<-0.25
track.FU2$PASE_Q1[track.FU2$PA2_SIT_TRF2==4]<-0.43
track.FU2$PASE_Q1[track.FU2$PA2_SIT_TRF2>4]<-NA
track.FU2$PASE_Q1[is.na(track.FU2$PA2_SIT_TRF2)]<-NA

track.FU2$PASE_Q1B<-NA
track.FU2$PASE_Q1B[track.FU2$PA2_SITHR_SIT_TRF2==1]<-0
track.FU2$PASE_Q1B[track.FU2$PA2_SITHR_SIT_TRF2==2]<-1
track.FU2$PASE_Q1B[track.FU2$PA2_SITHR_SIT_TRF2==3]<-3
track.FU2$PASE_Q1B[track.FU2$PA2_SITHR_SIT_TRF2==4]<-6
track.FU2$PASE_Q1B[track.FU2$PA2_SITHR_SIT_TRF2==5]<-10
track.FU2$PASE_Q1B[track.FU2$PA2_SITHR_SIT_TRF2>5]<- 0
track.FU2$PASE_Q1B[is.na(track.FU2$PA2_SITHR_SIT_TRF2)]<-NA
track.FU2$PASE_Q1B<-as.numeric(track.FU2$PASE_Q1B)

#Q2: Walking outside frequency
track.FU2$PASE_Q2<- NULL
track.FU2$PASE_Q2[track.FU2$PA2_WALK_TRF2==1]<-0
track.FU2$PASE_Q2[track.FU2$PA2_WALK_TRF2==2]<-0.11
track.FU2$PASE_Q2[track.FU2$PA2_WALK_TRF2==3]<-0.25
track.FU2$PASE_Q2[track.FU2$PA2_WALK_TRF2==4]<-0.43
track.FU2$PASE_Q2[track.FU2$PA2_WALK_TRF2>4]<-NA
track.FU2$PASE_Q2[is.na(track.FU2$PA2_WALK_TRF2)]<-NA

track.FU2$PASE_Q2A<- NA
track.FU2$PASE_Q2A[track.FU2$PA2_WALKHR_TRF2==1]<-0
track.FU2$PASE_Q2A[track.FU2$PA2_WALKHR_TRF2==2]<-1
track.FU2$PASE_Q2A[track.FU2$PA2_WALKHR_TRF2==3]<-3
track.FU2$PASE_Q2A[track.FU2$PA2_WALKHR_TRF2==4]<-6
track.FU2$PASE_Q2A[track.FU2$PA2_WALKHR_TRF2==5]<-10
track.FU2$PASE_Q2A[track.FU2$PA2_WALKHR_TRF2>5]<-NA
track.FU2$PASE_Q2A[is.na(track.FU2$PA2_WALKHR_TRF2)]<-NA
track.FU2$PASE_Q2A<-as.numeric(track.FU2$PASE_Q2A)

#Q3: Light Sports or Activity Frequency
track.FU2$PASE_Q3<- NA
track.FU2$PASE_Q3[track.FU2$PA2_LSPRT_TRF2==1]<-0
track.FU2$PASE_Q3[track.FU2$PA2_LSPRT_TRF2==2]<-0.11
track.FU2$PASE_Q3[track.FU2$PA2_LSPRT_TRF2==3]<-0.25
track.FU2$PASE_Q3[track.FU2$PA2_LSPRT_TRF2==4]<-0.43
track.FU2$PASE_Q3[track.FU2$PA2_LSPRT_TRF2>4]<-NA
track.FU2$PASE_Q3[is.na(track.FU2$PA2_LSPRT_TRF2)]<-NA

track.FU2$PASE_Q3A<- NA
track.FU2$PASE_Q3A[track.FU2$PA2_LSPRTHR_TRF2==1]<-0
track.FU2$PASE_Q3A[track.FU2$PA2_LSPRTHR_TRF2==2]<-1
track.FU2$PASE_Q3A[track.FU2$PA2_LSPRTHR_TRF2==3]<-3
track.FU2$PASE_Q3A[track.FU2$PA2_LSPRTHR_TRF2==4]<-6
track.FU2$PASE_Q3A[track.FU2$PA2_LSPRTHR_TRF2==5]<-10
track.FU2$PASE_Q3A[track.FU2$PA2_LSPRTHR_TRF2>5]<-NA
track.FU2$PASE_Q3A[track.FU2$PA2_LSPRTHR_TRF2 == 1 | is.na(track.FU2$PA2_LSPRTHR_TRF2)]<-0
track.FU2$PASE_Q3A[is.na(track.FU2$PA2_LSPRTHR_TRF2) & is.na(track.FU2$PA2_LSPRTHR_TRF2)]<-NA
track.FU2$PASE_Q3A[track.FU2$PA2_LSPRTHR_TRF2>4 & is.na(track.FU2$PA2_LSPRTHR_TRF2)]<-NA
track.FU2$PASE_3A<-as.numeric(track.FU2$PASE_Q3A)

#Q4: Moderate Sports or Activity Frequency
track.FU2$PASE_Q4<-NA
track.FU2$PASE_Q4[track.FU2$PA2_MSPRT_TRF2==1]<-0
track.FU2$PASE_Q4[track.FU2$PA2_MSPRT_TRF2==2]<-0.11
track.FU2$PASE_Q4[track.FU2$PA2_MSPRT_TRF2==3]<-0.25
track.FU2$PASE_Q4[track.FU2$PA2_MSPRT_TRF2==4]<-0.43
track.FU2$PASE_Q4[track.FU2$PA2_MSPRT_TRF2>4]<-NA
track.FU2$PASE_Q4[is.na(track.FU2$PA2_MSPRT_TRF2)]<-NA

track.FU2$PASE_Q4A<- NA
track.FU2$PASE_Q4A[track.FU2$PA2_MSPRTHR_TRF2==1]<-0
track.FU2$PASE_Q4A[track.FU2$PA2_MSPRTHR_TRF2==2]<-1
track.FU2$PASE_Q4A[track.FU2$PA2_MSPRTHR_TRF2==3]<-3
track.FU2$PASE_Q4A[track.FU2$PA2_MSPRTHR_TRF2==4]<-6
track.FU2$PASE_Q4A[track.FU2$PA2_MSPRTHR_TRF2==5]<-10
track.FU2$PASE_Q4A[track.FU2$PA2_MSPRTHR_TRF2>5]<-NA
track.FU2$PASE_Q4A[track.FU2$PA2_MSPRT_TRF2 == 1 | is.na(track.FU2$PA2_MSPRTHR_TRF2)]<-0
track.FU2$PASE_Q4A[is.na(track.FU2$PA2_MSPRT_TRF2) & is.na(track.FU2$PA2_MSPRTHR_TRF2)]<-NA
track.FU2$PASE_Q4A[track.FU2$PA2_MSPRT_TRF2>4 & is.na(track.FU2$PA2_MSPRTHR_TRF2)]<-NA
track.FU2$PASE_Q4A<-as.numeric(track.FU2$PASE_Q4A)

#Q5: Strenuous Sports or Activity Frequency
track.FU2$PASE_Q5<-NA
track.FU2$PASE_Q5[track.FU2$PA2_SSPRT_TRF2==1]<-0
track.FU2$PASE_Q5[track.FU2$PA2_SSPRT_TRF2==2]<-0.11
track.FU2$PASE_Q5[track.FU2$PA2_SSPRT_TRF2==3]<-0.25
track.FU2$PASE_Q5[track.FU2$PA2_SSPRT_TRF2==4]<-0.43
track.FU2$PASE_Q5[track.FU2$PA2_SSPRT_TRF2>4]<-NA
track.FU2$PASE_Q5[is.na(track.FU2$PA2_SSPRT_TRF2)]<-NA

track.FU2$PASE_Q5A<- NA
track.FU2$PASE_Q5A[track.FU2$PA2_SSPRTHR_TRF2==1]<-0
track.FU2$PASE_Q5A[track.FU2$PA2_SSPRTHR_TRF2==2]<-1
track.FU2$PASE_Q5A[track.FU2$PA2_SSPRTHR_TRF2==3]<-3
track.FU2$PASE_Q5A[track.FU2$PA2_SSPRTHR_TRF2==4]<-6
track.FU2$PASE_Q5A[track.FU2$PA2_SSPRTHR_TRF2==5]<-10
track.FU2$PASE_Q5A[track.FU2$PA2_SSPRTHR_TRF2>5]<-NA
track.FU2$PASE_Q5A[track.FU2$PA2_SSPRT_TRF2 == 1 | is.na(track.FU2$PA2_SSPRTHR_TRF2)]<-0
track.FU2$PASE_Q5A[is.na(track.FU2$PA2_SSPRT_TRF2) & is.na(track.FU2$PA2_SSPRTHR_TRF2)]<-NA
track.FU2$PASE_Q5A[track.FU2$PA2_SSPRT_TRF2>4 & is.na(track.FU2$PA2_SSPRTHR_TRF2)]<-NA
track.FU2$PASE_Q5A<-as.numeric(track.FU2$PASE_Q5A)

#Q6: Muscle strengthening and endurance exercise
track.FU2$PASE_Q6<-NA
track.FU2$PASE_Q6[track.FU2$PA2_EXER_TRF2==1]<-0
track.FU2$PASE_Q6[track.FU2$PA2_EXER_TRF2==2]<-0.11
track.FU2$PASE_Q6[track.FU2$PA2_EXER_TRF2==3]<-0.25
track.FU2$PASE_Q6[track.FU2$PA2_EXER_TRF2==4]<-0.43
track.FU2$PASE_Q6[track.FU2$PA2_EXER_TRF2>4]<-NA
track.FU2$PASE_Q6[is.na(track.FU2$PA2_EXER_TRF2)]<-NA

track.FU2$PASE_Q6A<- NA
track.FU2$PASE_Q6A[track.FU2$PA2_EXERHR_TRF2==1]<-0
track.FU2$PASE_Q6A[track.FU2$PA2_EXERHR_TRF2==2]<-1
track.FU2$PASE_Q6A[track.FU2$PA2_EXERHR_TRF2==3]<-3
track.FU2$PASE_Q6A[track.FU2$PA2_EXERHR_TRF2==4]<-6
track.FU2$PASE_Q6A[track.FU2$PA2_EXERHR_TRF2==5]<-10
track.FU2$PASE_Q6A[track.FU2$PA2_EXERHR_TRF2>5]<-NA
track.FU2$PASE_Q6A[track.FU2$PA2_EXER_TRF2 == 1 | is.na(track.FU2$PA2_EXERHR_TRF2)]<-0
track.FU2$PASE_Q6A[is.na(track.FU2$PA2_EXER_TRF2) & is.na(track.FU2$PA2_EXERHR_TRF2)]<-NA
track.FU2$PASE_Q6A[track.FU2$PA2_EXER_TRF2>4 & is.na(track.FU2$PA2_EXERHR_TRF2)]<-NA
track.FU2$PASE_Q6A<-as.numeric(track.FU2$PASE_Q6A)

#Q7: Light Housework
track.FU2$PASE_Q7<-NA
track.FU2$PASE_Q7[track.FU2$PA2_LTHSWK_TRF2==1]<-1
track.FU2$PASE_Q7[track.FU2$PA2_LTHSWK_TRF2==2]<-0
track.FU2$PASE_Q7[track.FU2$PA2_LTHSWK_TRF2>2]<-NA
track.FU2$PASE_Q7[is.na(track.FU2$PA2_LTHSWK_TRF2)]<-NA
track.FU2$PASE_Q7<-as.numeric(track.FU2$PASE_Q7)

#Q8: Heavy Housework
track.FU2$PASE_Q8<-NA
track.FU2$PASE_Q8[track.FU2$PA2_HVYHSWK_TRF2==1]<-1
track.FU2$PASE_Q8[track.FU2$PA2_HVYHSWK_TRF2==2]<-0
track.FU2$PASE_Q8[track.FU2$PA2_HVYHSWK_TRF2>2]<-NA
track.FU2$PASE_Q8[is.na(track.FU2$PA2_HVYHSWK_TRF2)]<-NA
track.FU2$PASE_Q8<-as.numeric(track.FU2$PASE_Q8)

#Q9: Home Repair, Yardwork, Gardening, Care for another person
track.FU2$PASE_Q9A<-NA
track.FU2$PASE_Q9A[track.FU2$PA2_HMREPAIR_TRF2==1]<-1
track.FU2$PASE_Q9A[track.FU2$PA2_HMREPAIR_TRF2==2]<-0
track.FU2$PASE_Q9A[track.FU2$PA2_HMREPAIR_TRF2>2]<-NA
track.FU2$PASE_Q9A[is.na(track.FU2$PA2_HMREPAIR_TRF2)]<-NA
track.FU2$PASE_Q9A<-as.numeric(track.FU2$PASE_Q9A)

track.FU2$PASE_Q9B<-NA
track.FU2$PASE_Q9B[track.FU2$PA2_HVYODA_TRF2==1]<-1
track.FU2$PASE_Q9B[track.FU2$PA2_HVYODA_TRF2==2]<-0
track.FU2$PASE_Q9B[track.FU2$PA2_HVYODA_TRF2>2]<-NA
track.FU2$PASE_Q9B[is.na(track.FU2$PA2_HVYODA_TRF2)]<-NA
track.FU2$PASE_Q9B<-as.numeric(track.FU2$PASE_Q9B)

track.FU2$PASE_Q9C<-NA
track.FU2$PASE_Q9C[track.FU2$PA2_LTODA_TRF2==1]<-1
track.FU2$PASE_Q9C[track.FU2$PA2_LTODA_TRF2==2]<-0
track.FU2$PASE_Q9C[track.FU2$PA2_LTODA_TRF2>2]<-NA
track.FU2$PASE_Q9C[is.na(track.FU2$PA2_LTODA_TRF2)]<-NA
track.FU2$PASE_Q9C<-as.numeric(track.FU2$PASE_Q9C)

track.FU2$PASE_Q9D<-NA
track.FU2$PASE_Q9D[track.FU2$PA2_CRPRSN_TRF2==1]<-1
track.FU2$PASE_Q9D[track.FU2$PA2_CRPRSN_TRF2==2]<-0
track.FU2$PASE_Q9D[track.FU2$PA2_CRPRSN_TRF2>2]<-NA
track.FU2$PASE_Q9D[is.na(track.FU2$PA2_CRPRSN_TRF2)]<-NA
track.FU2$PASE_Q9D<-as.numeric(track.FU2$PASE_Q9D)

#Q10: Working and Volunteering
track.FU2$PASE_Q10<-NA
track.FU2$PASE_Q10[track.FU2$PA2_WRK_TRF2==1]<-1
track.FU2$PASE_Q10[track.FU2$PA2_WRK_TRF2==2]<-0
track.FU2$PASE_Q10[track.FU2$PA2_WRK_TRF2>2]<-NA
track.FU2$PASE_Q10[is.na(track.FU2$PA2_WRK_TRF2)]<-NA
track.FU2$PASE_Q10<-as.numeric(track.FU2$PASE_Q10)

track.FU2$PASE_Q10A<-NA
track.FU2$PASE_Q10A<-track.FU2$PA2_WRKHRS_NB_TRF2
track.FU2$PASE_Q10A[track.FU2$PA2_WRKHRS_NB_TRF2>=700]<-NA
track.FU2$PASE_Q10A[track.FU2$PA2_WRK_TRF2 == 2 | is.na(track.FU2$PA2_WRKHRS_NB_TRF2)]<-0
track.FU2$PASE_Q10A[is.na(track.FU2$PA2_WRK_TRF2) & is.na(track.FU2$PA2_WRKHRS_NB_TRF2)]<-NA
track.FU2$PASE_Q10A<-as.numeric(track.FU2$PASE_Q10A)
track.FU2$PASE_Q10A<-track.FU2$PASE_Q10A/7

#PASE TOTAL SCORE#
track.FU2$PASE_TOTAL<-track.FU2$PASE_Q2*track.FU2$PASE_Q2A*20 + track.FU2$PASE_Q3*track.FU2$PASE_Q3A*21 +  track.FU2$PASE_Q4*track.FU2$PASE_Q4A*23 + track.FU2$PASE_Q5*track.FU2$PASE_Q5A*30 +
  track.FU2$PASE_Q6*track.FU2$PASE_Q6A*30 + (track.FU2$PASE_Q7+track.FU2$PASE_Q8)*25 + track.FU2$PASE_Q9A*30 + track.FU2$PASE_Q9B*36 + track.FU2$PASE_Q9C*20 + track.FU2$PASE_Q9D*35 + 
  track.FU2$PASE_Q10*track.FU2$PASE_Q10A*21


#BMI (Not included)
track.FU2$Height<-NA
track.FU2$Height[track.FU2$HWT_HGHT3_TRF2==1]<-36
track.FU2$Height[track.FU2$HWT_HGHT3_TRF2==2]<-37
track.FU2$Height[track.FU2$HWT_HGHT3_TRF2==3]<-38
track.FU2$Height[track.FU2$HWT_HGHT3_TRF2==4]<-39
track.FU2$Height[track.FU2$HWT_HGHT3_TRF2==5]<-40
track.FU2$Height[track.FU2$HWT_HGHT3_TRF2==6]<-41
track.FU2$Height[track.FU2$HWT_HGHT3_TRF2==7]<-42
track.FU2$Height[track.FU2$HWT_HGHT3_TRF2==8]<-43
track.FU2$Height[track.FU2$HWT_HGHT3_TRF2==9]<-44
track.FU2$Height[track.FU2$HWT_HGHT3_TRF2==10]<-45
track.FU2$Height[track.FU2$HWT_HGHT3_TRF2==11]<-46
track.FU2$Height[track.FU2$HWT_HGHT3_TRF2==12]<-47
track.FU2$Height[track.FU2$HWT_HGHT4_TRF2==1]<-48
track.FU2$Height[track.FU2$HWT_HGHT4_TRF2==2]<-49
track.FU2$Height[track.FU2$HWT_HGHT4_TRF2==3]<-50
track.FU2$Height[track.FU2$HWT_HGHT4_TRF2==4]<-51
track.FU2$Height[track.FU2$HWT_HGHT4_TRF2==5]<-52
track.FU2$Height[track.FU2$HWT_HGHT4_TRF2==6]<-53
track.FU2$Height[track.FU2$HWT_HGHT4_TRF2==7]<-54
track.FU2$Height[track.FU2$HWT_HGHT4_TRF2==8]<-55
track.FU2$Height[track.FU2$HWT_HGHT4_TRF2==9]<-56
track.FU2$Height[track.FU2$HWT_HGHT4_TRF2==10]<-57
track.FU2$Height[track.FU2$HWT_HGHT4_TRF2==11]<-58
track.FU2$Height[track.FU2$HWT_HGHT4_TRF2==12]<-59
track.FU2$Height[track.FU2$HWT_HGHT5_TRF2==1]<-60
track.FU2$Height[track.FU2$HWT_HGHT5_TRF2==2]<-61
track.FU2$Height[track.FU2$HWT_HGHT5_TRF2==3]<-62
track.FU2$Height[track.FU2$HWT_HGHT5_TRF2==4]<-63
track.FU2$Height[track.FU2$HWT_HGHT5_TRF2==5]<-64
track.FU2$Height[track.FU2$HWT_HGHT5_TRF2==6]<-65
track.FU2$Height[track.FU2$HWT_HGHT5_TRF2==7]<-66
track.FU2$Height[track.FU2$HWT_HGHT5_TRF2==8]<-67
track.FU2$Height[track.FU2$HWT_HGHT5_TRF2==9]<-68
track.FU2$Height[track.FU2$HWT_HGHT5_TRF2==10]<-69
track.FU2$Height[track.FU2$HWT_HGHT5_TRF2==11]<-70
track.FU2$Height[track.FU2$HWT_HGHT5_TRF2==12]<-71
track.FU2$Height[track.FU2$HWT_HGHT6_TRF2==1]<-72
track.FU2$Height[track.FU2$HWT_HGHT6_TRF2==2]<-73
track.FU2$Height[track.FU2$HWT_HGHT6_TRF2==3]<-74
track.FU2$Height[track.FU2$HWT_HGHT6_TRF2==4]<-75
track.FU2$Height[track.FU2$HWT_HGHT6_TRF2==5]<-76
track.FU2$Height[track.FU2$HWT_HGHT6_TRF2==6]<-77
track.FU2$Height[track.FU2$HWT_HGHT6_TRF2==7]<-78
track.FU2$Height[track.FU2$HWT_HGHT6_TRF2==8]<-79
track.FU2$Height[track.FU2$HWT_HGHT6_TRF2==9]<-80
track.FU2$Height[track.FU2$HWT_HGHT6_TRF2==10]<-81
track.FU2$Height[track.FU2$HWT_HGHT6_TRF2==11]<-82
track.FU2$Height[track.FU2$HWT_HGHT6_TRF2==12]<-83
track.FU2$Height<-as.numeric(track.FU2$Height)*0.0254

track.FU2$Weight<-track.FU2$HWT_WGHT_NB_TRF2
track.FU2$Weight[track.FU2$HWT_WGHT_NB_TRF2>500]<-NA
track.FU2$Weight[track.FU2$HWT_WGHT_NB_TRF2==-8888]<-NA

track.FU2$BMI<-track.FU2$Weight/((track.FU2$Height)^2)

#CESD-10 (NO CESD variable in the data set; need to calculate by hand)
#Q1: I was bothered by things that usually don’t bother me.
track.FU2$CESD_Q1<-NA
track.FU2$CESD_Q1[track.FU2$DEP_BOTR_TRF2==1]<-3
track.FU2$CESD_Q1[track.FU2$DEP_BOTR_TRF2==2]<-2
track.FU2$CESD_Q1[track.FU2$DEP_BOTR_TRF2==3]<-1
track.FU2$CESD_Q1[track.FU2$DEP_BOTR_TRF2==4]<-0
track.FU2$CESD_Q1[track.FU2$DEP_BOTR_TRF2>4]<-NA
track.FU2$CESD_Q1[track.FU2$DEP_BOTR_TRF2<0]<-NA

#Q2: I had trouble keeping my mind on what I was doing.
track.FU2$CESD_Q2<-NA
track.FU2$CESD_Q2[track.FU2$DEP_MIND_TRF2==1]<-3
track.FU2$CESD_Q2[track.FU2$DEP_MIND_TRF2==2]<-2
track.FU2$CESD_Q2[track.FU2$DEP_MIND_TRF2==3]<-1
track.FU2$CESD_Q2[track.FU2$DEP_MIND_TRF2==4]<-0
track.FU2$CESD_Q2[track.FU2$DEP_MIND_TRF2>4]<-NA
track.FU2$CESD_Q2[track.FU2$DEP_MIND_TRF2<0]<-NA

#Q3: I felt depressed
track.FU2$CESD_Q3<-NA
track.FU2$CESD_Q3[track.FU2$DEP_FLDP_TRF2==1]<-3
track.FU2$CESD_Q3[track.FU2$DEP_FLDP_TRF2==2]<-2
track.FU2$CESD_Q3[track.FU2$DEP_FLDP_TRF2==3]<-1
track.FU2$CESD_Q3[track.FU2$DEP_FLDP_TRF2==4]<-0
track.FU2$CESD_Q3[track.FU2$DEP_FLDP_TRF2>4]<-NA
track.FU2$CESD_Q3[track.FU2$DEP_FLDP_TRF2<0]<-NA

#Q4: I felt that everything I did was an effort.
track.FU2$CESD_Q4<-NA
track.FU2$CESD_Q4[track.FU2$DEP_FFRT_TRF2==1]<-3
track.FU2$CESD_Q4[track.FU2$DEP_FFRT_TRF2==2]<-2
track.FU2$CESD_Q4[track.FU2$DEP_FFRT_TRF2==3]<-1
track.FU2$CESD_Q4[track.FU2$DEP_FFRT_TRF2==4]<-0
track.FU2$CESD_Q4[track.FU2$DEP_FFRT_TRF2>4]<-NA
track.FU2$CESD_Q4[track.FU2$DEP_FFRT_TRF2<0]<-NA

#Q5: I felt hopeful about the future
track.FU2$CESD_Q5<-NA
track.FU2$CESD_Q5[track.FU2$DEP_HPFL_TRF2==1]<-0
track.FU2$CESD_Q5[track.FU2$DEP_HPFL_TRF2==2]<-1
track.FU2$CESD_Q5[track.FU2$DEP_HPFL_TRF2==3]<-2
track.FU2$CESD_Q5[track.FU2$DEP_HPFL_TRF2==4]<-3
track.FU2$CESD_Q5[track.FU2$DEP_HPFL_TRF2>4]<-NA
track.FU2$CESD_Q5[track.FU2$DEP_HPFL_TRF2<0]<-NA

#Q6: I felt fearful.
track.FU2$CESD_Q6<-NA
track.FU2$CESD_Q6[track.FU2$DEP_FRFL_TRF2==1]<-3
track.FU2$CESD_Q6[track.FU2$DEP_FRFL_TRF2==2]<-2
track.FU2$CESD_Q6[track.FU2$DEP_FRFL_TRF2==3]<-1
track.FU2$CESD_Q6[track.FU2$DEP_FRFL_TRF2==4]<-0
track.FU2$CESD_Q6[track.FU2$DEP_FRFL_TRF2>4]<-NA
track.FU2$CESD_Q6[track.FU2$DEP_FRFL_TRF2<0]<-NA

#Q7: My sleep was restless
track.FU2$CESD_Q7<-NA
track.FU2$CESD_Q7[track.FU2$DEP_RSTLS_TRF2==1]<-3
track.FU2$CESD_Q7[track.FU2$DEP_RSTLS_TRF2==2]<-2
track.FU2$CESD_Q7[track.FU2$DEP_RSTLS_TRF2==3]<-1
track.FU2$CESD_Q7[track.FU2$DEP_RSTLS_TRF2==4]<-0
track.FU2$CESD_Q7[track.FU2$DEP_RSTLS_TRF2>4]<-NA
track.FU2$CESD_Q7[track.FU2$DEP_RSTLS_TRF2<0]<-NA

#Q8: I was happy
track.FU2$CESD_Q8<-NA
track.FU2$CESD_Q8[track.FU2$DEP_HAPP_TRF2==1]<-0
track.FU2$CESD_Q8[track.FU2$DEP_HAPP_TRF2==2]<-1
track.FU2$CESD_Q8[track.FU2$DEP_HAPP_TRF2==3]<-2
track.FU2$CESD_Q8[track.FU2$DEP_HAPP_TRF2==4]<-3
track.FU2$CESD_Q8[track.FU2$DEP_HAPP_TRF2>4]<-NA
track.FU2$CESD_Q8[track.FU2$DEP_HAPP_TRF2<0]<-NA

#Q9: I felt lonely
track.FU2$CESD_Q9<-NA
track.FU2$CESD_Q9[track.FU2$DEP_LONLY_TRF2==1]<-3
track.FU2$CESD_Q9[track.FU2$DEP_LONLY_TRF2==2]<-2
track.FU2$CESD_Q9[track.FU2$DEP_LONLY_TRF2==3]<-1
track.FU2$CESD_Q9[track.FU2$DEP_LONLY_TRF2==4]<-0
track.FU2$CESD_Q9[track.FU2$DEP_LONLY_TRF2>4]<-NA
track.FU2$CESD_Q9[track.FU2$DEP_LONLY_TRF2<0]<-NA

#Q10: I could not “get going.”
track.FU2$CESD_Q10<-NA
track.FU2$CESD_Q10[track.FU2$DEP_GTGO_TRF2==1]<-3
track.FU2$CESD_Q10[track.FU2$DEP_GTGO_TRF2==2]<-2
track.FU2$CESD_Q10[track.FU2$DEP_GTGO_TRF2==3]<-1
track.FU2$CESD_Q10[track.FU2$DEP_GTGO_TRF2==4]<-0
track.FU2$CESD_Q10[track.FU2$DEP_GTGO_TRF2>4]<-NA
track.FU2$CESD_Q10[track.FU2$DEP_GTGO_TRF2<0]<-NA

track.FU2$CESD_10<-track.FU2$CESD_Q1 + track.FU2$CESD_Q2 + track.FU2$CESD_Q3 + track.FU2$CESD_Q4 + track.FU2$CESD_Q5 + 
  track.FU2$CESD_Q6 + track.FU2$CESD_Q7 + track.FU2$CESD_Q8 + track.FU2$CESD_Q9 + track.FU2$CESD_Q10

#Subjective Cognitive Impairment
track.FU2$SCI<- NA
track.FU2$SCI[track.FU2$CCT_MEMPB_TRF2==1]<- "Yes"
track.FU2$SCI[track.FU2$CCT_MEMPB_TRF2==2]<- "No"

#Dementia and AD
track.FU2$Dementia<- NA
track.FU2$Dementia[track.FU2$CCT_ALZH_TRF2==1]<- "Yes"
track.FU2$Dementia[track.FU2$CCT_ALZH_TRF2==2]<- "No"

#Anxiety
track.FU2$Anxiety<- NA
track.FU2$Anxiety[track.FU2$CCT_ANXI_TRF2==1]<- "Yes"
track.FU2$Anxiety[track.FU2$CCT_ANXI_TRF2==2]<- "No"

#Mood Disorders
track.FU2$Mood_Disord<- NA
track.FU2$Mood_Disord[track.FU2$CCT_MOOD_TRF2==1]<- "Yes"
track.FU2$Mood_Disord[track.FU2$CCT_MOOD_TRF2==2]<- "No"

#Number of Chronic Conditions
track.FU2$Chronic_conditions<-NA

#Pet Ownership at Baseline
track.FU2$Pet_Owner<-NA
track.FU2$Pet_Owner[track.FU2$SSA_PET_TRF2==1]<-"Yes"
track.FU2$Pet_Owner[track.FU2$SSA_PET_TRF2==2]<-"No"


track.FU2$CCT_HEART_TRM[track.FU2$CCT_HEART_TRF2==1]<- 1 #Heart Disease
track.FU2$CCT_HEART_TRM[track.FU2$CCT_HEART_TRF2==2]<- 0
track.FU2$CCT_HEART_TRM[track.FU2$CCT_HEART_TRF2==8]<- NA
track.FU2$CCT_HEART_TRM[track.FU2$CCT_HEART_TRF2==9]<- NA

track.FU2$CCT_PVD_TRM[track.FU2$CCT_PAD_TRF2==1]<- 1 #peripheral vascular disease (called Peripheral Artery Disease, unlike Baseline or FU1)
track.FU2$CCT_PVD_TRM[track.FU2$CCT_PAD_TRF2==2]<- 0
track.FU2$CCT_PVD_TRM[track.FU2$CCT_PAD_TRF2==8]<- NA
track.FU2$CCT_PVD_TRM[track.FU2$CCT_PAD_TRF2==9]<- NA

track.FU2$CCT_MEMPB_TRM[track.FU2$CCT_MEMPB_TRF2==1]<- 1 #SCI
track.FU2$CCT_MEMPB_TRM[track.FU2$CCT_MEMPB_TRF2==2]<- 0
track.FU2$CCT_MEMPB_TRM[track.FU2$CCT_MEMPB_TRF2==8]<- NA
track.FU2$CCT_MEMPB_TRM[track.FU2$CCT_MEMPB_TRF2==9]<- NA

track.FU2$CCT_ALZH_TRM[track.FU2$CCT_ALZH_TRF2==1]<- 1 #Alzheimers or demeinta
track.FU2$CCT_ALZH_TRM[track.FU2$CCT_ALZH_TRF2==2]<- 0
track.FU2$CCT_ALZH_TRM[track.FU2$CCT_ALZH_TRF2==8]<- NA
track.FU2$CCT_ALZH_TRM[track.FU2$CCT_ALZH_TRF2==9]<- NA

track.FU2$CCT_MS_TRM[track.FU2$CCT_MS_TRF2==1]<- 1 #Multiple sclerosis
track.FU2$CCT_MS_TRM[track.FU2$CCT_MS_TRF2==2]<- 0
track.FU2$CCT_MS_TRM[track.FU2$CCT_MS_TRF2==8]<- NA
track.FU2$CCT_MS_TRM[track.FU2$CCT_MS_TRF2==9]<- NA

track.FU2$CCT_EPIL_TRM[track.FU2$EPI_EVER_TRF2==1]<- 1 #Epilepsy (Different question)
track.FU2$CCT_EPIL_TRM[track.FU2$EPI_EVER_TRF2==2]<- 0
track.FU2$CCT_EPIL_TRM[track.FU2$EPI_EVER_TRF2==3]<- NA
track.FU2$CCT_EPIL_TRM[track.FU2$EPI_EVER_TRF2==8]<- NA
track.FU2$CCT_EPIL_TRM[track.FU2$EPI_EVER_TRF2==9]<- NA

track.FU2$CCT_MGRN_TRM[track.FU2$CCT_MGRN_TRF2==1]<- 1 #Migraine headaches
track.FU2$CCT_MGRN_TRM[track.FU2$CCT_MGRN_TRF2==2]<- 0
track.FU2$CCT_MGRN_TRM[track.FU2$CCT_MGRN_TRF2==8]<- NA
track.FU2$CCT_MGRN_TRM[track.FU2$CCT_MGRN_TRF2==9]<- NA

track.FU2$CCT_ULCR_TRM[track.FU2$CCT_ULCR_TRF2==1]<- 1 #Intenstinal or stomach ulcers
track.FU2$CCT_ULCR_TRM[track.FU2$CCT_ULCR_TRF2==2]<- 0
track.FU2$CCT_ULCR_TRM[track.FU2$CCT_ULCR_TRF2==8]<- NA
track.FU2$CCT_ULCR_TRM[track.FU2$CCT_ULCR_TRF2==9]<- NA

track.FU2$CCT_IBDIBS_TRM[track.FU2$CCT_IBSYD_TRF2==1]<- 1 #Bowel disorder (different name for IBS and IBD)
track.FU2$CCT_IBDIBS_TRM[track.FU2$CCT_IBSYD_TRF2==2]<- 0
track.FU2$CCT_IBDIBS_TRM[track.FU2$CCT_IBSYD_TRF2==8]<- NA
track.FU2$CCT_IBDIBS_TRM[track.FU2$CCT_IBSYD_TRF2==9]<- NA

track.FU2$CCT_BOWINC_TRM[track.FU2$CCT_BOWINC_TRF2==1]<- 1 #Bowel incontinence
track.FU2$CCT_BOWINC_TRM[track.FU2$CCT_BOWINC_TRF2==2]<- 0
track.FU2$CCT_BOWINC_TRM[track.FU2$CCT_BOWINC_TRF2==8]<- NA
track.FU2$CCT_BOWINC_TRM[track.FU2$CCT_BOWINC_TRF2==9]<- NA

track.FU2$CCT_URIINC_TRM[track.FU2$CCT_URIINC_TRF2==1]<- 1 #Urinary incontinence
track.FU2$CCT_URIINC_TRM[track.FU2$CCT_URIINC_TRF2==2]<- 0
track.FU2$CCT_URIINC_TRM[track.FU2$CCT_URIINC_TRF2==8]<- NA
track.FU2$CCT_URIINC_TRM[track.FU2$CCT_URIINC_TRF2==9]<- NA

track.FU2$CCT_MACDEG_TRM[track.FU2$CCT_MACDEG_TRF2==1]<- 1 #Macular degeneration
track.FU2$CCT_MACDEG_TRM[track.FU2$CCT_MACDEG_TRF2==2]<- 0
track.FU2$CCT_MACDEG_TRM[track.FU2$CCT_MACDEG_TRF2==8]<- NA
track.FU2$CCT_MACDEG_TRM[track.FU2$CCT_MACDEG_TRF2==9]<- NA

track.FU2$CCT_CANC_TRM[track.FU2$CCT_CANC_TRF2==1]<- 1 #All-cause cancer
track.FU2$CCT_CANC_TRM[track.FU2$CCT_CANC_TRF2==2]<- 0
track.FU2$CCT_CANC_TRM[track.FU2$CCT_CANC_TRF2==8]<- NA
track.FU2$CCT_CANC_TRM[track.FU2$CCT_CANC_TRF2==9]<- NA

track.FU2$CCT_BCKP_TRM<-NA #Back problems but not fibromyalgia or arthritis (Question not included)

track.FU2$CCT_KIDN_TRM[track.FU2$CCT_KIDN_TRF2==1]<- 1 #Kidney disease
track.FU2$CCT_KIDN_TRM[track.FU2$CCT_KIDN_TRF2==2]<- 0
track.FU2$CCT_KIDN_TRM[track.FU2$CCT_KIDN_TRF2==8]<- NA
track.FU2$CCT_KIDN_TRM[track.FU2$CCT_KIDN_TRF2==9]<- NA

track.FU2$CCT_OTCCT_TRM <- NA #Other long term mental or physical condition (Question not included)

track.FU2$CCT_OAHAND_TRM[track.FU2$CCT_OAHAND_TRF2==1]<- 1 #Hand arthritis
track.FU2$CCT_OAHAND_TRM[track.FU2$CCT_OAHAND_TRF2==2]<- 0
track.FU2$CCT_OAHAND_TRM[track.FU2$CCT_OAHAND_TRF2==8]<- NA
track.FU2$CCT_OAHAND_TRM[track.FU2$CCT_OAHAND_TRF2==9]<- NA

track.FU2$CCT_OAHIP_TRM[track.FU2$CCT_OAHIP_TRF2==1]<- 1 #Hip arthritis
track.FU2$CCT_OAHIP_TRM[track.FU2$CCT_OAHIP_TRF2==2]<- 0
track.FU2$CCT_OAHIP_TRM[track.FU2$CCT_OAHIP_TRF2==8]<- NA
track.FU2$CCT_OAHIP_TRM[track.FU2$CCT_OAHIP_TRF2==9]<- NA

track.FU2$CCT_OAKNEE_TRM[track.FU2$CCT_OAKNEE_TRF2==1]<- 1 #Knee arthritis
track.FU2$CCT_OAKNEE_TRM[track.FU2$CCT_OAKNEE_TRF2==2]<- 0
track.FU2$CCT_OAKNEE_TRM[track.FU2$CCT_OAKNEE_TRF2==8]<- NA
track.FU2$CCT_OAKNEE_TRM[track.FU2$CCT_OAKNEE_TRF2==9]<- NA

track.FU2$CCT_RA_TRM[track.FU2$CCT_RA_TRF2==1]<- 1 #Rheumatoid arthritis
track.FU2$CCT_RA_TRM[track.FU2$CCT_RA_TRF2==2]<- 0
track.FU2$CCT_RA_TRM[track.FU2$CCT_RA_TRF2==8]<- NA
track.FU2$CCT_RA_TRM[track.FU2$CCT_RA_TRF2==9]<- NA

track.FU2$CCT_ARTOT_TRM <- NA #Other arthritis (not included in the data)

track.FU2$DIA_DIAB_TRM[track.FU2$CCT_DIAB_TRF2==1]<- 1 #Diabetes
track.FU2$DIA_DIAB_TRM[track.FU2$CCT_DIAB_TRF2==2]<- 0
track.FU2$DIA_DIAB_TRM[track.FU2$CCT_DIAB_TRF2==8]<- NA
track.FU2$DIA_DIAB_TRM[track.FU2$CCT_DIAB_TRF2==9]<- NA

track.FU2$CCT_HBP_TRM[track.FU2$CCT_HBP_TRF2==1]<- 1 #High blood pressure
track.FU2$CCT_HBP_TRM[track.FU2$CCT_HBP_TRF2==2]<- 0
track.FU2$CCT_HBP_TRM[track.FU2$CCT_HBP_TRF2==8]<- NA
track.FU2$CCT_HBP_TRM[track.FU2$CCT_HBP_TRF2==9]<- NA

track.FU2$CCT_UTHYR_TRM[track.FU2$CCT_UTHYR_TRF2==1]<- 1 #Under active thyroid
track.FU2$CCT_UTHYR_TRM[track.FU2$CCT_UTHYR_TRF2==2]<- 0
track.FU2$CCT_UTHYR_TRM[track.FU2$CCT_UTHYR_TRF2==8]<- NA
track.FU2$CCT_UTHYR_TRM[track.FU2$CCT_UTHYR_TRF2==9]<- NA

track.FU2$CCT_ANGI_TRM[track.FU2$CCT_ANGI_TRF2==1]<- 1 #Angina
track.FU2$CCT_ANGI_TRM[track.FU2$CCT_ANGI_TRF2==2]<- 0
track.FU2$CCT_ANGI_TRM[track.FU2$CCT_ANGI_TRF2==8]<- NA
track.FU2$CCT_ANGI_TRM[track.FU2$CCT_ANGI_TRF2==9]<- NA

track.FU2$CCT_CVA_TRM[track.FU2$CCT_CVA_TRF2==1]<- 1 #Stroke or CVA
track.FU2$CCT_CVA_TRM[track.FU2$CCT_CVA_TRF2==2]<- 0
track.FU2$CCT_CVA_TRM[track.FU2$CCT_CVA_TRF2==8]<- NA
track.FU2$CCT_CVA_TRM[track.FU2$CCT_CVA_TRF2==9]<- NA

track.FU2$CCT_AMI_TRM[track.FU2$CCT_AMI_TRF2==1]<- 1 #myocardial infarction
track.FU2$CCT_AMI_TRM[track.FU2$CCT_AMI_TRF2==2]<- 0
track.FU2$CCT_AMI_TRM[track.FU2$CCT_AMI_TRF2==8]<- NA
track.FU2$CCT_AMI_TRM[track.FU2$CCT_AMI_TRF2==9]<- NA

track.FU2$CCT_OTHYR_TRM[track.FU2$CCT_OTHYR_TRF2==1]<- 1 #Overactive thyroid
track.FU2$CCT_OTHYR_TRM[track.FU2$CCT_OTHYR_TRF2==2]<- 0
track.FU2$CCT_OTHYR_TRM[track.FU2$CCT_OTHYR_TRF2==8]<- NA
track.FU2$CCT_OTHYR_TRM[track.FU2$CCT_OTHYR_TRF2==9]<- NA

track.FU2$CCT_TIA_TRM[track.FU2$CCT_TIA_TRF2==1]<- 1 #Transient Ischemic Attack
track.FU2$CCT_TIA_TRM[track.FU2$CCT_TIA_TRF2==2]<- 0
track.FU2$CCT_TIA_TRM[track.FU2$CCT_TIA_TRF2==8]<- NA
track.FU2$CCT_TIA_TRM[track.FU2$CCT_TIA_TRF2==9]<- NA

track.FU2$CCT_ASTHM_TRM[track.FU2$CCT_ASTHM_TRF2==1]<- 1 #Asthma
track.FU2$CCT_ASTHM_TRM[track.FU2$CCT_ASTHM_TRF2==2]<- 0
track.FU2$CCT_ASTHM_TRM[track.FU2$CCT_ASTHM_TRF2==8]<- NA
track.FU2$CCT_ASTHM_TRM[track.FU2$CCT_ASTHM_TRF2==9]<- NA

track.FU2$CCT_OSTPO_TRM[track.FU2$CCT_OSTPO_TRF2==1]<- 1 #Osteoperosis
track.FU2$CCT_OSTPO_TRM[track.FU2$CCT_OSTPO_TRF2==2]<- 0
track.FU2$CCT_OSTPO_TRM[track.FU2$CCT_OSTPO_TRF2==8]<- NA
track.FU2$CCT_OSTPO_TRM[track.FU2$CCT_OSTPO_TRF2==9]<- NA

track.FU2$CCT_PARK_TRM[track.FU2$PKD_PARK_TRF2==1]<- 1 #Parkinsons
track.FU2$CCT_PARK_TRM[track.FU2$PKD_PARK_TRF2==2]<- 0
track.FU2$CCT_PARK_TRM[track.FU2$PKD_PARK_TRF2==8]<- NA
track.FU2$CCT_PARK_TRM[track.FU2$PKD_PARK_TRF2==9]<- NA

track.FU2$CCT_COPD_TRM[track.FU2$CCT_COPD_TRF2==1]<- 1 #COPD
track.FU2$CCT_COPD_TRM[track.FU2$CCT_COPD_TRF2==2]<- 0
track.FU2$CCT_COPD_TRM[track.FU2$CCT_COPD_TRF2==8]<- NA
track.FU2$CCT_COPD_TRM[track.FU2$CCT_COPD_TRF2==9]<- NA

track.FU2$Chronic_conditions<-track.FU2$CCT_HEART_TRM + track.FU2$CCT_PVD_TRM + track.FU2$CCT_MEMPB_TRM + track.FU2$CCT_ALZH_TRM + track.FU2$CCT_MS_TRM + 
  track.FU2$CCT_EPIL_TRM + track.FU2$CCT_MGRN_TRM + track.FU2$CCT_ULCR_TRM +
  track.FU2$CCT_IBDIBS_TRM + track.FU2$CCT_BOWINC_TRM + track.FU2$CCT_URIINC_TRM + track.FU2$CCT_MACDEG_TRM + track.FU2$CCT_CANC_TRM + track.FU2$CCT_KIDN_TRM + 
  track.FU2$CCT_OAHAND_TRM + track.FU2$CCT_OAHIP_TRM + track.FU2$CCT_OAKNEE_TRM + track.FU2$CCT_RA_TRM  +
  track.FU2$DIA_DIAB_TRM + track.FU2$CCT_HBP_TRM + track.FU2$CCT_UTHYR_TRM + track.FU2$CCT_ANGI_TRM + track.FU2$CCT_CVA_TRM + track.FU2$CCT_AMI_TRM + track.FU2$CCT_OTHYR_TRM + 
  track.FU2$CCT_TIA_TRM + track.FU2$CCT_ASTHM_TRM + track.FU2$CCT_OSTPO_TRM + track.FU2$CCT_PARK_TRM + track.FU2$CCT_COPD_TRM

#Restless Sleep (≥ 3-4 days/week)
track.FU2$RSTLS_Sleep<-NA
track.FU2$RSTLS_Sleep[track.FU2$DEP_RSTLS_TRF2<3]<-1
track.FU2$RSTLS_Sleep[track.FU2$DEP_RSTLS_TRF2>=3 & track.FU2$DEP_RSTLS_TRF2<8]<-0
track.FU2$RSTLS_Sleep[track.FU2$DEP_RSTLS_TRF2>4]<-NA

#Finalize data set

track.FU2.1<-track.FU2[c(1:3,78:86,108,111,122:128,88,162)]

names(track.FU2.1) <-paste(names(track.FU2.1),"_2", sep="")

track.FU2.Final<- rename(track.FU2.1, "ID" = "entity_id_2")

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
#FU2 (Cogs)
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
setwd("~/Desktop/UBC-Postdoctoral Fellowship/CLSA - COVID Brain/Data/23SP001_McMaster_PRaina_FUP2_COG")

trackFU2cogs<-read.csv("23SP001_McMaster_PRaina_Cognition_Tra_FUP2_v0.csv")#Comprehensive Cohort Baseline

track.FU2cogs<-trackFU2cogs[c(1,64:66,110,109,41,42,48,47)]

############Cognitive Function##############

#~~~~~~Animal Fluency~~~~~~~~~~~#
track.FU2cogs$Animal_Fluency_Strict<-track.FU2cogs$COG_AFT_SCORE_1_TRF2
track.FU2cogs$Animal_Fluency_Lenient<-track.FU2cogs$COG_AFT_SCORE_2_TRF2
track.FU2cogs$Animal_Fluency_Lenient[track.FU2cogs$Animal_Fluency_Lenient<0]<-NA
track.FU2cogs$Animal_Fluency_Strict[track.FU2cogs$Animal_Fluency_Strict<0]<-NA

track.FU2cogs$Animal_Fluency_Lang<-NA
track.FU2cogs$Animal_Fluency_Lang[track.FU2cogs$COG_AFT_STARTLANG_TRF2=="en"]<-"English"
track.FU2cogs$Animal_Fluency_Lang[track.FU2cogs$COG_AFT_STARTLANG_TRF2=="fr"]<-"French"

#~~~~~~~~Mental Alteration Test~~~~~~~~~~#
track.FU2cogs$MAT_Lang<-NA
track.FU2cogs$MAT_Lang[track.FU2cogs$COG_MAT_STARTLANG_TRF2=="en"]<-"English"
track.FU2cogs$MAT_Lang[track.FU2cogs$COG_MAT_STARTLANG_TRF2=="fr"]<-"French"

track.FU2cogs$MAT_Score<-track.FU2cogs$COG_MAT_SCORE_TRF2

track.FU2cogs$MAT_Score[track.FU2cogs$MAT_Score<0]<-NA


#~~~~~~~~RVLT~~~~~~~~~~~~~~~~#
#Rey-Immediate Recall
track.FU2cogs$RVLT_Immediate_Lang<- NA
track.FU2cogs$RVLT_Immediate_Lang[track.FU2cogs$COG_REYI_STARTLANG_TRF2=="en"]<-"English"
track.FU2cogs$RVLT_Immediate_Lang[track.FU2cogs$COG_REYI_STARTLANG_TRF2=="fr"]<-"French"

track.FU2cogs$RVLT_Immediate_Score<-track.FU2cogs$COG_REYI_SCORE_TRF2

track.FU2cogs$RVLT_Immediate_Score[track.FU2cogs$RVLT_Immediate_Score<0]<-NA

#Rey-Delayed Recall
track.FU2cogs$RVLT_Delayed_Lang<- NA
track.FU2cogs$RVLT_Delayed_Lang[track.FU2cogs$COG_REYII_STARTLANG_TRF2=="en"]<-"English"
track.FU2cogs$RVLT_Delayed_Lang[track.FU2cogs$COG_REYII_STARTLANG_TRF2=="fr"]<-"French"

track.FU2cogs$RVLT_Delayed_Score<-track.FU2cogs$COG_REYII_SCORE_TRF2

track.FU2cogs$RVLT_Delayed_Score[track.FU2cogs$RVLT_Delayed_Score<0]<-NA

track.FU2cogs1 <- track.FU2cogs[c(1,11:19)]

names(track.FU2cogs1) <-paste(names(track.FU2cogs1),"_2", sep="")

track.FU2cogs.Final<- rename(track.FU2cogs1, "ID" = "entity_id_2")
```


## 1.3) Data merging

```{r}
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
#Combine Datasets
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#

#Combine Baseline dataframes
Track.Baseline.Final <- merge(track.BL.Final, track.BLcogs.Final, by = "ID")

#Combine FU1 dataframes
Track.FU1.Final <- merge(track.FU1.Final, track.FU1cogs.Final, by = "ID")

#Combine FU2 dataframes
Track.FU2.Final <- merge(track.FU2.Final, track.FU2cogs.Final, by = "ID")

#Combine data across different time points into full data set
Track.BL.FU1 <- merge(Track.Baseline.Final, Track.FU1.Final, by = "ID")

Track.Full <- merge(Track.BL.FU1, Track.FU2.Final, by = "ID")
```




# 2) Final data-set development

This section details how our final data-set was developed. Our final data set included cognitively healthy participants at baseline, FU1, and FU2 with complete baseline neuropsycholoigcal testing (including education level, which was necessary for standardized scores). Thus our final sample size included in our linear mixed models was N=11,355.

```{r}
Track.Final_Data <- subset(Track.Full, SCI_0=="No" & Dementia_0=="No" & SCI_1=="No" & Dementia_1 =="No" & 
                       SCI_2=="No" & Dementia_2 == "No" & !is.na(Animal_Fluency_Strict_0) & !is.na(MAT_Score_0) & !is.na(Education4_0) &
                       !is.na(RVLT_Immediate_Score_0) & !is.na(RVLT_Delayed_Score_0))
```

We then normalized all cognitive variables for language, age, and biological sex. Score standardization is dependent upon the following steps:

1. Create a predicted score based on age, sex, and test language
2. Create residualized score (i.e., obtained - predicted)
3. Develop a standardized residual score adjusted for age, sex, and education
4. Develop standardized z-score adjusted for age, sex, and education
5. Develop standardized score using z-score with a mean of 10 and a SD of 3.

```{r}
Tracking.Adjusted_Full <- Track.Final_Data %>%
  mutate(
    #Baseline Scores
    
    #RVLT Immediate Score
    RVLT_Immediate_Predicted_0 = case_when(
      Sex_0 =="M" & Education4_0 == "Less than High School Diploma" & RVLT_Immediate_Lang_0=="English" ~ 7.768 - 0.050*Age_0,
      Sex_0 =="M" & Education4_0 == "High School Diploma" & RVLT_Immediate_Lang_0=="English" ~ 7.449 - 0.036*Age_0,
      Sex_0 =="M" & Education4_0 == "Some College" & RVLT_Immediate_Lang_0=="English" ~ 10.095 - 0.073*Age_0,
      Sex_0 =="M" & Education4_0 == "College Degree or Higher" & RVLT_Immediate_Lang_0=="English" ~ 9.686 - 0.064*Age_0,
      Sex_0 =="F" & Education4_0 == "Less than High School Diploma" & RVLT_Immediate_Lang_0=="English" ~ 8.077 - 0.043*Age_0,
      Sex_0 =="F" & Education4_0 == "High School Diploma" & RVLT_Immediate_Lang_0=="English" ~ 9.806 - 0.059*Age_0,
      Sex_0 =="F" & Education4_0 == "Some College" & RVLT_Immediate_Lang_0=="English" ~ 9.161 - 0.047*Age_0,
      Sex_0 =="F" & Education4_0 == "College Degree or Higher" & RVLT_Immediate_Lang_0=="English" ~ 9.804 - 0.053*Age_0,
      Sex_0 =="M" & Education4_0 == "Less than High School Diploma" & RVLT_Immediate_Lang_0=="French" ~ 5.666 - 0.025*Age_0,
      Sex_0 =="M" & Education4_0 == "High School Diploma" & RVLT_Immediate_Lang_0=="French" ~ 8.953 - 0.067*Age_0,
      Sex_0 =="M" & Education4_0 == "Some College" & RVLT_Immediate_Lang_0=="French" ~ 7.662 - 0.039*Age_0,
      Sex_0 =="M" & Education4_0 == "College Degree or Higher" & RVLT_Immediate_Lang_0=="French" ~ 8.829 - 0.057*Age_0,
      Sex_0 =="F" & Education4_0 == "Less than High School Diploma" & RVLT_Immediate_Lang_0=="French" ~ 6.976 - 0.031*Age_0,
      Sex_0 =="F" & Education4_0 == "High School Diploma" & RVLT_Immediate_Lang_0=="French" ~ 8.667 - 0.045*Age_0,
      Sex_0 =="F" & Education4_0 == "Some College" & RVLT_Immediate_Lang_0=="French" ~ 9.502 - 0.061*Age_0,
      Sex_0 =="F" & Education4_0 == "College Degree or Higher" & RVLT_Immediate_Lang_0=="French" ~ 9.013 - 0.047*Age_0
    ),
    RVLT_Immediate_Residual_0 = RVLT_Immediate_Score_0 - RVLT_Immediate_Predicted_0,
    RVLT_Immediate_Z_0 = case_when(
      Sex_0 =="M" & Education4_0 == "Less than High School Diploma" & RVLT_Immediate_Lang_0=="English" ~ RVLT_Immediate_Residual_0/1.471,
      Sex_0 =="M" & Education4_0 == "High School Diploma" & RVLT_Immediate_Lang_0=="English" ~ RVLT_Immediate_Residual_0/1.525,
      Sex_0 =="M" & Education4_0 == "Some College" & RVLT_Immediate_Lang_0=="English" ~ RVLT_Immediate_Residual_0/1.611,
      Sex_0 =="M" & Education4_0 == "College Degree or Higher" & RVLT_Immediate_Lang_0=="English" ~ RVLT_Immediate_Residual_0/1.675,
      Sex_0 =="F" & Education4_0 == "Less than High School Diploma" & RVLT_Immediate_Lang_0=="English" ~ RVLT_Immediate_Residual_0/1.528,
      Sex_0 =="F" & Education4_0 == "High School Diploma" & RVLT_Immediate_Lang_0=="English" ~ RVLT_Immediate_Residual_0/1.643,
      Sex_0 =="F" & Education4_0 == "Some College" & RVLT_Immediate_Lang_0=="English" ~ RVLT_Immediate_Residual_0/1.694,
      Sex_0 =="F" & Education4_0 == "College Degree or Higher" & RVLT_Immediate_Lang_0=="English" ~ RVLT_Immediate_Residual_0/1.802,
      Sex_0 =="M" & Education4_0 == "Less than High School Diploma" & RVLT_Immediate_Lang_0=="French" ~ RVLT_Immediate_Residual_0/1.290,
      Sex_0 =="M" & Education4_0 == "High School Diploma" & RVLT_Immediate_Lang_0=="French" ~ RVLT_Immediate_Residual_0/1.473,
      Sex_0 =="M" & Education4_0 == "Some College" & RVLT_Immediate_Lang_0=="French" ~ RVLT_Immediate_Residual_0/1.913,
      Sex_0 =="M" & Education4_0 == "College Degree or Higher" & RVLT_Immediate_Lang_0=="French" ~ RVLT_Immediate_Residual_0/1.641,
      Sex_0 =="F" & Education4_0 == "Less than High School Diploma" & RVLT_Immediate_Lang_0=="French" ~ RVLT_Immediate_Residual_0/1.623,
      Sex_0 =="F" & Education4_0 == "High School Diploma" & RVLT_Immediate_Lang_0=="French" ~ RVLT_Immediate_Residual_0/1.595,
      Sex_0 =="F" & Education4_0 == "Some College" & RVLT_Immediate_Lang_0=="French" ~ RVLT_Immediate_Residual_0/1.605,
      Sex_0 =="F" & Education4_0 == "College Degree or Higher" & RVLT_Immediate_Lang_0=="French" ~ RVLT_Immediate_Residual_0/1.715
    ),
    RVLT_Immediate_Normed_0 = RVLT_Immediate_Z_0*3 +10,
    RVLT_Immediate_Normed_0 = if_else(RVLT_Immediate_Normed_0 < 0, 0.01, RVLT_Immediate_Normed_0),
    
    #RVLT Delayed Score
    RVLT_Delayed_Predicted_0 = case_when(
      Sex_0 =="M" & Education4_0 == "Less than High School Diploma" & RVLT_Delayed_Lang_0=="English" ~ 6.628 - 0.062*Age_0,
      Sex_0 =="M" & Education4_0 == "High School Diploma" & RVLT_Delayed_Lang_0=="English" ~ 6.851 - 0.058*Age_0,
      Sex_0 =="M" & Education4_0 == "Some College" & RVLT_Delayed_Lang_0=="English" ~ 8.289 - 0.076*Age_0,
      Sex_0 =="M" & Education4_0 == "College Degree or Higher" & RVLT_Delayed_Lang_0=="English" ~ 8.165 - 0.070*Age_0,
      Sex_0 =="F" & Education4_0 == "Less than High School Diploma" & RVLT_Delayed_Lang_0=="English" ~ 7.163 - 0.055*Age_0,
      Sex_0 =="F" & Education4_0 == "High School Diploma" & RVLT_Delayed_Lang_0=="English" ~ 8.115 - 0.063*Age_0,
      Sex_0 =="F" & Education4_0 == "Some College" & RVLT_Delayed_Lang_0=="English" ~ 8.151 - 0.059*Age_0,
      Sex_0 =="F" & Education4_0 == "College Degree or Higher" & RVLT_Delayed_Lang_0=="English" ~ 8.844 - 0.066*Age_0,
      Sex_0 =="M" & Education4_0 == "Less than High School Diploma" & RVLT_Delayed_Lang_0=="French" ~ 4.802 - 0.036*Age_0,
      Sex_0 =="M" & Education4_0 == "High School Diploma" & RVLT_Delayed_Lang_0=="French" ~ 8.219 - 0.083*Age_0,
      Sex_0 =="M" & Education4_0 == "Some College" & RVLT_Delayed_Lang_0=="French" ~ 9.721 - 0.097*Age_0,
      Sex_0 =="M" & Education4_0 == "College Degree or Higher" & RVLT_Delayed_Lang_0=="French" ~ 7.048 - 0.055*Age_0,
      Sex_0 =="F" & Education4_0 == "Less than High School Diploma" & RVLT_Delayed_Lang_0=="French" ~ 6.280 - 0.044*Age_0,
      Sex_0 =="F" & Education4_0 == "High School Diploma" & RVLT_Delayed_Lang_0=="French" ~ 6.999 - 0.042*Age_0,
      Sex_0 =="F" & Education4_0 == "Some College" & RVLT_Delayed_Lang_0=="French" ~ 9.081 - 0.074*Age_0,
      Sex_0 =="F" & Education4_0 == "College Degree or Higher" & RVLT_Delayed_Lang_0=="French" ~ 8.712 - 0.066*Age_0
    ),
    RVLT_Delayed_Residual_0 = RVLT_Delayed_Score_0 - RVLT_Delayed_Predicted_0,
    RVLT_Delayed_Z_0 = case_when(
      Sex_0 =="M" & Education4_0 == "Less than High School Diploma" & RVLT_Delayed_Lang_0=="English" ~ RVLT_Delayed_Residual_0/1.534,
      Sex_0 =="M" & Education4_0 == "High School Diploma" & RVLT_Delayed_Lang_0=="English" ~ RVLT_Delayed_Residual_0/1.739,
      Sex_0 =="M" & Education4_0 == "Some College" & RVLT_Delayed_Lang_0=="English" ~ RVLT_Delayed_Residual_0/1.802,
      Sex_0 =="M" & Education4_0 == "College Degree or Higher" & RVLT_Delayed_Lang_0=="English" ~ RVLT_Delayed_Residual_0/1.890,
      Sex_0 =="F" & Education4_0 == "Less than High School Diploma" & RVLT_Delayed_Lang_0=="English" ~ RVLT_Delayed_Residual_0/1.787,
      Sex_0 =="F" & Education4_0 == "High School Diploma" & RVLT_Delayed_Lang_0=="English" ~ RVLT_Delayed_Residual_0/2.005,
      Sex_0 =="F" & Education4_0 == "Some College" & RVLT_Delayed_Lang_0=="English" ~ RVLT_Delayed_Residual_0/1.869,
      Sex_0 =="F" & Education4_0 == "College Degree or Higher" & RVLT_Delayed_Lang_0=="English" ~ RVLT_Delayed_Residual_0/2.135,
      Sex_0 =="M" & Education4_0 == "Less than High School Diploma" & RVLT_Delayed_Lang_0=="French" ~ RVLT_Delayed_Residual_0/1.559,
      Sex_0 =="M" & Education4_0 == "High School Diploma" & RVLT_Delayed_Lang_0=="French" ~ RVLT_Delayed_Residual_0/1.571,
      Sex_0 =="M" & Education4_0 == "Some College" & RVLT_Delayed_Lang_0=="French" ~ RVLT_Delayed_Residual_0/1.815,
      Sex_0 =="M" & Education4_0 == "College Degree or Higher" & RVLT_Delayed_Lang_0=="French" ~ RVLT_Delayed_Residual_0/1.721,
      Sex_0 =="F" & Education4_0 == "Less than High School Diploma" & RVLT_Delayed_Lang_0=="French" ~ RVLT_Delayed_Residual_0/1.859,
      Sex_0 =="F" & Education4_0 == "High School Diploma" & RVLT_Delayed_Lang_0=="French" ~ RVLT_Delayed_Residual_0/1.793,
      Sex_0 =="F" & Education4_0 == "Some College" & RVLT_Delayed_Lang_0=="French" ~ RVLT_Delayed_Residual_0/1.901,
      Sex_0 =="F" & Education4_0 == "College Degree or Higher" & RVLT_Delayed_Lang_0=="French" ~ RVLT_Delayed_Residual_0/1.890
    ),
    RVLT_Delayed_Normed_0 = RVLT_Delayed_Z_0*3 +10,
    RVLT_Delayed_Normed_0 = if_else(RVLT_Delayed_Normed_0 < 0, 0.01, RVLT_Delayed_Normed_0),
    
    #Animal Fluency
    Animal_Fluency_Predicted_0 = case_when(
      Sex_0 =="M" & Education4_0 == "Less than High School Diploma" & Animal_Fluency_Lang_0=="English" ~ 23.132 - 0.095*Age_0,
      Sex_0 =="M" & Education4_0 == "High School Diploma" & Animal_Fluency_Lang_0=="English" ~ 28.923 - 0.157*Age_0,
      Sex_0 =="M" & Education4_0 == "Some College" & Animal_Fluency_Lang_0=="English" ~ 32.513 - 0.202*Age_0,
      Sex_0 =="M" & Education4_0 == "College Degree or Higher" & Animal_Fluency_Lang_0=="English" ~ 31.143 - 0.168*Age_0,
      Sex_0 =="F" & Education4_0 == "Less than High School Diploma" & Animal_Fluency_Lang_0=="English" ~ 23.433 - 0.114*Age_0,
      Sex_0 =="F" & Education4_0 == "High School Diploma" & Animal_Fluency_Lang_0=="English" ~ 29.912 - 0.181*Age_0,
      Sex_0 =="F" & Education4_0 == "Some College" & Animal_Fluency_Lang_0=="English" ~ 30.764 - 0.178*Age_0,
      Sex_0 =="F" & Education4_0 == "College Degree or Higher" & Animal_Fluency_Lang_0=="English" ~ 32.003 - 0.186*Age_0,
      Sex_0 =="M" & Education4_0 == "Less than High School Diploma" & Animal_Fluency_Lang_0=="French" ~ 26.034 - 0.152*Age_0,
      Sex_0 =="M" & Education4_0 == "High School Diploma" & Animal_Fluency_Lang_0=="French" ~ 33.358 - 0.241*Age_0,
      Sex_0 =="M" & Education4_0 == "Some College" & Animal_Fluency_Lang_0=="French" ~ 36.511 - 0.277*Age_0,
      Sex_0 =="M" & Education4_0 == "College Degree or Higher" & Animal_Fluency_Lang_0=="French" ~ 30.193 - 0.179*Age_0,
      Sex_0 =="F" & Education4_0 == "Less than High School Diploma" & Animal_Fluency_Lang_0=="French" ~ 21.460 - 0.089*Age_0,
      Sex_0 =="F" & Education4_0 == "High School Diploma" & Animal_Fluency_Lang_0=="French" ~ 21.355 - 0.070*Age_0,
      Sex_0 =="F" & Education4_0 == "Some College" & Animal_Fluency_Lang_0=="French" ~ 30.881 - 0.205*Age_0,
      Sex_0 =="F" & Education4_0 == "College Degree or Higher" & Animal_Fluency_Lang_0=="French" ~ 29.961 - 0.180*Age_0
    ),
    Animal_Fluency_Residual_0 = Animal_Fluency_Strict_0 - Animal_Fluency_Predicted_0,
    Animal_Fluency_Z_0 = case_when(
      Sex_0 =="M" & Education4_0 == "Less than High School Diploma" & Animal_Fluency_Lang_0=="English" ~ Animal_Fluency_Residual_0/5.145,
      Sex_0 =="M" & Education4_0 == "High School Diploma" & Animal_Fluency_Lang_0=="English" ~ Animal_Fluency_Residual_0/5.348,
      Sex_0 =="M" & Education4_0 == "Some College" & Animal_Fluency_Lang_0=="English" ~ Animal_Fluency_Residual_0/5.163,
      Sex_0 =="M" & Education4_0 == "College Degree or Higher" & Animal_Fluency_Lang_0=="English" ~ Animal_Fluency_Residual_0/5.354,
      Sex_0 =="F" & Education4_0 == "Less than High School Diploma" & Animal_Fluency_Lang_0=="English" ~ Animal_Fluency_Residual_0/4.665,
      Sex_0 =="F" & Education4_0 == "High School Diploma" & Animal_Fluency_Lang_0=="English" ~ Animal_Fluency_Residual_0/4.728,
      Sex_0 =="F" & Education4_0 == "Some College" & Animal_Fluency_Lang_0=="English" ~ Animal_Fluency_Residual_0/5.176,
      Sex_0 =="F" & Education4_0 == "College Degree or Higher" & Animal_Fluency_Lang_0=="English" ~ Animal_Fluency_Residual_0/5.369,
      Sex_0 =="M" & Education4_0 == "Less than High School Diploma" & Animal_Fluency_Lang_0=="French" ~ Animal_Fluency_Residual_0/3.911,
      Sex_0 =="M" & Education4_0 == "High School Diploma" & Animal_Fluency_Lang_0=="French" ~ Animal_Fluency_Residual_0/4.889,
      Sex_0 =="M" & Education4_0 == "Some College" & Animal_Fluency_Lang_0=="French" ~ Animal_Fluency_Residual_0/5.061,
      Sex_0 =="M" & Education4_0 == "College Degree or Higher" & Animal_Fluency_Lang_0=="French" ~ Animal_Fluency_Residual_0/4.869,
      Sex_0 =="F" & Education4_0 == "Less than High School Diploma" & Animal_Fluency_Lang_0=="French" ~ Animal_Fluency_Residual_0/4.178,
      Sex_0 =="F" & Education4_0 == "High School Diploma" & Animal_Fluency_Lang_0=="French" ~ Animal_Fluency_Residual_0/4.321,
      Sex_0 =="F" & Education4_0 == "Some College" & Animal_Fluency_Lang_0=="French" ~ Animal_Fluency_Residual_0/4.468,
      Sex_0 =="F" & Education4_0 == "College Degree or Higher" & Animal_Fluency_Lang_0=="French" ~ Animal_Fluency_Residual_0/4.940
    ),
    Animal_Fluency_Normed_0 = Animal_Fluency_Z_0*3 +10,
    Animal_Fluency_Normed_0 = if_else(Animal_Fluency_Normed_0 < 0, 0.01, Animal_Fluency_Normed_0),
    
    #Mental Alteration Test    
    MAT_Predicted_0 = case_when(
      Sex_0 =="M" & Education4_0 == "Less than High School Diploma" & MAT_Lang_0=="English" ~ 33.295 - 0.161*Age_0,
      Sex_0 =="M" & Education4_0 == "High School Diploma" & MAT_Lang_0=="English" ~ 34.074 - 0.123*Age_0,
      Sex_0 =="M" & Education4_0 == "Some College" & MAT_Lang_0=="English" ~ 41.488 - 0.219*Age_0,
      Sex_0 =="M" & Education4_0 == "College Degree or Higher" & MAT_Lang_0=="English" ~ 40.573 - 0.190*Age_0,
      Sex_0 =="F" & Education4_0 == "Less than High School Diploma" & MAT_Lang_0=="English" ~ 39.102 - 0.251*Age_0,
      Sex_0 =="F" & Education4_0 == "High School Diploma" & MAT_Lang_0=="English" ~ 41.657 - 0.246*Age_0,
      Sex_0 =="F" & Education4_0 == "Some College" & MAT_Lang_0=="English" ~ 36.877 - 0.168*Age_0,
      Sex_0 =="F" & Education4_0 == "College Degree or Higher" & MAT_Lang_0=="English" ~ 38.849 - 0.188*Age_0,
      Sex_0 =="M" & Education4_0 == "Less than High School Diploma" & MAT_Lang_0=="French" ~ 36.630 - 0.252*Age_0,
      Sex_0 =="M" & Education4_0 == "High School Diploma" & MAT_Lang_0=="French" ~ 38.784 - 0.181*Age_0,
      Sex_0 =="M" & Education4_0 == "Some College" & MAT_Lang_0=="French" ~ 51.105 - 0.381*Age_0,
      Sex_0 =="M" & Education4_0 == "College Degree or Higher" & MAT_Lang_0=="French" ~ 44.106 - 0.257*Age_0,
      Sex_0 =="F" & Education4_0 == "Less than High School Diploma" & MAT_Lang_0=="French" ~ 34.814 - 0.214*Age_0,
      Sex_0 =="F" & Education4_0 == "High School Diploma" & MAT_Lang_0=="French" ~ 38.756 - 0.202*Age_0,
      Sex_0 =="F" & Education4_0 == "Some College" & MAT_Lang_0=="French" ~ 47.024 - 0.315*Age_0,
      Sex_0 =="F" & Education4_0 == "College Degree or Higher" & MAT_Lang_0=="French" ~ 41.717 - 0.234*Age_0
    ),
    MAT_Residual_0 = MAT_Score_0 - MAT_Predicted_0,
    MAT_Z_0 = case_when(
      Sex_0 =="M" & Education4_0 == "Less than High School Diploma" & MAT_Lang_0=="English" ~ MAT_Residual_0/7.602,
      Sex_0 =="M" & Education4_0 == "High School Diploma" & MAT_Lang_0=="English" ~ MAT_Residual_0/7.702,
      Sex_0 =="M" & Education4_0 == "Some College" & MAT_Lang_0=="English" ~ MAT_Residual_0/7.490,
      Sex_0 =="M" & Education4_0 == "College Degree or Higher" & MAT_Lang_0=="English" ~ MAT_Residual_0/7.727,
      Sex_0 =="F" & Education4_0 == "Less than High School Diploma" & MAT_Lang_0=="English" ~ MAT_Residual_0/7.080,
      Sex_0 =="F" & Education4_0 == "High School Diploma" & MAT_Lang_0=="English" ~ MAT_Residual_0/7.139,
      Sex_0 =="F" & Education4_0 == "Some College" & MAT_Lang_0=="English" ~ MAT_Residual_0/6.915,
      Sex_0 =="F" & Education4_0 == "College Degree or Higher" & MAT_Lang_0=="English" ~ MAT_Residual_0/6.979,
      Sex_0 =="M" & Education4_0 == "Less than High School Diploma" & MAT_Lang_0=="French" ~ MAT_Residual_0/7.589,
      Sex_0 =="M" & Education4_0 == "High School Diploma" & MAT_Lang_0=="French" ~ MAT_Residual_0/7.234,
      Sex_0 =="M" & Education4_0 == "Some College" & MAT_Lang_0=="French" ~ MAT_Residual_0/6.314,
      Sex_0 =="M" & Education4_0 == "College Degree or Higher" & MAT_Lang_0=="French" ~ MAT_Residual_0/7.609,
      Sex_0 =="F" & Education4_0 == "Less than High School Diploma" & MAT_Lang_0=="French" ~ MAT_Residual_0/6.803,
      Sex_0 =="F" & Education4_0 == "High School Diploma" & MAT_Lang_0=="French" ~ MAT_Residual_0/7.079,
      Sex_0 =="F" & Education4_0 == "Some College" & MAT_Lang_0=="French" ~ MAT_Residual_0/6.451,
      Sex_0 =="F" & Education4_0 == "College Degree or Higher" & MAT_Lang_0=="French" ~ MAT_Residual_0/6.734
    ),
    MAT_Normed_0 = MAT_Z_0*3 +10,
    MAT_Normed_0 = if_else(MAT_Normed_0 < 0, 0.01, MAT_Normed_0),
    
    #Global Cognition Composite Score
    Global_Composite_0 = RVLT_Immediate_Z_0 + RVLT_Delayed_Z_0 + Animal_Fluency_Z_0 + MAT_Z_0,
    
    #FU1 Scores
    
    #RVLT Immediate Score
    RVLT_Immediate_Predicted_1 = case_when(
      Sex_1 =="M" & Education4_1 == "Less than High School Diploma" & RVLT_Immediate_Lang_1=="English" ~ 7.768 - 0.050*Age_1,
      Sex_1 =="M" & Education4_1 == "High School Diploma" & RVLT_Immediate_Lang_1=="English" ~ 7.449 - 0.036*Age_1,
      Sex_1 =="M" & Education4_1 == "Some College" & RVLT_Immediate_Lang_1=="English" ~ 10.095 - 0.073*Age_1,
      Sex_1 =="M" & Education4_1 == "College Degree or Higher" & RVLT_Immediate_Lang_1=="English" ~ 9.686 - 0.064*Age_1,
      Sex_1 =="F" & Education4_1 == "Less than High School Diploma" & RVLT_Immediate_Lang_1=="English" ~ 8.077 - 0.043*Age_1,
      Sex_1 =="F" & Education4_1 == "High School Diploma" & RVLT_Immediate_Lang_1=="English" ~ 9.806 - 0.059*Age_1,
      Sex_1 =="F" & Education4_1 == "Some College" & RVLT_Immediate_Lang_1=="English" ~ 9.161 - 0.047*Age_1,
      Sex_1 =="F" & Education4_1 == "College Degree or Higher" & RVLT_Immediate_Lang_1=="English" ~ 9.804 - 0.053*Age_1,
      Sex_1 =="M" & Education4_1 == "Less than High School Diploma" & RVLT_Immediate_Lang_1=="French" ~ 5.666 - 0.025*Age_1,
      Sex_1 =="M" & Education4_1 == "High School Diploma" & RVLT_Immediate_Lang_1=="French" ~ 8.953 - 0.067*Age_1,
      Sex_1 =="M" & Education4_1 == "Some College" & RVLT_Immediate_Lang_1=="French" ~ 7.662 - 0.039*Age_1,
      Sex_1 =="M" & Education4_1 == "College Degree or Higher" & RVLT_Immediate_Lang_1=="French" ~ 8.829 - 0.057*Age_1,
      Sex_1 =="F" & Education4_1 == "Less than High School Diploma" & RVLT_Immediate_Lang_1=="French" ~ 6.976 - 0.031*Age_1,
      Sex_1 =="F" & Education4_1 == "High School Diploma" & RVLT_Immediate_Lang_1=="French" ~ 8.667 - 0.045*Age_1,
      Sex_1 =="F" & Education4_1 == "Some College" & RVLT_Immediate_Lang_1=="French" ~ 9.502 - 0.061*Age_1,
      Sex_1 =="F" & Education4_1 == "College Degree or Higher" & RVLT_Immediate_Lang_1=="French" ~ 9.013 - 0.047*Age_1
    ),
    RVLT_Immediate_Residual_1 = RVLT_Immediate_Score_1 - RVLT_Immediate_Predicted_1,
    RVLT_Immediate_Z_1 = case_when(
      Sex_1 =="M" & Education4_1 == "Less than High School Diploma" & RVLT_Immediate_Lang_1=="English" ~ RVLT_Immediate_Residual_1/1.471,
      Sex_1 =="M" & Education4_1 == "High School Diploma" & RVLT_Immediate_Lang_1=="English" ~ RVLT_Immediate_Residual_1/1.525,
      Sex_1 =="M" & Education4_1 == "Some College" & RVLT_Immediate_Lang_1=="English" ~ RVLT_Immediate_Residual_1/1.611,
      Sex_1 =="M" & Education4_1 == "College Degree or Higher" & RVLT_Immediate_Lang_1=="English" ~ RVLT_Immediate_Residual_1/1.675,
      Sex_1 =="F" & Education4_1 == "Less than High School Diploma" & RVLT_Immediate_Lang_1=="English" ~ RVLT_Immediate_Residual_1/1.528,
      Sex_1 =="F" & Education4_1 == "High School Diploma" & RVLT_Immediate_Lang_1=="English" ~ RVLT_Immediate_Residual_1/1.643,
      Sex_1 =="F" & Education4_1 == "Some College" & RVLT_Immediate_Lang_1=="English" ~ RVLT_Immediate_Residual_1/1.694,
      Sex_1 =="F" & Education4_1 == "College Degree or Higher" & RVLT_Immediate_Lang_1=="English" ~ RVLT_Immediate_Residual_1/1.802,
      Sex_1 =="M" & Education4_1 == "Less than High School Diploma" & RVLT_Immediate_Lang_1=="French" ~ RVLT_Immediate_Residual_1/1.290,
      Sex_1 =="M" & Education4_1 == "High School Diploma" & RVLT_Immediate_Lang_1=="French" ~ RVLT_Immediate_Residual_1/1.473,
      Sex_1 =="M" & Education4_1 == "Some College" & RVLT_Immediate_Lang_1=="French" ~ RVLT_Immediate_Residual_1/1.913,
      Sex_1 =="M" & Education4_1 == "College Degree or Higher" & RVLT_Immediate_Lang_1=="French" ~ RVLT_Immediate_Residual_1/1.641,
      Sex_1 =="F" & Education4_1 == "Less than High School Diploma" & RVLT_Immediate_Lang_1=="French" ~ RVLT_Immediate_Residual_1/1.623,
      Sex_1 =="F" & Education4_1 == "High School Diploma" & RVLT_Immediate_Lang_1=="French" ~ RVLT_Immediate_Residual_1/1.595,
      Sex_1 =="F" & Education4_1 == "Some College" & RVLT_Immediate_Lang_1=="French" ~ RVLT_Immediate_Residual_1/1.605,
      Sex_1 =="F" & Education4_1 == "College Degree or Higher" & RVLT_Immediate_Lang_1=="French" ~ RVLT_Immediate_Residual_1/1.715
    ),
    RVLT_Immediate_Normed_1 = RVLT_Immediate_Z_1*3 + 10,
    RVLT_Immediate_Normed_1 = if_else(RVLT_Immediate_Normed_1 < 0, 0.01, RVLT_Immediate_Normed_1),
    
    
    #RVLT Delayed Score
    RVLT_Delayed_Predicted_1 = case_when(
      Sex_1 =="M" & Education4_1 == "Less than High School Diploma" & RVLT_Delayed_Lang_1=="English" ~ 6.628 - 0.062*Age_1,
      Sex_1 =="M" & Education4_1 == "High School Diploma" & RVLT_Delayed_Lang_1=="English" ~ 6.851 - 0.058*Age_1,
      Sex_1 =="M" & Education4_1 == "Some College" & RVLT_Delayed_Lang_1=="English" ~ 8.289 - 0.076*Age_1,
      Sex_1 =="M" & Education4_1 == "College Degree or Higher" & RVLT_Delayed_Lang_1=="English" ~ 8.165 - 0.070*Age_1,
      Sex_1 =="F" & Education4_1 == "Less than High School Diploma" & RVLT_Delayed_Lang_1=="English" ~ 7.163 - 0.055*Age_1,
      Sex_1 =="F" & Education4_1 == "High School Diploma" & RVLT_Delayed_Lang_1=="English" ~ 8.115 - 0.063*Age_1,
      Sex_1 =="F" & Education4_1 == "Some College" & RVLT_Delayed_Lang_1=="English" ~ 8.151 - 0.059*Age_1,
      Sex_1 =="F" & Education4_1 == "College Degree or Higher" & RVLT_Delayed_Lang_1=="English" ~ 8.844 - 0.066*Age_1,
      Sex_1 =="M" & Education4_1 == "Less than High School Diploma" & RVLT_Delayed_Lang_1=="French" ~ 4.802 - 0.036*Age_1,
      Sex_1 =="M" & Education4_1 == "High School Diploma" & RVLT_Delayed_Lang_1=="French" ~ 8.219 - 0.083*Age_1,
      Sex_1 =="M" & Education4_1 == "Some College" & RVLT_Delayed_Lang_1=="French" ~ 9.721 - 0.097*Age_1,
      Sex_1 =="M" & Education4_1 == "College Degree or Higher" & RVLT_Delayed_Lang_1=="French" ~ 7.048 - 0.055*Age_1,
      Sex_1 =="F" & Education4_1 == "Less than High School Diploma" & RVLT_Delayed_Lang_1=="French" ~ 6.280 - 0.044*Age_1,
      Sex_1 =="F" & Education4_1 == "High School Diploma" & RVLT_Delayed_Lang_1=="French" ~ 6.999 - 0.042*Age_1,
      Sex_1 =="F" & Education4_1 == "Some College" & RVLT_Delayed_Lang_1=="French" ~ 9.081 - 0.074*Age_1,
      Sex_1 =="F" & Education4_1 == "College Degree or Higher" & RVLT_Delayed_Lang_1=="French" ~ 8.712 - 0.066*Age_1
    ),
    RVLT_Delayed_Residual_1 = RVLT_Delayed_Score_1 - RVLT_Delayed_Predicted_1,
    RVLT_Delayed_Z_1 = case_when(
      Sex_1 =="M" & Education4_1 == "Less than High School Diploma" & RVLT_Delayed_Lang_1=="English" ~ RVLT_Delayed_Residual_1/1.534,
      Sex_1 =="M" & Education4_1 == "High School Diploma" & RVLT_Delayed_Lang_1=="English" ~ RVLT_Delayed_Residual_1/1.739,
      Sex_1 =="M" & Education4_1 == "Some College" & RVLT_Delayed_Lang_1=="English" ~ RVLT_Delayed_Residual_1/1.802,
      Sex_1 =="M" & Education4_1 == "College Degree or Higher" & RVLT_Delayed_Lang_1=="English" ~ RVLT_Delayed_Residual_1/1.890,
      Sex_1 =="F" & Education4_1 == "Less than High School Diploma" & RVLT_Delayed_Lang_1=="English" ~ RVLT_Delayed_Residual_1/1.787,
      Sex_1 =="F" & Education4_1 == "High School Diploma" & RVLT_Delayed_Lang_1=="English" ~ RVLT_Delayed_Residual_1/2.005,
      Sex_1 =="F" & Education4_1 == "Some College" & RVLT_Delayed_Lang_1=="English" ~ RVLT_Delayed_Residual_1/1.869,
      Sex_1 =="F" & Education4_1 == "College Degree or Higher" & RVLT_Delayed_Lang_1=="English" ~ RVLT_Delayed_Residual_1/2.135,
      Sex_1 =="M" & Education4_1 == "Less than High School Diploma" & RVLT_Delayed_Lang_1=="French" ~ RVLT_Delayed_Residual_1/1.559,
      Sex_1 =="M" & Education4_1 == "High School Diploma" & RVLT_Delayed_Lang_1=="French" ~ RVLT_Delayed_Residual_1/1.571,
      Sex_1 =="M" & Education4_1 == "Some College" & RVLT_Delayed_Lang_1=="French" ~ RVLT_Delayed_Residual_1/1.815,
      Sex_1 =="M" & Education4_1 == "College Degree or Higher" & RVLT_Delayed_Lang_1=="French" ~ RVLT_Delayed_Residual_1/1.721,
      Sex_1 =="F" & Education4_1 == "Less than High School Diploma" & RVLT_Delayed_Lang_1=="French" ~ RVLT_Delayed_Residual_1/1.859,
      Sex_1 =="F" & Education4_1 == "High School Diploma" & RVLT_Delayed_Lang_1=="French" ~ RVLT_Delayed_Residual_1/1.793,
      Sex_1 =="F" & Education4_1 == "Some College" & RVLT_Delayed_Lang_1=="French" ~ RVLT_Delayed_Residual_1/1.901,
      Sex_1 =="F" & Education4_1 == "College Degree or Higher" & RVLT_Delayed_Lang_1=="French" ~ RVLT_Delayed_Residual_1/1.890
    ),
    RVLT_Delayed_Normed_1 = RVLT_Delayed_Z_1*3 + 10,
    RVLT_Delayed_Normed_1 = if_else(RVLT_Delayed_Normed_1 < 0, 0.01, RVLT_Delayed_Normed_1),
    
    #Animal Fluency
    Animal_Fluency_Predicted_1 = case_when(
      Sex_1 =="M" & Education4_1 == "Less than High School Diploma" & Animal_Fluency_Lang_1=="English" ~ 23.132 - 0.095*Age_1,
      Sex_1 =="M" & Education4_1 == "High School Diploma" & Animal_Fluency_Lang_1=="English" ~ 28.923 - 0.157*Age_1,
      Sex_1 =="M" & Education4_1 == "Some College" & Animal_Fluency_Lang_1=="English" ~ 32.513 - 0.202*Age_1,
      Sex_1 =="M" & Education4_1 == "College Degree or Higher" & Animal_Fluency_Lang_1=="English" ~ 31.143 - 0.168*Age_1,
      Sex_1 =="F" & Education4_1 == "Less than High School Diploma" & Animal_Fluency_Lang_1=="English" ~ 23.433 - 0.114*Age_1,
      Sex_1 =="F" & Education4_1 == "High School Diploma" & Animal_Fluency_Lang_1=="English" ~ 29.912 - 0.181*Age_1,
      Sex_1 =="F" & Education4_1 == "Some College" & Animal_Fluency_Lang_1=="English" ~ 30.764 - 0.178*Age_1,
      Sex_1 =="F" & Education4_1 == "College Degree or Higher" & Animal_Fluency_Lang_1=="English" ~ 32.003 - 0.186*Age_1,
      Sex_1 =="M" & Education4_1 == "Less than High School Diploma" & Animal_Fluency_Lang_1=="French" ~ 26.034 - 0.152*Age_1,
      Sex_1 =="M" & Education4_1 == "High School Diploma" & Animal_Fluency_Lang_1=="French" ~ 33.358 - 0.241*Age_1,
      Sex_1 =="M" & Education4_1 == "Some College" & Animal_Fluency_Lang_1=="French" ~ 36.511 - 0.277*Age_1,
      Sex_1 =="M" & Education4_1 == "College Degree or Higher" & Animal_Fluency_Lang_1=="French" ~ 30.193 - 0.179*Age_1,
      Sex_1 =="F" & Education4_1 == "Less than High School Diploma" & Animal_Fluency_Lang_1=="French" ~ 21.460 - 0.089*Age_1,
      Sex_1 =="F" & Education4_1 == "High School Diploma" & Animal_Fluency_Lang_1=="French" ~ 21.355 - 0.070*Age_1,
      Sex_1 =="F" & Education4_1 == "Some College" & Animal_Fluency_Lang_1=="French" ~ 30.881 - 0.205*Age_1,
      Sex_1 =="F" & Education4_1 == "College Degree or Higher" & Animal_Fluency_Lang_1=="French" ~ 29.961 - 0.180*Age_1
    ),
    Animal_Fluency_Residual_1 = Animal_Fluency_Strict_1 - Animal_Fluency_Predicted_1,
    Animal_Fluency_Z_1 = case_when(
      Sex_1 =="M" & Education4_1 == "Less than High School Diploma" & Animal_Fluency_Lang_1=="English" ~ Animal_Fluency_Residual_1/5.145,
      Sex_1 =="M" & Education4_1 == "High School Diploma" & Animal_Fluency_Lang_1=="English" ~ Animal_Fluency_Residual_1/5.348,
      Sex_1 =="M" & Education4_1 == "Some College" & Animal_Fluency_Lang_1=="English" ~ Animal_Fluency_Residual_1/5.163,
      Sex_1 =="M" & Education4_1 == "College Degree or Higher" & Animal_Fluency_Lang_1=="English" ~ Animal_Fluency_Residual_1/5.354,
      Sex_1 =="F" & Education4_1 == "Less than High School Diploma" & Animal_Fluency_Lang_1=="English" ~ Animal_Fluency_Residual_1/4.665,
      Sex_1 =="F" & Education4_1 == "High School Diploma" & Animal_Fluency_Lang_1=="English" ~ Animal_Fluency_Residual_1/4.728,
      Sex_1 =="F" & Education4_1 == "Some College" & Animal_Fluency_Lang_1=="English" ~ Animal_Fluency_Residual_1/5.176,
      Sex_1 =="F" & Education4_1 == "College Degree or Higher" & Animal_Fluency_Lang_1=="English" ~ Animal_Fluency_Residual_1/5.369,
      Sex_1 =="M" & Education4_1 == "Less than High School Diploma" & Animal_Fluency_Lang_1=="French" ~ Animal_Fluency_Residual_1/3.911,
      Sex_1 =="M" & Education4_1 == "High School Diploma" & Animal_Fluency_Lang_1=="French" ~ Animal_Fluency_Residual_1/4.889,
      Sex_1 =="M" & Education4_1 == "Some College" & Animal_Fluency_Lang_1=="French" ~ Animal_Fluency_Residual_1/5.061,
      Sex_1 =="M" & Education4_1 == "College Degree or Higher" & Animal_Fluency_Lang_1=="French" ~ Animal_Fluency_Residual_1/4.869,
      Sex_1 =="F" & Education4_1 == "Less than High School Diploma" & Animal_Fluency_Lang_1=="French" ~ Animal_Fluency_Residual_1/4.178,
      Sex_1 =="F" & Education4_1 == "High School Diploma" & Animal_Fluency_Lang_1=="French" ~ Animal_Fluency_Residual_1/4.321,
      Sex_1 =="F" & Education4_1 == "Some College" & Animal_Fluency_Lang_1=="French" ~ Animal_Fluency_Residual_1/4.468,
      Sex_1 =="F" & Education4_1 == "College Degree or Higher" & Animal_Fluency_Lang_1=="French" ~ Animal_Fluency_Residual_1/4.940
    ),
    Animal_Fluency_Normed_1 = Animal_Fluency_Z_1*3 + 10,
    Animal_Fluency_Normed_1 = if_else(Animal_Fluency_Normed_1 < 0, 0.01, Animal_Fluency_Normed_1),
    
    #Mental Alteration Test
    MAT_Predicted_1 = case_when(
      Sex_1 =="M" & Education4_1 == "Less than High School Diploma" & MAT_Lang_1=="English" ~ 33.295 - 0.161*Age_1,
      Sex_1 =="M" & Education4_1 == "High School Diploma" & MAT_Lang_1=="English" ~ 34.074 - 0.123*Age_1,
      Sex_1 =="M" & Education4_1 == "Some College" & MAT_Lang_1=="English" ~ 41.488 - 0.219*Age_1,
      Sex_1 =="M" & Education4_1 == "College Degree or Higher" & MAT_Lang_1=="English" ~ 40.573 - 0.190*Age_1,
      Sex_1 =="F" & Education4_1 == "Less than High School Diploma" & MAT_Lang_1=="English" ~ 39.102 - 0.251*Age_1,
      Sex_1 =="F" & Education4_1 == "High School Diploma" & MAT_Lang_1=="English" ~ 41.657 - 0.246*Age_1,
      Sex_1 =="F" & Education4_1 == "Some College" & MAT_Lang_1=="English" ~ 36.877 - 0.168*Age_1,
      Sex_1 =="F" & Education4_1 == "College Degree or Higher" & MAT_Lang_1=="English" ~ 38.849 - 0.188*Age_1,
      Sex_1 =="M" & Education4_1 == "Less than High School Diploma" & MAT_Lang_1=="French" ~ 36.630 - 0.252*Age_1,
      Sex_1 =="M" & Education4_1 == "High School Diploma" & MAT_Lang_1=="French" ~ 38.784 - 0.181*Age_1,
      Sex_1 =="M" & Education4_1 == "Some College" & MAT_Lang_1=="French" ~ 51.105 - 0.381*Age_1,
      Sex_1 =="M" & Education4_1 == "College Degree or Higher" & MAT_Lang_1=="French" ~ 44.106 - 0.257*Age_1,
      Sex_1 =="F" & Education4_1 == "Less than High School Diploma" & MAT_Lang_1=="French" ~ 34.814 - 0.214*Age_1,
      Sex_1 =="F" & Education4_1 == "High School Diploma" & MAT_Lang_1=="French" ~ 38.756 - 0.202*Age_1,
      Sex_1 =="F" & Education4_1 == "Some College" & MAT_Lang_1=="French" ~ 47.024 - 0.315*Age_1,
      Sex_1 =="F" & Education4_1 == "College Degree or Higher" & MAT_Lang_1=="French" ~ 41.717 - 0.234*Age_1
    ),
    MAT_Residual_1 = MAT_Score_1 - MAT_Predicted_1,
    MAT_Z_1 = case_when(
      Sex_1 =="M" & Education4_1 == "Less than High School Diploma" & MAT_Lang_1=="English" ~ MAT_Residual_1/7.602,
      Sex_1 =="M" & Education4_1 == "High School Diploma" & MAT_Lang_1=="English" ~ MAT_Residual_1/7.702,
      Sex_1 =="M" & Education4_1 == "Some College" & MAT_Lang_1=="English" ~ MAT_Residual_1/7.490,
      Sex_1 =="M" & Education4_1 == "College Degree or Higher" & MAT_Lang_1=="English" ~ MAT_Residual_1/7.727,
      Sex_1 =="F" & Education4_1 == "Less than High School Diploma" & MAT_Lang_1=="English" ~ MAT_Residual_1/7.080,
      Sex_1 =="F" & Education4_1 == "High School Diploma" & MAT_Lang_1=="English" ~ MAT_Residual_1/7.139,
      Sex_1 =="F" & Education4_1 == "Some College" & MAT_Lang_1=="English" ~ MAT_Residual_1/6.915,
      Sex_1 =="F" & Education4_1 == "College Degree or Higher" & MAT_Lang_1=="English" ~ MAT_Residual_1/6.979,
      Sex_1 =="M" & Education4_1 == "Less than High School Diploma" & MAT_Lang_1=="French" ~ MAT_Residual_1/7.589,
      Sex_1 =="M" & Education4_1 == "High School Diploma" & MAT_Lang_1=="French" ~ MAT_Residual_1/7.234,
      Sex_1 =="M" & Education4_1 == "Some College" & MAT_Lang_1=="French" ~ MAT_Residual_1/6.314,
      Sex_1 =="M" & Education4_1 == "College Degree or Higher" & MAT_Lang_1=="French" ~ MAT_Residual_1/7.609,
      Sex_1 =="F" & Education4_1 == "Less than High School Diploma" & MAT_Lang_1=="French" ~ MAT_Residual_1/6.803,
      Sex_1 =="F" & Education4_1 == "High School Diploma" & MAT_Lang_1=="French" ~ MAT_Predicted_1/7.079,
      Sex_1 =="F" & Education4_1 == "Some College" & MAT_Lang_1=="French" ~ MAT_Predicted_1/6.451,
      Sex_1 =="F" & Education4_1 == "College Degree or Higher" & MAT_Lang_1=="French" ~ MAT_Predicted_1/6.734
    ),
    MAT_Normed_1 = MAT_Z_1*3 + 10,
    MAT_Normed_1 = if_else(MAT_Normed_1 < 0, 0.01, MAT_Normed_1),
    
    #Global Cognition Composite Score
    Global_Composite_1 = RVLT_Immediate_Z_1 + RVLT_Delayed_Z_1 + Animal_Fluency_Z_1 + MAT_Z_1,
    
    
    #FU2 Scores
    
    #RVLT Immediate Score
    RVLT_Immediate_Predicted_2 = case_when(
      Sex_2 =="M" & Education4_2 == "Less than High School Diploma" & RVLT_Immediate_Lang_2=="English" ~ 7.768 - 0.050*Age_2,
      Sex_2 =="M" & Education4_2 == "High School Diploma" & RVLT_Immediate_Lang_2=="English" ~ 7.449 - 0.036*Age_2,
      Sex_2 =="M" & Education4_2 == "Some College" & RVLT_Immediate_Lang_2=="English" ~ 10.095 - 0.073*Age_2,
      Sex_2 =="M" & Education4_2 == "College Degree or Higher" & RVLT_Immediate_Lang_2=="English" ~ 9.686 - 0.064*Age_2,
      Sex_2 =="F" & Education4_2 == "Less than High School Diploma" & RVLT_Immediate_Lang_2=="English" ~ 8.077 - 0.043*Age_2,
      Sex_2 =="F" & Education4_2 == "High School Diploma" & RVLT_Immediate_Lang_2=="English" ~ 9.806 - 0.059*Age_2,
      Sex_2 =="F" & Education4_2 == "Some College" & RVLT_Immediate_Lang_2=="English" ~ 9.161 - 0.047*Age_2,
      Sex_2 =="F" & Education4_2 == "College Degree or Higher" & RVLT_Immediate_Lang_2=="English" ~ 9.804 - 0.053*Age_2,
      Sex_2 =="M" & Education4_2 == "Less than High School Diploma" & RVLT_Immediate_Lang_2=="French" ~ 5.666 - 0.025*Age_2,
      Sex_2 =="M" & Education4_2 == "High School Diploma" & RVLT_Immediate_Lang_2=="French" ~ 8.953 - 0.067*Age_2,
      Sex_2 =="M" & Education4_2 == "Some College" & RVLT_Immediate_Lang_2=="French" ~ 7.662 - 0.039*Age_2,
      Sex_2 =="M" & Education4_2 == "College Degree or Higher" & RVLT_Immediate_Lang_2=="French" ~ 8.829 - 0.057*Age_2,
      Sex_2 =="F" & Education4_2 == "Less than High School Diploma" & RVLT_Immediate_Lang_2=="French" ~ 6.976 - 0.031*Age_2,
      Sex_2 =="F" & Education4_2 == "High School Diploma" & RVLT_Immediate_Lang_2=="French" ~ 8.667 - 0.045*Age_2,
      Sex_2 =="F" & Education4_2 == "Some College" & RVLT_Immediate_Lang_2=="French" ~ 9.502 - 0.061*Age_2,
      Sex_2 =="F" & Education4_2 == "College Degree or Higher" & RVLT_Immediate_Lang_2=="French" ~ 9.013 - 0.047*Age_2
    ),
    RVLT_Immediate_Residual_2 = RVLT_Immediate_Score_2 - RVLT_Immediate_Predicted_2,
    RVLT_Immediate_Z_2 = case_when(
      Sex_2 =="M" & Education4_2 == "Less than High School Diploma" & RVLT_Immediate_Lang_2=="English" ~ RVLT_Immediate_Residual_2/1.471,
      Sex_2 =="M" & Education4_2 == "High School Diploma" & RVLT_Immediate_Lang_2=="English" ~ RVLT_Immediate_Residual_2/1.525,
      Sex_2 =="M" & Education4_2 == "Some College" & RVLT_Immediate_Lang_2=="English" ~ RVLT_Immediate_Residual_2/1.611,
      Sex_2 =="M" & Education4_2 == "College Degree or Higher" & RVLT_Immediate_Lang_2=="English" ~ RVLT_Immediate_Residual_2/1.675,
      Sex_2 =="F" & Education4_2 == "Less than High School Diploma" & RVLT_Immediate_Lang_2=="English" ~ RVLT_Immediate_Residual_2/1.528,
      Sex_2 =="F" & Education4_2 == "High School Diploma" & RVLT_Immediate_Lang_2=="English" ~ RVLT_Immediate_Residual_2/1.643,
      Sex_2 =="F" & Education4_2 == "Some College" & RVLT_Immediate_Lang_2=="English" ~ RVLT_Immediate_Residual_2/1.694,
      Sex_2 =="F" & Education4_2 == "College Degree or Higher" & RVLT_Immediate_Lang_2=="English" ~ RVLT_Immediate_Residual_2/1.802,
      Sex_2 =="M" & Education4_2 == "Less than High School Diploma" & RVLT_Immediate_Lang_2=="French" ~ RVLT_Immediate_Residual_2/1.290,
      Sex_2 =="M" & Education4_2 == "High School Diploma" & RVLT_Immediate_Lang_2=="French" ~ RVLT_Immediate_Residual_2/1.473,
      Sex_2 =="M" & Education4_2 == "Some College" & RVLT_Immediate_Lang_2=="French" ~ RVLT_Immediate_Residual_2/1.913,
      Sex_2 =="M" & Education4_2 == "College Degree or Higher" & RVLT_Immediate_Lang_2=="French" ~ RVLT_Immediate_Residual_2/1.641,
      Sex_2 =="F" & Education4_2 == "Less than High School Diploma" & RVLT_Immediate_Lang_2=="French" ~ RVLT_Immediate_Residual_2/1.623,
      Sex_2 =="F" & Education4_2 == "High School Diploma" & RVLT_Immediate_Lang_2=="French" ~ RVLT_Immediate_Residual_2/1.595,
      Sex_2 =="F" & Education4_2 == "Some College" & RVLT_Immediate_Lang_2=="French" ~ RVLT_Immediate_Residual_2/1.605,
      Sex_2 =="F" & Education4_2 == "College Degree or Higher" & RVLT_Immediate_Lang_2=="French" ~ RVLT_Immediate_Residual_2/1.715
    ),
    RVLT_Immediate_Normed_2 = RVLT_Immediate_Z_2*3 + 10,
    RVLT_Immediate_Normed_2 = if_else(RVLT_Immediate_Normed_2 < 0, 0.01, RVLT_Immediate_Normed_2),
    
    #RVLT Delayed Score
    RVLT_Delayed_Predicted_2 = case_when(
      Sex_2 =="M" & Education4_2 == "Less than High School Diploma" & RVLT_Delayed_Lang_2=="English" ~ 6.628 - 0.062*Age_2,
      Sex_2 =="M" & Education4_2 == "High School Diploma" & RVLT_Delayed_Lang_2=="English" ~ 6.851 - 0.058*Age_2,
      Sex_2 =="M" & Education4_2 == "Some College" & RVLT_Delayed_Lang_2=="English" ~ 8.289 - 0.076*Age_2,
      Sex_2 =="M" & Education4_2 == "College Degree or Higher" & RVLT_Delayed_Lang_2=="English" ~ 8.165 - 0.070*Age_2,
      Sex_2 =="F" & Education4_2 == "Less than High School Diploma" & RVLT_Delayed_Lang_2=="English" ~ 7.163 - 0.055*Age_2,
      Sex_2 =="F" & Education4_2 == "High School Diploma" & RVLT_Delayed_Lang_2=="English" ~ 8.115 - 0.063*Age_2,
      Sex_2 =="F" & Education4_2 == "Some College" & RVLT_Delayed_Lang_2=="English" ~ 8.151 - 0.059*Age_2,
      Sex_2 =="F" & Education4_2 == "College Degree or Higher" & RVLT_Delayed_Lang_2=="English" ~ 8.844 - 0.066*Age_2,
      Sex_2 =="M" & Education4_2 == "Less than High School Diploma" & RVLT_Delayed_Lang_2=="French" ~ 4.802 - 0.036*Age_2,
      Sex_2 =="M" & Education4_2 == "High School Diploma" & RVLT_Delayed_Lang_2=="French" ~ 8.219 - 0.083*Age_2,
      Sex_2 =="M" & Education4_2 == "Some College" & RVLT_Delayed_Lang_2=="French" ~ 9.721 - 0.097*Age_2,
      Sex_2 =="M" & Education4_2 == "College Degree or Higher" & RVLT_Delayed_Lang_2=="French" ~ 7.048 - 0.055*Age_2,
      Sex_2 =="F" & Education4_2 == "Less than High School Diploma" & RVLT_Delayed_Lang_2=="French" ~ 6.280 - 0.044*Age_2,
      Sex_2 =="F" & Education4_2 == "High School Diploma" & RVLT_Delayed_Lang_2=="French" ~ 6.999 - 0.042*Age_2,
      Sex_2 =="F" & Education4_2 == "Some College" & RVLT_Delayed_Lang_2=="French" ~ 9.081 - 0.074*Age_2,
      Sex_2 =="F" & Education4_2 == "College Degree or Higher" & RVLT_Delayed_Lang_2=="French" ~ 8.712 - 0.066*Age_2
    ),
    RVLT_Delayed_Residual_2 = RVLT_Delayed_Score_2 - RVLT_Delayed_Predicted_2,
    RVLT_Delayed_Z_2 = case_when(
      Sex_2 =="M" & Education4_2 == "Less than High School Diploma" & RVLT_Delayed_Lang_2=="English" ~ RVLT_Delayed_Residual_2/1.534,
      Sex_2 =="M" & Education4_2 == "High School Diploma" & RVLT_Delayed_Lang_2=="English" ~ RVLT_Delayed_Residual_2/1.739,
      Sex_2 =="M" & Education4_2 == "Some College" & RVLT_Delayed_Lang_2=="English" ~ RVLT_Delayed_Residual_2/1.802,
      Sex_2 =="M" & Education4_2 == "College Degree or Higher" & RVLT_Delayed_Lang_2=="English" ~ RVLT_Delayed_Residual_2/1.890,
      Sex_2 =="F" & Education4_2 == "Less than High School Diploma" & RVLT_Delayed_Lang_2=="English" ~ RVLT_Delayed_Residual_2/1.787,
      Sex_2 =="F" & Education4_2 == "High School Diploma" & RVLT_Delayed_Lang_2=="English" ~ RVLT_Delayed_Residual_2/2.005,
      Sex_2 =="F" & Education4_2 == "Some College" & RVLT_Delayed_Lang_2=="English" ~ RVLT_Delayed_Residual_2/1.869,
      Sex_2 =="F" & Education4_2 == "College Degree or Higher" & RVLT_Delayed_Lang_2=="English" ~ RVLT_Delayed_Residual_2/2.135,
      Sex_2 =="M" & Education4_2 == "Less than High School Diploma" & RVLT_Delayed_Lang_2=="French" ~ RVLT_Delayed_Residual_2/1.559,
      Sex_2 =="M" & Education4_2 == "High School Diploma" & RVLT_Delayed_Lang_2=="French" ~ RVLT_Delayed_Residual_2/1.571,
      Sex_2 =="M" & Education4_2 == "Some College" & RVLT_Delayed_Lang_2=="French" ~ RVLT_Delayed_Residual_2/1.815,
      Sex_2 =="M" & Education4_2 == "College Degree or Higher" & RVLT_Delayed_Lang_2=="French" ~ RVLT_Delayed_Residual_2/1.721,
      Sex_2 =="F" & Education4_2 == "Less than High School Diploma" & RVLT_Delayed_Lang_2=="French" ~ RVLT_Delayed_Residual_2/1.859,
      Sex_2 =="F" & Education4_2 == "High School Diploma" & RVLT_Delayed_Lang_2=="French" ~ RVLT_Delayed_Residual_2/1.793,
      Sex_2 =="F" & Education4_2 == "Some College" & RVLT_Delayed_Lang_2=="French" ~ RVLT_Delayed_Residual_2/1.901,
      Sex_2 =="F" & Education4_2 == "College Degree or Higher" & RVLT_Delayed_Lang_2=="French" ~ RVLT_Delayed_Residual_2/1.890
    ),
    RVLT_Delayed_Normed_2 = RVLT_Delayed_Z_2*3 + 10,
    RVLT_Delayed_Normed_2 = if_else(RVLT_Delayed_Normed_2 < 0, 0.01, RVLT_Delayed_Normed_2),
    
    #Animal Fluency
    Animal_Fluency_Predicted_2 = case_when(
      Sex_2 =="M" & Education4_2 == "Less than High School Diploma" & Animal_Fluency_Lang_2=="English" ~ 23.132 - 0.095*Age_2,
      Sex_2 =="M" & Education4_2 == "High School Diploma" & Animal_Fluency_Lang_2=="English" ~ 28.923 - 0.157*Age_2,
      Sex_2 =="M" & Education4_2 == "Some College" & Animal_Fluency_Lang_2=="English" ~ 32.513 - 0.202*Age_2,
      Sex_2 =="M" & Education4_2 == "College Degree or Higher" & Animal_Fluency_Lang_2=="English" ~ 31.143 - 0.168*Age_2,
      Sex_2 =="F" & Education4_2 == "Less than High School Diploma" & Animal_Fluency_Lang_2=="English" ~ 23.433 - 0.114*Age_2,
      Sex_2 =="F" & Education4_2 == "High School Diploma" & Animal_Fluency_Lang_2=="English" ~ 29.912 - 0.181*Age_2,
      Sex_2 =="F" & Education4_2 == "Some College" & Animal_Fluency_Lang_2=="English" ~ 30.764 - 0.178*Age_2,
      Sex_2 =="F" & Education4_2 == "College Degree or Higher" & Animal_Fluency_Lang_2=="English" ~ 32.003 - 0.186*Age_2,
      Sex_2 =="M" & Education4_2 == "Less than High School Diploma" & Animal_Fluency_Lang_2=="French" ~ 26.034 - 0.152*Age_2,
      Sex_2 =="M" & Education4_2 == "High School Diploma" & Animal_Fluency_Lang_2=="French" ~ 33.358 - 0.241*Age_2,
      Sex_2 =="M" & Education4_2 == "Some College" & Animal_Fluency_Lang_2=="French" ~ 36.511 - 0.277*Age_2,
      Sex_2 =="M" & Education4_2 == "College Degree or Higher" & Animal_Fluency_Lang_2=="French" ~ 30.193 - 0.179*Age_2,
      Sex_2 =="F" & Education4_2 == "Less than High School Diploma" & Animal_Fluency_Lang_2=="French" ~ 21.460 - 0.089*Age_2,
      Sex_2 =="F" & Education4_2 == "High School Diploma" & Animal_Fluency_Lang_2=="French" ~ 21.355 - 0.070*Age_2,
      Sex_2 =="F" & Education4_2 == "Some College" & Animal_Fluency_Lang_2=="French" ~ 30.881 - 0.205*Age_2,
      Sex_2 =="F" & Education4_2 == "College Degree or Higher" & Animal_Fluency_Lang_2=="French" ~ 29.961 - 0.180*Age_2
    ),
    Animal_Fluency_Residual_2 = Animal_Fluency_Strict_2 - Animal_Fluency_Predicted_2,
    Animal_Fluency_Z_2 = case_when(
      Sex_2 =="M" & Education4_2 == "Less than High School Diploma" & Animal_Fluency_Lang_2=="English" ~ Animal_Fluency_Residual_2/5.145,
      Sex_2 =="M" & Education4_2 == "High School Diploma" & Animal_Fluency_Lang_2=="English" ~ Animal_Fluency_Residual_2/5.348,
      Sex_2 =="M" & Education4_2 == "Some College" & Animal_Fluency_Lang_2=="English" ~ Animal_Fluency_Residual_2/5.163,
      Sex_2 =="M" & Education4_2 == "College Degree or Higher" & Animal_Fluency_Lang_2=="English" ~ Animal_Fluency_Residual_2/5.354,
      Sex_2 =="F" & Education4_2 == "Less than High School Diploma" & Animal_Fluency_Lang_2=="English" ~ Animal_Fluency_Residual_2/4.665,
      Sex_2 =="F" & Education4_2 == "High School Diploma" & Animal_Fluency_Lang_2=="English" ~ Animal_Fluency_Residual_2/4.728,
      Sex_2 =="F" & Education4_2 == "Some College" & Animal_Fluency_Lang_2=="English" ~ Animal_Fluency_Residual_2/5.176,
      Sex_2 =="F" & Education4_2 == "College Degree or Higher" & Animal_Fluency_Lang_2=="English" ~ Animal_Fluency_Residual_2/5.369,
      Sex_2 =="M" & Education4_2 == "Less than High School Diploma" & Animal_Fluency_Lang_2=="French" ~ Animal_Fluency_Residual_2/3.911,
      Sex_2 =="M" & Education4_2 == "High School Diploma" & Animal_Fluency_Lang_2=="French" ~ Animal_Fluency_Residual_2/4.889,
      Sex_2 =="M" & Education4_2 == "Some College" & Animal_Fluency_Lang_2=="French" ~ Animal_Fluency_Residual_2/5.061,
      Sex_2 =="M" & Education4_2 == "College Degree or Higher" & Animal_Fluency_Lang_2=="French" ~ Animal_Fluency_Residual_2/4.869,
      Sex_2 =="F" & Education4_2 == "Less than High School Diploma" & Animal_Fluency_Lang_2=="French" ~ Animal_Fluency_Residual_2/4.178,
      Sex_2 =="F" & Education4_2 == "High School Diploma" & Animal_Fluency_Lang_2=="French" ~ Animal_Fluency_Residual_2/4.321,
      Sex_2 =="F" & Education4_2 == "Some College" & Animal_Fluency_Lang_2=="French" ~ Animal_Fluency_Residual_2/4.468,
      Sex_2 =="F" & Education4_2 == "College Degree or Higher" & Animal_Fluency_Lang_2=="French" ~ Animal_Fluency_Residual_2/4.940
    ),
    Animal_Fluency_Normed_2 = Animal_Fluency_Z_2*3 + 10,
    Animal_Fluency_Normed_2 = if_else(Animal_Fluency_Normed_2 < 0, 0.01, Animal_Fluency_Normed_2),
    
    #Mental Alteration Test
    MAT_Predicted_2 = case_when(
      Sex_2 =="M" & Education4_2 == "Less than High School Diploma" & MAT_Lang_2=="English" ~ 33.295 - 0.161*Age_2,
      Sex_2 =="M" & Education4_2 == "High School Diploma" & MAT_Lang_2=="English" ~ 34.074 - 0.123*Age_2,
      Sex_2 =="M" & Education4_2 == "Some College" & MAT_Lang_2=="English" ~ 41.488 - 0.219*Age_2,
      Sex_2 =="M" & Education4_2 == "College Degree or Higher" & MAT_Lang_2=="English" ~ 40.573 - 0.190*Age_2,
      Sex_2 =="F" & Education4_2 == "Less than High School Diploma" & MAT_Lang_2=="English" ~ 39.102 - 0.251*Age_2,
      Sex_2 =="F" & Education4_2 == "High School Diploma" & MAT_Lang_2=="English" ~ 41.657 - 0.246*Age_2,
      Sex_2 =="F" & Education4_2 == "Some College" & MAT_Lang_2=="English" ~ 36.877 - 0.168*Age_2,
      Sex_2 =="F" & Education4_2 == "College Degree or Higher" & MAT_Lang_2=="English" ~ 38.849 - 0.188*Age_2,
      Sex_2 =="M" & Education4_2 == "Less than High School Diploma" & MAT_Lang_2=="French" ~ 36.630 - 0.252*Age_2,
      Sex_2 =="M" & Education4_2 == "High School Diploma" & MAT_Lang_2=="French" ~ 38.784 - 0.181*Age_2,
      Sex_2 =="M" & Education4_2 == "Some College" & MAT_Lang_2=="French" ~ 51.105 - 0.381*Age_2,
      Sex_2 =="M" & Education4_2 == "College Degree or Higher" & MAT_Lang_2=="French" ~ 44.106 - 0.257*Age_2,
      Sex_2 =="F" & Education4_2 == "Less than High School Diploma" & MAT_Lang_2=="French" ~ 34.814 - 0.214*Age_2,
      Sex_2 =="F" & Education4_2 == "High School Diploma" & MAT_Lang_2=="French" ~ 38.756 - 0.202*Age_2,
      Sex_2 =="F" & Education4_2 == "Some College" & MAT_Lang_2=="French" ~ 47.024 - 0.315*Age_2,
      Sex_2 =="F" & Education4_2 == "College Degree or Higher" & MAT_Lang_2=="French" ~ 41.717 - 0.234*Age_2
    ),
    MAT_Residual_2 = MAT_Score_2 - MAT_Predicted_2,
    MAT_Z_2 = case_when(
      Sex_2 =="M" & Education4_2 == "Less than High School Diploma" & MAT_Lang_2=="English" ~ MAT_Residual_2/7.602,
      Sex_2 =="M" & Education4_2 == "High School Diploma" & MAT_Lang_2=="English" ~ MAT_Residual_2/7.702,
      Sex_2 =="M" & Education4_2 == "Some College" & MAT_Lang_2=="English" ~ MAT_Residual_2/7.490,
      Sex_2 =="M" & Education4_2 == "College Degree or Higher" & MAT_Lang_2=="English" ~ MAT_Residual_2/7.727,
      Sex_2 =="F" & Education4_2 == "Less than High School Diploma" & MAT_Lang_2=="English" ~ MAT_Residual_2/7.080,
      Sex_2 =="F" & Education4_2 == "High School Diploma" & MAT_Lang_2=="English" ~ MAT_Residual_2/7.139,
      Sex_2 =="F" & Education4_2 == "Some College" & MAT_Lang_2=="English" ~ MAT_Residual_2/6.915,
      Sex_2 =="F" & Education4_2 == "College Degree or Higher" & MAT_Lang_2=="English" ~ MAT_Residual_2/6.979,
      Sex_2 =="M" & Education4_2 == "Less than High School Diploma" & MAT_Lang_2=="French" ~ MAT_Residual_2/7.589,
      Sex_2 =="M" & Education4_2 == "High School Diploma" & MAT_Lang_2=="French" ~ MAT_Residual_2/7.234,
      Sex_2 =="M" & Education4_2 == "Some College" & MAT_Lang_2=="French" ~ MAT_Residual_2/6.314,
      Sex_2 =="M" & Education4_2 == "College Degree or Higher" & MAT_Lang_2=="French" ~ MAT_Residual_2/7.609,
      Sex_2 =="F" & Education4_2 == "Less than High School Diploma" & MAT_Lang_2=="French" ~ MAT_Residual_2/6.803,
      Sex_2 =="F" & Education4_2 == "High School Diploma" & MAT_Lang_2=="French" ~ MAT_Residual_2/7.079,
      Sex_2 =="F" & Education4_2 == "Some College" & MAT_Lang_2=="French" ~ MAT_Residual_2/6.451,
      Sex_2 =="F" & Education4_2 == "College Degree or Higher" & MAT_Lang_2=="French" ~ MAT_Residual_2/6.734
    ),
    MAT_Normed_2 = MAT_Z_2*3 + 10,
    MAT_Normed_2 = if_else(MAT_Normed_2 < 0, 0.01, MAT_Normed_2),
    
    #Global Cognition Composite Score
    Global_Composite_2 = RVLT_Immediate_Z_2 + RVLT_Delayed_Z_2 + Animal_Fluency_Z_0 + MAT_Z_2
  )
```

Finally, we categorized participants as having their follow-up 2 data collected before or after the start of the COVID-19 pandemic. 
```{r}
Tracking.Adjusted_Final <- Tracking.Adjusted_Full %>%
  mutate(timestamp = ymd_hms(startdate_TRF2_2, tz = "EST"))

start_time <- as.POSIXct("2020-03-11 00:00:00", tz = "EST")
Tracking.Adjusted_Final$Pandemic<-NA
Tracking.Adjusted_Final$Pandemic[Tracking.Adjusted_Final$timestamp>=start_time]<-"FU2 data collected after COVID-19"
Tracking.Adjusted_Final$Pandemic[Tracking.Adjusted_Final$timestamp<start_time]<-"FU2 data collected before COVID-19"
```



## 2.1) Flow-chart for participants

Full tracking cohort at baseline (N=21,241)
```{r}
Track.Baseline.total <- Track.Baseline.Final %>%
  count()
print(Track.Baseline.total)
```

Excluding tracking cohort participants lost to follow-up (N=14,697)
```{r}
Track.Complete <- Track.Full %>%
  count()
print(Track.Complete)
```

Baseline tracking cohort removing individuals who reported SCI or dementia at baseline, FU1, or FU2 (N=13,934)
```{r}
Track.SCI_Dementia <- Track.Full %>%
  group_by(SCI_0, Dementia_0, SCI_1, Dementia_1, SCI_2, Dementia_2) %>%
  count()
print(Track.SCI_Dementia)
```

Baseline tracking cohort removing individuals with dementia or SCI and without full cog data (N=11,355)
```{r}
Track.FullCogs <- Track.Full %>%
  group_by(SCI_0, Dementia_0, SCI_1, Dementia_1, SCI_2, Dementia_2, 
           !is.na(MAT_Score_0), !is.na(RVLT_Immediate_Score_0), !is.na(RVLT_Delayed_Score_0),!is.na(Animal_Fluency_Strict_0)) %>%
  count()
print(Track.FullCogs)
```

Final sample size (N=11,355) with complete cognitive data at FU1 grouped by Pandemic cohort
```{r}
Track.FullCogs2 <- Tracking.Adjusted_Final %>%
  group_by(!is.na(MAT_Score_0), !is.na(RVLT_Immediate_Score_0), !is.na(RVLT_Delayed_Score_0),!is.na(Animal_Fluency_Strict_0),
           !is.na(MAT_Score_1), !is.na(RVLT_Immediate_Score_1), !is.na(RVLT_Delayed_Score_1),!is.na(Animal_Fluency_Strict_1), Pandemic) %>%
  count()
print(Track.FullCogs2)
```

Final sample size (N=11,355) with complete cognitive data at FU2 grouped by Pandemic cohort
```{r}
Track.FullCogs3 <- Tracking.Adjusted_Final %>%
  group_by(!is.na(MAT_Score_0), !is.na(RVLT_Immediate_Score_0), !is.na(RVLT_Delayed_Score_0),!is.na(Animal_Fluency_Strict_0),
           !is.na(MAT_Score_2), !is.na(RVLT_Immediate_Score_2), !is.na(RVLT_Delayed_Score_2),!is.na(Animal_Fluency_Strict_2), Pandemic) %>%
  count()
print(Track.FullCogs3)
```
```


Final sample size (N=11,355) and number of participants with PASE score at baseline (N=9,181)
```{r}
PASEBL <- Tracking.Adjusted_Final %>%
  group_by(!is.na(PASE_TOTAL_0), Pandemic) %>%
  count()
print(PASEBL)
```


Final sample size (N=11,355) and number of participants with PASE score at baseline or FU1 (N=1,945)
```{r}
PASEBL <- Tracking.Adjusted_Final %>%
  group_by(!is.na(PASE_TOTAL_0), !is.na(PASE_TOTAL_1),Pandemic) %>%
  count()
print(PASEBL)
```


Final sample size (N=11,355) and number of participants with PASE score at baseline, FU1, or FU2 (N=762)
```{r}
PASEBL <- Tracking.Adjusted_Final %>%
  group_by(!is.na(PASE_TOTAL_0), !is.na(PASE_TOTAL_1), , !is.na(PASE_TOTAL_2),Pandemic) %>%
  count()
print(PASEBL)
```


Final sample size (N=11,355) and number of participants with sleep data at baseline (N=11,334)
```{r}
PASEBL <- Tracking.Adjusted_Final %>%
  group_by(!is.na(RSTLS_Sleep_0),Pandemic) %>%
  count()
print(PASEBL)
```


Final sample size (N=11,355) and number of participants with sleep data at baseline or FU1 (N=11,304)
```{r}
PASEBL <- Tracking.Adjusted_Final %>%
  group_by(!is.na(RSTLS_Sleep_0), !is.na(RSTLS_Sleep_1),Pandemic) %>%
  count()
print(PASEBL)
```


Final sample size (N=11,355) and number of participants with sleep data at baseline, FU1, or FU2 (N=11,270)
```{r}
PASEBL <- Tracking.Adjusted_Final %>%
  group_by(!is.na(RSTLS_Sleep_0), !is.na(RSTLS_Sleep_1), , !is.na(RSTLS_Sleep_2),Pandemic) %>%
  count()
print(PASEBL)
```




# 3) Participant characteristics at baseline

Create factor variables for PASE sedentary behaviour and sleep score
```{r}
BL.data<-Tracking.Adjusted_Final
BL.data$PASE_Q1B_0 <- as.factor(ifelse(BL.data$PASE_Q1B_0==10, 1, 0))
BL.data$RSTLS_Sleep_0 <- as.factor(BL.data$RSTLS_Sleep_0)
```


Final baseline sample (N= 11,355)
```{r}
Baseline<-dput(names(BL.data[c(5,4,14,12,6,7,8,9,10,11,15,18,19,21,98,102,106,110,29,31,27,24,13,22,23)]))
Table1_Final<-CreateTableOne(vars=Baseline, data=BL.data)
print(Table1_Final,contDigits=2,missing=TRUE,quote=TRUE)
```

Final baseline sample stratified by whether FU2 data was collected before (N= 6,174) or after (N= 5,181) the start of the COVID-19 pandemic
```{r}
Table1_Final_stratify<-CreateTableOne(vars=Baseline, strata="Pandemic", data=BL.data)
print(Table1_Final_stratify,contDigits=2,missing=TRUE,quote=TRUE)
```

Stratify Results By Age, Sex, and Pandemic Status
```{r}
BL.data$Age_sex<-NA
BL.data$Age_sex[BL.data$Age_0<=64 & BL.data$Sex_0 == "M"]<-"Males 45-64"
BL.data$Age_sex[BL.data$Age_0<=64 & BL.data$Sex_0 == "F"]<-"Females 45-64"
BL.data$Age_sex[BL.data$Age_0>64 & BL.data$Sex_0 == "M"]<-"Males 65+"
BL.data$Age_sex[BL.data$Age_0>64 & BL.data$Sex_0 == "F"]<-"Females 65+"

BL.MalesYoung<-subset(BL.data, Age_sex=="Males 45-64")
BL.FemalesYoung<-subset(BL.data, Age_sex=="Females 45-64")
BL.MalesOld<-subset(BL.data, Age_sex=="Males 65+")
BL.FemalesOld<-subset(BL.data, Age_sex=="Females 65+")
```

Males 45-64
```{r}
Table1_Final_stratify<-CreateTableOne(vars=Baseline, strata="Pandemic", data=BL.MalesYoung)
print(Table1_Final_stratify,contDigits=2,missing=TRUE,quote=TRUE)
```

Females 45-64
```{r}
Table1_Final_stratify<-CreateTableOne(vars=Baseline, strata="Pandemic", data=BL.FemalesYoung)
print(Table1_Final_stratify,contDigits=2,missing=TRUE,quote=TRUE)
```

Males 65+
```{r}
Table1_Final_stratify<-CreateTableOne(vars=Baseline, strata="Pandemic", data=BL.MalesOld)
print(Table1_Final_stratify,contDigits=2,missing=TRUE,quote=TRUE)
```

Females 65+
```{r}
Table1_Final_stratify<-CreateTableOne(vars=Baseline, strata="Pandemic", data=BL.FemalesOld)
print(Table1_Final_stratify,contDigits=2,missing=TRUE,quote=TRUE)
```

# 4) Linear mixed model set-up

Linear mixed model set-up
```{r}
Tracking.data.short<-Tracking.Adjusted_Final[c(1,4:12,14,15,18:21,146,147,98,115,132,102,119,136,106,123,140,110,127,144,13,44,75,22,53,84,23,54,85)]

Tracking.data.short2<-rename(Tracking.data.short, c("Age"="Age_0","Sex"="Sex_0","Ethnicity"="Ethnicity_0","Relationshipstatus"="Relationship_status_0",
                             "Education"="Education4_0", "IncomeLevel"="Income_Level_0", "Livingstatus"="Living_status_0", 
                             "Alcohol"="Alcohol_0", "SmokingStatus"="Smoking_Status_0","Anxiety"="Anxiety_0","MoodDisord"="Mood_Disord_0",
                             "Chronicconditions"="Chronic_conditions_0", "BMI"="BMI_0","PASE_Sit_0"="PASE_Q1B_0","PASE_Sit_1"="PASE_Q1B_1","PASE_Sit_2"="PASE_Q1B_2"))

Tracking.data.short2$PASE_TOTALbaseline <- Tracking.data.short2$PASE_TOTAL_0

Tracking.data.short3<-Tracking.data.short2[c(1:18,40,19:39)]
Tracking.data.short4<-Tracking.data.short3[c(1:18,20,23,26,29,32,35,38,21:22,24:25,27:28,30:31,33:34,36:37,39:40)]
colnames(Tracking.data.short3) <- (gsub("_2",".3",colnames(Tracking.data.short3)))
colnames(Tracking.data.short3) <- (gsub("_1",".2",colnames(Tracking.data.short3)))
colnames(Tracking.data.short3) <- (gsub("_0",".1",colnames(Tracking.data.short3)))

colnames(Tracking.data.short4) <- (gsub("_2",".2",colnames(Tracking.data.short4)))
colnames(Tracking.data.short4) <- (gsub("_1",".1",colnames(Tracking.data.short4)))
colnames(Tracking.data.short4) <- (gsub("_0","baseline",colnames(Tracking.data.short4)))


Tracking.data_long <- reshape(as.data.frame(Tracking.data.short3),idvar="ID",varying=20:40,direction="long",sep=".") #reshape data into long format (3 timepoints)
Tracking.data_long_2 <- reshape(as.data.frame(Tracking.data.short4),idvar="ID",varying=26:39,direction="long",sep=".") #reshape data into long format (3 timepoints)
```

Indexed time as a categorical factor
```{r}
#Treat time as a fixed effect
Tracking.data_long$timefactor<-as.factor(Tracking.data_long$time)
Tracking.data_long_2$timefactor<-as.factor(Tracking.data_long_2$time)
```






# 5) Base model: Time x Pandemic effects on cognition, physical activity, and sleep duration (not adjusting for baseline)

Increase the data matrix to support the models
```{r}
emm_options(rg.limit = 150000)
emm_options(opt.digits = FALSE)
```

Contrast statements
```{r}
#Contrast 1: Group differences from baseline to FU1
c1=matrix(c(0,1,0,-1,0,0))
c2=matrix(c(1,0,-1,0,0,0))
c1st=c1 - c2

#Contrast 2: Group differences from FU1 to FU2
c1=matrix(c(0,0,0,1,0,-1))
c2=matrix(c(0,0,1,0,-1,0))
c2nd = c1 - c2

#Contrast 3: Group differences from baseline to FU2
c1=matrix(c(0,1,0,0,0,-1))
c2=matrix(c(1,0,0,0,-1,0))
c3rd = c1 - c2
```

For each of the cognitive models, we used the normalized scores as the dependent variable. Baseline is not adjusted and no covariates were included.



## 5.1) RVLT Immediate Recall

### 5.1.1) Model
```{r}
track.modelRVLT_imm_3<- lmer(RVLT_Immediate_Normed~ timefactor*Pandemic + (1|ID), data= Tracking.data_long)
summary(track.modelRVLT_imm_3)
```

### 5.1.2) Estimated marginal means
```{r}
lsmeans(track.modelRVLT_imm_3, ~Pandemic|timefactor)
contrast(lsmeans(track.modelRVLT_imm_3, ~Pandemic|timefactor), "pairwise", adj="none")
confint(contrast(lsmeans(track.modelRVLT_imm_3, ~Pandemic|timefactor), "pairwise", adj="none"), parm, level = 0.95)
```

### 5.1.3) Graph of estimated marginal means
```{r}
RVLTimmediate_lsmeans_3 <- summary(lsmeans(track.modelRVLT_imm_3, ~timefactor|Pandemic))
RVLTimmediate_lsmeans_3$Time<-NA
RVLTimmediate_lsmeans_3$Time[RVLTimmediate_lsmeans_3$timefactor==1]<-"Baseline"
RVLTimmediate_lsmeans_3$Time[RVLTimmediate_lsmeans_3$timefactor==2]<-"Follow-up 1"
RVLTimmediate_lsmeans_3$Time[RVLTimmediate_lsmeans_3$timefactor==3]<-"Follow-up 2"
ggplot(RVLTimmediate_lsmeans_3, aes(x = Time, y = lsmean, group = Pandemic)) +
  geom_line(aes(linetype = Pandemic)) +
  geom_errorbar(aes(ymin = asymp.LCL, ymax = asymp.UCL), width = 0.2) +
  geom_point(aes(y = lsmean), size = 3, shape = 21, fill = "white") +
  labs(x = "Time", y = "RVLT Immediate Normalized Score", title = "RVLT Immediate Normalized Score from Baseline to FU2 by Pandemic status") +
  theme_bw()
```

### 5.1.4) Planned contrasts
```{r}
lsmeans.RVLTImm1 <- lsmeans(track.modelRVLT_imm_3, ~ Pandemic|timefactor)
contrast(lsmeans.RVLTImm1,list(c1st,c2nd,c3rd),by=NULL)
```



## 5.2) RVLT Delayed Recall

### 5.2.1) Model
```{r}
modelRVLT_del_3<- lmer(RVLT_Delayed_Normed ~ timefactor*Pandemic + (1|ID), data= Tracking.data_long)
summary(modelRVLT_del_3)
```

### 5.2.2) Estimated marginal means
```{r}
lsmeans(modelRVLT_del_3, ~Pandemic|timefactor)
contrast(lsmeans(modelRVLT_del_3, ~Pandemic|timefactor), "pairwise", adj="none")
confint(contrast(lsmeans(modelRVLT_del_3, ~Pandemic|timefactor), "pairwise", adj="none"), parm, level = 0.95)
```

### 5.2.3) Graph of estimated marginal means
```{r}
RVLTdelayed_lsmeans_3 <- summary(lsmeans(modelRVLT_del_3, ~timefactor|Pandemic))
RVLTdelayed_lsmeans_3$Time<-NA
RVLTdelayed_lsmeans_3$Time[RVLTdelayed_lsmeans_3$timefactor==1]<-"Baseline"
RVLTdelayed_lsmeans_3$Time[RVLTdelayed_lsmeans_3$timefactor==2]<-"Follow-up 1"
RVLTdelayed_lsmeans_3$Time[RVLTdelayed_lsmeans_3$timefactor==3]<-"Follow-up 2"
ggplot(RVLTdelayed_lsmeans_3, aes(x = Time, y = lsmean, group = Pandemic)) +
  geom_line(aes(linetype = Pandemic)) +
  geom_errorbar(aes(ymin = asymp.LCL, ymax = asymp.UCL), width = 0.2) +
  geom_point(aes(y = lsmean), size = 3, shape = 21, fill = "white") +
  labs(x = "Time", y = "RVLT Delayed Normalized Score", title = "RVLT Delayed Normalized Score from Baseline to FU2 by Pandemic status") +
  theme_bw()
```

### 5.2.4) Planned contrasts
```{r}
lsmeans.RVLTDel1 <- lsmeans(modelRVLT_del_3, ~ Pandemic|timefactor)
contrast(lsmeans.RVLTDel1,list(c1st,c2nd,c3rd),by=NULL)
```



## 5.3) Mental Alteration Test

### 5.3.1) Model
```{r}
modelMAT_3<- lmer(MAT_Normed~ timefactor*Pandemic + (1|ID), data= Tracking.data_long)
summary(modelMAT_3)
```

### 5.3.2) Estimated marginal means
```{r}
lsmeans(modelMAT_3, ~Pandemic|timefactor)
contrast(lsmeans(modelMAT_3, ~Pandemic|timefactor), "pairwise", adj="none")
confint(contrast(lsmeans(modelMAT_3, ~Pandemic|timefactor), "pairwise", adj="none"), parm, level = 0.95)
```

### 5.3.3) Graph of estimated marginal means
```{r}
MAT_lsmeans_3 <- summary(lsmeans(modelMAT_3, ~timefactor|Pandemic))
MAT_lsmeans_3$Time<-NA
MAT_lsmeans_3$Time[MAT_lsmeans_3$timefactor==1]<-"Baseline"
MAT_lsmeans_3$Time[MAT_lsmeans_3$timefactor==2]<-"Follow-up 1"
MAT_lsmeans_3$Time[MAT_lsmeans_3$timefactor==3]<-"Follow-up 2"
ggplot(MAT_lsmeans_3, aes(x = Time, y = lsmean, group = Pandemic)) +
  geom_line(aes(linetype = Pandemic)) +
  geom_errorbar(aes(ymin = asymp.LCL, ymax = asymp.UCL), width = 0.2) +
  geom_point(aes(y = lsmean), size = 3, shape = 21, fill = "white") +
  labs(x = "Time", y = "MAT Normalized Score", title = "Mental Alteration Test Normalized Score from Baseline to FU2 by Pandemic status") +
  theme_bw()
```

### 5.3.4) Planned contrasts
```{r}
lsmeans.MAT1 <- lsmeans(modelMAT_3, ~Pandemic|timefactor)
contrast(lsmeans.MAT1,list(c1st,c2nd,c3rd),by=NULL)
```



## 5.4) Animal Fluency

### 5.4.1) Model
```{r}
modelAnimals_3<- lmer(Animal_Fluency_Normed ~ timefactor*Pandemic + (1|ID), data= Tracking.data_long)
summary(modelAnimals_3)
```

### 5.4.2) Estimated marginal means
```{r}
lsmeans(modelAnimals_3, ~Pandemic|timefactor)
contrast(lsmeans(modelAnimals_3, ~Pandemic|timefactor), "pairwise", adj="none")
confint(contrast(lsmeans(modelAnimals_3, ~Pandemic|timefactor), "pairwise", adj="none"), parm, level = 0.95)
```

### 5.4.3) Graph of estimated marginal means
```{r}
Animals_lsmeans_3 <- summary(lsmeans(modelAnimals_3, ~timefactor|Pandemic))
Animals_lsmeans_3$Time<-NA
Animals_lsmeans_3$Time[Animals_lsmeans_3$timefactor==1]<-"Baseline"
Animals_lsmeans_3$Time[Animals_lsmeans_3$timefactor==2]<-"Follow-up 1"
Animals_lsmeans_3$Time[Animals_lsmeans_3$timefactor==3]<-"Follow-up 2"
ggplot(Animals_lsmeans_3, aes(x = Time, y = lsmean, group = Pandemic)) +
  geom_line(aes(linetype = Pandemic)) +
  geom_errorbar(aes(ymin = asymp.LCL, ymax = asymp.UCL), width = 0.2) +
  geom_point(aes(y = lsmean), size = 3, shape = 21, fill = "white") +
  labs(x = "Time", y = "Animal Fluency Normalized Score", title = "Animal Fluency Normalized Score from Baseline to FU2 by Pandemic status") +
  theme_bw()
```

### 5.4.4) Planned contrasts
```{r}
lsmeans.Animals1 <- lsmeans(modelAnimals_3, ~Pandemic|timefactor)
contrast(lsmeans.Animals1,list(c1st,c2nd,c3rd),by=NULL)
```






# 6) Base model: Time x Pandemic effects on cognition, physical activity, and sleep duration (adjusted for baseline)

Contrast statements
```{r}
#Contrast 1: Group differences from baseline to FU1
c1=matrix(c(0,1,0,-1))
c2=matrix(c(1,0,-1,0))
c4th=c1 - c2
```

All cognitive models used normalized scores as the dependent variable. Baseline cognitive performance was included as a covariate. No other covariates were included.



## 6.1) RVLT Immediate Recall

### 6.1.1) Model
```{r}
modelRVLT_imm_adj<- lmer(RVLT_Immediate_Normed~ timefactor*Pandemic + RVLT_Immediate_Normedbaseline + (1|ID), data= Tracking.data_long_2)
summary(modelRVLT_imm_adj)
```

### 6.1.2) Estimated marginal means
```{r}
lsmeans(modelRVLT_imm_adj, ~Pandemic|timefactor)
contrast(lsmeans(modelRVLT_imm_adj, ~Pandemic|timefactor), "pairwise", adj="none")
confint(contrast(lsmeans(modelRVLT_imm_adj, ~Pandemic|timefactor), "pairwise", adj="none"), parm, level = 0.95)
```

### 6.1.3) Graph of estimated marginal means
```{r}
RVLTimmediate_lsmeans_adj <- summary(lsmeans(modelRVLT_imm_adj, ~timefactor|Pandemic))
RVLTimmediate_lsmeans_adj$Time<-NA
RVLTimmediate_lsmeans_adj$Time[RVLTimmediate_lsmeans_adj$timefactor==1]<-"Follow-up 1"
RVLTimmediate_lsmeans_adj$Time[RVLTimmediate_lsmeans_adj$timefactor==2]<-"Follow-up 2"
ggplot(RVLTimmediate_lsmeans_adj, aes(x = Time, y = lsmean, fill = Pandemic)) +
  geom_bar(stat="identity", position=position_dodge()) +
  labs(x = "Time", y = "RVLT Immediate Normalized Score", title = "RVLT Immediate Normalized Score from FU1 to FU2 by Pandemic status 
       (controlling for baseline)") +
  theme_bw()
```

### 6.1.4) Planned contrasts
```{r}
lsmeans.RVLTImm2 <- lsmeans(modelRVLT_imm_adj, ~Pandemic|timefactor)
contrast(lsmeans.RVLTImm2,list(c4th),by=NULL)
```



## 6.2) RVLT Delayed Recall

### 6.2.1) Model
```{r}
modelRVLT_del_adj<- lmer(RVLT_Delayed_Normed~ timefactor*Pandemic + RVLT_Delayed_Normedbaseline + (1|ID), data= Tracking.data_long_2)
summary(modelRVLT_del_adj)
```

### 6.2.2) Estimated marginal means
```{r}
lsmeans(modelRVLT_del_adj, ~Pandemic|timefactor)
contrast(lsmeans(modelRVLT_del_adj, ~Pandemic|timefactor), "pairwise", adj="none")
confint(contrast(lsmeans(modelRVLT_del_adj, ~Pandemic|timefactor), "pairwise", adj="none"), parm, level = 0.95)
```

### 6.2.3) Graph of estimated marginal means
```{r}
RVLTdelayed_lsmeans_adj <- summary(lsmeans(modelRVLT_del_adj, ~timefactor|Pandemic))
RVLTdelayed_lsmeans_adj$Time<-NA
RVLTdelayed_lsmeans_adj$Time[RVLTdelayed_lsmeans_adj$timefactor==1]<-"Follow-up 1"
RVLTdelayed_lsmeans_adj$Time[RVLTdelayed_lsmeans_adj$timefactor==2]<-"Follow-up 2"
ggplot(RVLTdelayed_lsmeans_adj, aes(x = Time, y = lsmean, fill = Pandemic)) +
  geom_bar(stat="identity", position=position_dodge()) +
  labs(x = "Time", y = "RVLT Delayed Normalized Score", title = "RVLT Delayed Normalized Score from FU1 to FU2 by Pandemic status 
       (controlling for baseline)") +
  theme_bw()
```

### 6.2.4) Planned contrasts
```{r}
lsmeans.RVLTDel2 <- lsmeans(modelRVLT_del_adj, ~Pandemic|timefactor)
contrast(lsmeans.RVLTDel2,list(c4th),by=NULL)
```



## 6.3) Mental Alteration Test

### 6.3.1) Model
```{r}
modelMAT_adj<- lmer(MAT_Normed~ timefactor*Pandemic + MAT_Normedbaseline + (1|ID), data= Tracking.data_long_2)
summary(modelMAT_adj)
```

### 6.3.2) Estimated marginal means
```{r}
lsmeans(modelMAT_adj, ~Pandemic|timefactor)
contrast(lsmeans(modelMAT_adj, ~Pandemic|timefactor), "pairwise", adj="none")
confint(contrast(lsmeans(modelMAT_adj, ~Pandemic|timefactor), "pairwise", adj="none"), parm, level = 0.95)
```

### 6.3.3) Graph of estimated marginal means
```{r}
MAT_lsmeans_adj <- summary(lsmeans(modelMAT_adj, ~timefactor|Pandemic))
MAT_lsmeans_adj$Time<-NA
MAT_lsmeans_adj$Time[MAT_lsmeans_adj$timefactor==1]<-"Follow-up 1"
MAT_lsmeans_adj$Time[MAT_lsmeans_adj$timefactor==2]<-"Follow-up 2"
ggplot(MAT_lsmeans_adj, aes(x = Time, y = lsmean, fill = Pandemic)) +
  geom_bar(stat="identity", position=position_dodge()) +
  labs(x = "Time", y = "MAT Normalized Score", title = "Mental Alteration Test Normalized Score from FU1 to FU2 by Pandemic status 
       (controlling for baseline)") +
  theme_bw()
```

### 6.3.4) Planned contrasts
```{r}
lsmeans.MAT2 <- lsmeans(modelMAT_adj, ~Pandemic|timefactor)
contrast(lsmeans.MAT2,list(c4th),by=NULL)
```



## 6.4) Animal Fluency

### 6.4.1) Model
```{r}
modelAnimals_adj<- lmer(Animal_Fluency_Normed~ timefactor*Pandemic + Animal_Fluency_Normedbaseline + (1|ID), data= Tracking.data_long_2)
summary(modelAnimals_adj)
```

### 6.4.2) Estimated marginal means
```{r}
lsmeans(modelAnimals_adj, ~Pandemic|timefactor)
contrast(lsmeans(modelAnimals_adj, ~Pandemic|timefactor), "pairwise", adj="none")
confint(contrast(lsmeans(modelAnimals_adj, ~Pandemic|timefactor), "pairwise", adj="none"), parm, level = 0.95)
```

### 6.4.3) Graph of estimated marginal means
```{r}
Animals_lsmeans_adj <- summary(lsmeans(modelAnimals_adj, ~timefactor|Pandemic))
Animals_lsmeans_adj$Time<-NA
Animals_lsmeans_adj$Time[Animals_lsmeans_adj$timefactor==1]<-"Follow-up 1"
Animals_lsmeans_adj$Time[Animals_lsmeans_adj$timefactor==2]<-"Follow-up 2"
ggplot(Animals_lsmeans_adj, aes(x = Time, y = lsmean, fill = Pandemic)) +
  geom_bar(stat="identity", position=position_dodge()) +
  labs(x = "Time", y = "Animal Fluency Normalized Score", title = "Animal Fluency Normalized Score from FU1 to FU2 by Pandemic status
       (controlling for baseline)") +
  theme_bw()
```

### 6.4.4) Planned contrasts
```{r}
lsmeans.Animals2 <- lsmeans(modelAnimals_adj, ~Pandemic|timefactor)
contrast(lsmeans.Animals2,list(c4th),by=NULL)
```





# 7) Simple Adjusted Model: Time x Pandemic effects on cognition and physical activity (not adjusting for baseline)

All cognitive models used normalized scores. Each model is adjusted for age, sex, education level, ethnicity, and income level.

```{r}
emm_options(rg.limit = 150000)
```


## 7.1) RVLT Immediate Recall

### 7.1.1) Model
```{r}
modelRVLT_imm_7<- lmer(RVLT_Immediate_Normed~ timefactor*Pandemic + Age + Sex + Education + Ethnicity + IncomeLevel +
                         (1|ID), data= Tracking.data_long)
summary(modelRVLT_imm_7)
```

### 7.1.2) Estimated marginal means
```{r}
lsmeans(modelRVLT_imm_7, ~Pandemic|timefactor)
contrast(lsmeans(modelRVLT_imm_7, ~Pandemic|timefactor), "pairwise", adj="none")
confint(contrast(lsmeans(modelRVLT_imm_7, ~Pandemic|timefactor), "pairwise", adj="none"), parm, level = 0.95)
```

### 7.1.3) Graph of estimated marginal means
```{r}
RVLTimmediate_lsmeans_7 <- summary(lsmeans(modelRVLT_imm_7, ~timefactor|Pandemic))
RVLTimmediate_lsmeans_7$Time<-NA
RVLTimmediate_lsmeans_7$Time[RVLTimmediate_lsmeans_7$timefactor==1]<-"Baseline"
RVLTimmediate_lsmeans_7$Time[RVLTimmediate_lsmeans_7$timefactor==2]<-"Follow-up 1"
RVLTimmediate_lsmeans_7$Time[RVLTimmediate_lsmeans_7$timefactor==3]<-"Follow-up 2"
ggplot(RVLTimmediate_lsmeans_7, aes(x = Time, y = lsmean, group=Pandemic)) +
  geom_line(aes(linetype = Pandemic)) + 
  geom_errorbar(aes(ymin = asymp.LCL, ymax = asymp.UCL), width = 0.2) +
  geom_point(aes(y = lsmean), size = 3, shape = 21, fill = "white") +
  labs(x = "Time", y = "RVLT Immediate Normalized Score", title = "RVLT Immediate Normalized Score from Baseline to FU2 by Pandemic status") +
  theme_bw()
```

### 7.1.4) Planned contrasts
```{r}
lsmeans.RVLTImm3 <- lsmeans(modelRVLT_imm_7, ~Pandemic|timefactor)
contrast(lsmeans.RVLTImm3,list(c1st,c2nd,c3rd),by=NULL)
```



## 7.2) RVLT Delayed Recall

### 7.2.1) Model
```{r}
modelRVLT_del_7<- lmer(RVLT_Delayed_Normed ~ timefactor*Pandemic + Age + Sex + Education + Ethnicity + IncomeLevel +
                        (1|ID), data= Tracking.data_long)
summary(modelRVLT_del_7)
```

### 7.2.2) Estimated marginal means
```{r}
lsmeans(modelRVLT_del_7, ~Pandemic|timefactor)
contrast(lsmeans(modelRVLT_del_7, ~Pandemic|timefactor), "pairwise", adj="none")
confint(contrast(lsmeans(modelRVLT_del_7, ~Pandemic|timefactor), "pairwise", adj="none"), parm, level = 0.95)
```

### 7.2.3) Graph of estimated marginal means
```{r}
RVLTdelayed_lsmeans_7 <- summary(lsmeans(modelRVLT_del_7, ~timefactor|Pandemic))
RVLTdelayed_lsmeans_7$Time<-NA
RVLTdelayed_lsmeans_7$Time[RVLTdelayed_lsmeans_7$timefactor==1]<-"Baseline"
RVLTdelayed_lsmeans_7$Time[RVLTdelayed_lsmeans_7$timefactor==2]<-"Follow-up 1"
RVLTdelayed_lsmeans_7$Time[RVLTdelayed_lsmeans_7$timefactor==3]<-"Follow-up 2"
ggplot(RVLTdelayed_lsmeans_7, aes(x = Time, y = lsmean, group=Pandemic)) +
  geom_line(aes(linetype = Pandemic)) + 
  geom_errorbar(aes(ymin = asymp.LCL, ymax = asymp.UCL), width = 0.2) +
  geom_point(aes(y = lsmean), size = 3, shape = 21, fill = "white") +
  labs(x = "Time", y = "RVLT Delayed Normalized Score", title = "RVLT Delayed Normalized Score from Baseline to FU2 by Pandemic status") +
  theme_bw()
```

### 7.2.4) Planned contrasts
```{r}
lsmeans.RVLTDel3 <- lsmeans(modelRVLT_del_7, ~Pandemic|timefactor)
contrast(lsmeans.RVLTDel3,list(c1st,c2nd,c3rd),by=NULL)
```



## 7.3) Mental Alteration Test

### 7.3.1) Model
```{r}
modelMAT_7<- lmer(MAT_Normed~ timefactor*Pandemic + Age + Sex + Education + Ethnicity + IncomeLevel +
                    (1|ID), data= Tracking.data_long)
summary(modelMAT_7)
```

### 7.3.2) Estimated marginal means
```{r}
lsmeans(modelMAT_7, ~Pandemic|timefactor)
contrast(lsmeans(modelMAT_7, ~Pandemic|timefactor), "pairwise", adj="none")
confint(contrast(lsmeans(modelMAT_7, ~Pandemic|timefactor), "pairwise", adj="none"), parm, level = 0.95)
```

### 7.3.3) Graph of estimated marginal means
```{r}
MAT_lsmeans_7 <- summary(lsmeans(modelMAT_7, ~timefactor|Pandemic))
MAT_lsmeans_7$Time<-NA
MAT_lsmeans_7$Time[MAT_lsmeans_7$timefactor==1]<-"Baseline"
MAT_lsmeans_7$Time[MAT_lsmeans_7$timefactor==2]<-"Follow-up 1"
MAT_lsmeans_7$Time[MAT_lsmeans_7$timefactor==3]<-"Follow-up 2"
ggplot(MAT_lsmeans_7, aes(x = Time, y = lsmean, group=Pandemic)) +
  geom_line(aes(linetype = Pandemic)) + 
  geom_errorbar(aes(ymin = asymp.LCL, ymax = asymp.UCL), width = 0.2) +
  geom_point(aes(y = lsmean), size = 3, shape = 21, fill = "white") +
  labs(x = "Time", y = "MAT Normalized Score", title = "Mental Alteration Test Normalized Score from Baseline to FU2 by Pandemic status") +
  theme_bw()
```

### 7.3.4) Planned contrasts
```{r}
lsmeans.MAT3 <- lsmeans(modelMAT_7, ~Pandemic|timefactor)
contrast(lsmeans.MAT3,list(c1st,c2nd,c3rd),by=NULL)
```



## 7.4) Animal Fluency

### 7.4.1) Model
```{r}
modelAnimals_7<- lmer(Animal_Fluency_Normed ~ timefactor*Pandemic + Age + Sex + Education + Ethnicity + IncomeLevel +
                        (1|ID), data= Tracking.data_long)
summary(modelAnimals_7)
```

### 7.4.2) Estimated marginal means
```{r}
lsmeans(modelAnimals_7, ~Pandemic|timefactor)
contrast(lsmeans(modelAnimals_7, ~Pandemic|timefactor), "pairwise", adj="none")
confint(contrast(lsmeans(modelAnimals_7, ~Pandemic|timefactor), "pairwise", adj="none"), parm, level = 0.95)
```

### 7.4.3) Graph of estimated marginal means
```{r}
Animals_lsmeans_7 <- summary(lsmeans(modelAnimals_7, ~timefactor|Pandemic))
Animals_lsmeans_7$Time<-NA
Animals_lsmeans_7$Time[Animals_lsmeans_7$timefactor==1]<-"Baseline"
Animals_lsmeans_7$Time[Animals_lsmeans_7$timefactor==2]<-"Follow-up 1"
Animals_lsmeans_7$Time[Animals_lsmeans_7$timefactor==3]<-"Follow-up 2"
ggplot(Animals_lsmeans_7, aes(x = Time, y = lsmean, group=Pandemic)) +
  geom_line(aes(linetype = Pandemic)) + 
  geom_errorbar(aes(ymin = asymp.LCL, ymax = asymp.UCL), width = 0.2) +
  geom_point(aes(y = lsmean), size = 3, shape = 21, fill = "white") +
  labs(x = "Time", y = "Animal Fluency Normalized Score", title = "Animal Fluency Normalized Score from Baseline to FU2 by Pandemic status") +
  theme_bw()
```

### 7.4.4) Planned contrasts
```{r}
lsmeans.Animals3 <- lsmeans(modelAnimals_7, ~Pandemic|timefactor)
contrast(lsmeans.Animals3,list(c1st,c2nd,c3rd),by=NULL)
```





# 8) Simple Adjusted Model: Time x Pandemic effects on cognition, physical activity, and sleep duration (adjusted for baseline)

All models adjusted for baseline, age, sex, education level, ethnicity, income level

## 8.1) RVLT Immediate Recall

### 8.1.1) Model
```{r}
modelRVLT_imm_adj3<- lmer(RVLT_Immediate_Normed~ timefactor*Pandemic + Age + Sex + Education + Ethnicity + IncomeLevel + RVLT_Immediate_Normedbaseline +
                            (1|ID), data= Tracking.data_long_2)
summary(modelRVLT_imm_adj3)
```

### 8.1.2) Estimated marginal means
```{r}
lsmeans(modelRVLT_imm_adj3, ~Pandemic|timefactor)
contrast(lsmeans(modelRVLT_imm_adj3, ~Pandemic|timefactor), "pairwise", adj="none")
confint(contrast(lsmeans(modelRVLT_imm_adj3, ~Pandemic|timefactor), "pairwise", adj="none"), parm, level = 0.95)
```

### 8.1.3) Graph of estimated marginal means
```{r}
RVLTimmediate_lsmeans_adj3 <- summary(lsmeans(modelRVLT_imm_adj3, ~timefactor|Pandemic))
RVLTimmediate_lsmeans_adj3$Time<-NA
RVLTimmediate_lsmeans_adj3$Time[RVLTimmediate_lsmeans_adj3$timefactor==1]<-"Follow-up 1"
RVLTimmediate_lsmeans_adj3$Time[RVLTimmediate_lsmeans_adj3$timefactor==2]<-"Follow-up 2"
ggplot(RVLTimmediate_lsmeans_adj3, aes(x = Time, y = lsmean, fill = Pandemic)) +
  geom_bar(stat="identity", position=position_dodge()) + 
  labs(x = "Time", y = "RVLT Immediate Normalized Score", title = "RVLT Immediate Normalized Score from FU1 to FU2 by Pandemic status 
       (controlling for baseline)") +
  theme_bw()
```

### 8.1.4) Planned contrasts
```{r}
lsmeans.RVLTImm4 <- lsmeans(modelRVLT_imm_adj3, ~Pandemic|timefactor)
contrast(lsmeans.RVLTImm4,list(c4th),by=NULL)
```



## 8.2) RVLT Delayed Recall

### 8.2.1) Model
```{r}
modelRVLT_del_adj3<- lmer(RVLT_Delayed_Normed~ timefactor*Pandemic + Age + Sex + Education + Ethnicity + IncomeLevel + RVLT_Delayed_Normedbaseline +
                            (1|ID), data= Tracking.data_long_2)
summary(modelRVLT_del_adj3)
```

### 8.2.2) Estimated marginal means
```{r}
lsmeans(modelRVLT_del_adj3, ~Pandemic|timefactor)
contrast(lsmeans(modelRVLT_del_adj3, ~Pandemic|timefactor), "pairwise", adj="none")
confint(contrast(lsmeans(modelRVLT_del_adj3, ~Pandemic|timefactor), "pairwise", adj="none"), parm, level = 0.95)
```

### 8.2.3) Graph of estimated marginal means
```{r}
RVLTdelayed_lsmeans_adj3 <- summary(lsmeans(modelRVLT_del_adj3, ~timefactor|Pandemic))
RVLTdelayed_lsmeans_adj3$Time<-NA
RVLTdelayed_lsmeans_adj3$Time[RVLTdelayed_lsmeans_adj3$timefactor==1]<-"Follow-up 1"
RVLTdelayed_lsmeans_adj3$Time[RVLTdelayed_lsmeans_adj3$timefactor==2]<-"Follow-up 2"
ggplot(RVLTdelayed_lsmeans_adj3, aes(x = Time, y = lsmean, fill = Pandemic)) +
  geom_bar(stat="identity", position=position_dodge()) + 
  labs(x = "Time", y = "RVLT Delayed Normalized Score", title = "RVLT Delayed Normalized Score from FU1 to FU2 by Pandemic status 
       (controlling for baseline)") +
  theme_bw()
```

### 8.2.4) Planned contrasts
```{r}
lsmeans.RVLTDel4 <- lsmeans(modelRVLT_del_adj3, ~Pandemic|timefactor)
contrast(lsmeans.RVLTDel4,list(c4th),by=NULL)
```



## 8.3) Mental Alteration Test

### 8.3.1) Model
```{r}
modelMAT_adj3<- lmer(MAT_Normed~ timefactor*Pandemic + Age + Sex + Education + Ethnicity + IncomeLevel + MAT_Normedbaseline +
                      (1|ID), data= Tracking.data_long_2)
summary(modelMAT_adj3)
```

### 8.3.2) Estimated marginal means
```{r}
lsmeans(modelMAT_adj3, ~Pandemic|timefactor)
contrast(lsmeans(modelMAT_adj3, ~Pandemic|timefactor), "pairwise", adj="none")
confint(contrast(lsmeans(modelMAT_adj3, ~Pandemic|timefactor), "pairwise", adj="none"), parm, level = 0.95)
```

### 8.3.3) Graph of estimated marginal means
```{r}
MAT_lsmeans_adj3 <- summary(lsmeans(modelMAT_adj3, ~Pandemic|timefactor))
MAT_lsmeans_adj3$Time<-NA
MAT_lsmeans_adj3$Time[MAT_lsmeans_adj3$timefactor==1]<-"Follow-up 1"
MAT_lsmeans_adj3$Time[MAT_lsmeans_adj3$timefactor==2]<-"Follow-up 2"
ggplot(MAT_lsmeans_adj3, aes(x = Time, y = lsmean, fill = Pandemic)) +
  geom_bar(stat="identity", position=position_dodge()) + 
  labs(x = "Time", y = "MAT Normalized Score", title = "Mental Alteration Test Normalized Score from FU1 to FU2 by Pandemic status 
       (controlling for baseline)") +
  theme_bw()
```

### 8.3.4) Planned contrasts
```{r}
lsmeans.MAT4 <- lsmeans(modelMAT_adj3, ~Pandemic|timefactor)
contrast(lsmeans.MAT4,list(c4th),by=NULL)
```



## 8.4) Animal Fluency

### 8.4.1) Model
```{r}
modelAnimals_adj3<- lmer(Animal_Fluency_Normed ~ timefactor*Pandemic + Age + Sex + Education + Ethnicity + IncomeLevel + Animal_Fluency_Normedbaseline +
                           (1|ID), data= Tracking.data_long_2)
summary(modelAnimals_adj3)
```

### 8.4.2) Estimated marginal means
```{r}
lsmeans(modelAnimals_adj3, ~Pandemic|timefactor)
contrast(lsmeans(modelAnimals_adj3, ~Pandemic|timefactor), "pairwise", adj="none")
confint(contrast(lsmeans(modelAnimals_adj3, ~Pandemic|timefactor), "pairwise", adj="none"), parm, level = 0.95)
```

### 8.4.3) Graph of estimated marginal means
```{r}
Animals_lsmeans_adj3 <- summary(lsmeans(modelAnimals_adj3, ~timefactor|Pandemic))
Animals_lsmeans_adj3$Time<-NA
Animals_lsmeans_adj3$Time[Animals_lsmeans_adj3$timefactor==1]<-"Follow-up 1"
Animals_lsmeans_adj3$Time[Animals_lsmeans_adj3$timefactor==2]<-"Follow-up 2"
ggplot(Animals_lsmeans_adj3, aes(x = Time, y = lsmean, fill = Pandemic)) +
  geom_bar(stat="identity", position=position_dodge()) + 
  labs(x = "Time", y = "Animal Fluency Normalized Score", title = "Animal Fluency Normalized Score from FU1 to FU2 by Pandemic status
       (controlling for baseline)") +
  theme_bw()
```

### 8.3.4) Planned contrasts
```{r}
lsmeans.Animals4 <- lsmeans(modelAnimals_adj3, ~Pandemic|timefactor)
contrast(lsmeans.Animals4,list(c4th),by=NULL)
```





# 9) Full Adjusted Model: Time x Pandemic effects on cognition and physical activity (not adjusting for baseline)

All models use normalized cognitive scores.Each model is adjusted for baseline age, sex, education, ethnicity, income level, baseline BMI, baseline CESD-10 score, smoking status, relationship status at baseline, living status at baseline, diagnosis of anxiety or mood disorder at baseline, number of chronic conditions at baseline, and baseline PASE score

```{r}
emm_options(rg.limit = 175000)
```


## 9.1) RVLT Immediate Recall

### 9.1.1) Model
```{r}
modelRVLT_imm_8<- lmer(RVLT_Immediate_Normed~ timefactor*Pandemic + Age + Sex + Education + Ethnicity + IncomeLevel + BMI + CESD.20.1 + SmokingStatus + 
                         Relationshipstatus + Livingstatus + Anxiety + MoodDisord + Chronicconditions + PASE_TOTALbaseline +
                         (1|ID), data= Tracking.data_long)
summary(modelRVLT_imm_8)
```

### 9.1.2) Estimated marginal means
```{r}
lsmeans(modelRVLT_imm_8, ~Pandemic|timefactor)
contrast(lsmeans(modelRVLT_imm_8, ~Pandemic|timefactor), "pairwise", adj="none")
confint(contrast(lsmeans(modelRVLT_imm_8, ~Pandemic|timefactor), "pairwise", adj="none"), parm, level = 0.95)
```

### 9.1.3) Graph of estimated marginal means
```{r}
RVLTimmediate_lsmeans_8 <- summary(lsmeans(modelRVLT_imm_8, ~timefactor|Pandemic))
RVLTimmediate_lsmeans_8$Time<-NA
RVLTimmediate_lsmeans_8$Time[RVLTimmediate_lsmeans_8$timefactor==1]<-"Baseline"
RVLTimmediate_lsmeans_8$Time[RVLTimmediate_lsmeans_8$timefactor==2]<-"Follow-up 1"
RVLTimmediate_lsmeans_8$Time[RVLTimmediate_lsmeans_8$timefactor==3]<-"Follow-up 2"
ggplot(RVLTimmediate_lsmeans_8, aes(x = Time, y = lsmean, group=Pandemic)) +
  geom_line(aes(linetype = Pandemic)) + 
  geom_errorbar(aes(ymin = asymp.LCL, ymax = asymp.UCL), width = 0.2) +
  geom_point(aes(y = lsmean), size = 3, shape = 21, fill = "white") +
  labs(x = "Time", y = "RVLT Immediate Score", title = "RVLT Immediate Score from Baseline to FU2 by Pandemic status") +
  theme_bw()
```

### 9.1.4) Planned contrasts
```{r}
lsmeans.RVLTImm8 <- lsmeans(modelRVLT_imm_8, ~Pandemic|timefactor)
contrast(lsmeans.RVLTImm8,list(c1st,c2nd,c3rd),by=NULL)
```



## 9.2) RVLT Delayed Recall

### 9.2.1) Model
```{r}
modelRVLT_del_8<- lmer(RVLT_Delayed_Normed ~ timefactor*Pandemic + Age + Sex + Education + Ethnicity + IncomeLevel + BMI + CESD.20.1 + SmokingStatus + 
                         Relationshipstatus + Livingstatus + Anxiety + MoodDisord + Chronicconditions + PASE_TOTALbaseline +
                        (1|ID), data= Tracking.data_long)
summary(modelRVLT_del_8)
```

### 9.2.2) Estimated marginal means
```{r}
lsmeans(modelRVLT_del_8, ~Pandemic|timefactor)
contrast(lsmeans(modelRVLT_del_8, ~Pandemic|timefactor), "pairwise", adj="none")
confint(contrast(lsmeans(modelRVLT_del_8, ~Pandemic|timefactor), "pairwise", adj="none"), parm, level = 0.95)
```

### 9.2.3) Graph of estimated marginal means
```{r}
RVLTdelayed_lsmeans_8 <- summary(lsmeans(modelRVLT_del_8, ~timefactor|Pandemic))
RVLTdelayed_lsmeans_8$Time<-NA
RVLTdelayed_lsmeans_8$Time[RVLTdelayed_lsmeans_8$timefactor==1]<-"Baseline"
RVLTdelayed_lsmeans_8$Time[RVLTdelayed_lsmeans_8$timefactor==2]<-"Follow-up 1"
RVLTdelayed_lsmeans_8$Time[RVLTdelayed_lsmeans_8$timefactor==3]<-"Follow-up 2"
ggplot(RVLTdelayed_lsmeans_8, aes(x = Time, y = lsmean, group=Pandemic)) +
  geom_line(aes(linetype = Pandemic)) + 
  geom_errorbar(aes(ymin = asymp.LCL, ymax = asymp.UCL), width = 0.2) +
  geom_point(aes(y = lsmean), size = 3, shape = 21, fill = "white") +
  labs(x = "Time", y = "RVLT Delayed Score", title = "RVLT Delayed Score from Baseline to FU2 by Pandemic status") +
  theme_bw()
```

### 9.2.4) Planned contrasts
```{r}
lsmeans.RVLTDel8 <- lsmeans(modelRVLT_del_8, ~Pandemic|timefactor)
contrast(lsmeans.RVLTDel8,list(c1st,c2nd,c3rd),by=NULL)
```



## 9.3) Mental Alteration Test

### 9.3.1) Model
```{r}
modelMAT_8<- lmer(MAT_Normed ~ timefactor*Pandemic + Age + Sex + Education + Ethnicity + IncomeLevel + BMI + CESD.20.1 + SmokingStatus + 
                         Relationshipstatus + Livingstatus + Anxiety + MoodDisord + Chronicconditions + PASE_TOTALbaseline +
                    (1|ID), data= Tracking.data_long)
summary(modelMAT_8)
```

### 9.3.2) Estimated marginal means
```{r}
lsmeans(modelMAT_8, ~Pandemic|timefactor)
contrast(lsmeans(modelMAT_8, ~Pandemic|timefactor), "pairwise", adj="none")
confint(contrast(lsmeans(modelMAT_8, ~Pandemic|timefactor), "pairwise", adj="none"), parm, level = 0.95)
```

### 9.3.3) Graph of estimated marginal means
```{r}
MAT_lsmeans_8 <- summary(lsmeans(modelMAT_8, ~timefactor|Pandemic))
MAT_lsmeans_8$Time<-NA
MAT_lsmeans_8$Time[MAT_lsmeans_8$timefactor==1]<-"Baseline"
MAT_lsmeans_8$Time[MAT_lsmeans_8$timefactor==2]<-"Follow-up 1"
MAT_lsmeans_8$Time[MAT_lsmeans_8$timefactor==3]<-"Follow-up 2"
ggplot(MAT_lsmeans_8, aes(x = Time, y = lsmean, group=Pandemic)) +
  geom_line(aes(linetype = Pandemic)) + 
  geom_errorbar(aes(ymin = asymp.LCL, ymax = asymp.UCL), width = 0.2) +
  geom_point(aes(y = lsmean), size = 3, shape = 21, fill = "white") +
  labs(x = "Time", y = "MAT Score", title = "Mental Alteration Test Score from Baseline to FU2 by Pandemic status") +
  theme_bw()
```

### 9.3.4) Planned contrasts
```{r}
lsmeans.MAT8 <- lsmeans(modelMAT_8, ~Pandemic|timefactor)
contrast(lsmeans.MAT8,list(c1st,c2nd,c3rd),by=NULL)
```



## 9.4) Animal Fluency

### 9.4.1) Model
```{r}
modelAnimals_8<- lmer(Animal_Fluency_Normed ~ timefactor*Pandemic + Age + Sex + Education + Ethnicity + IncomeLevel + BMI + CESD.20.1 + SmokingStatus + 
                         Relationshipstatus + Livingstatus + Anxiety + MoodDisord + Chronicconditions + PASE_TOTALbaseline +
                        (1|ID), data= Tracking.data_long)
summary(modelAnimals_8)
```

### 9.4.2) Estimated marginal means
```{r}
lsmeans(modelAnimals_8, ~Pandemic|timefactor)
contrast(lsmeans(modelAnimals_8, ~Pandemic|timefactor), "pairwise", adj="none")
confint(contrast(lsmeans(modelAnimals_8, ~Pandemic|timefactor), "pairwise", adj="none"), parm, level = 0.95)
```

### 9.4.3) Graph of estimated marginal means
```{r}
Animals_lsmeans_8 <- summary(lsmeans(modelAnimals_8, ~timefactor|Pandemic))
Animals_lsmeans_8$Time<-NA
Animals_lsmeans_8$Time[Animals_lsmeans_8$timefactor==1]<-"Baseline"
Animals_lsmeans_8$Time[Animals_lsmeans_8$timefactor==2]<-"Follow-up 1"
Animals_lsmeans_8$Time[Animals_lsmeans_8$timefactor==3]<-"Follow-up 2"
ggplot(Animals_lsmeans_8, aes(x = Time, y = lsmean, group=Pandemic)) +
  geom_line(aes(linetype = Pandemic)) + 
  geom_errorbar(aes(ymin = asymp.LCL, ymax = asymp.UCL), width = 0.2) +
  geom_point(aes(y = lsmean), size = 3, shape = 21, fill = "white") +
  labs(x = "Time", y = "Animal Fluency (words)", title = "Animal Fluency Score from Baseline to FU2 by Pandemic status") +
  theme_bw()
```

### 9.4.4) Planned contrasts
```{r}
lsmeans.Animals8 <- lsmeans(modelAnimals_8, ~Pandemic|timefactor)
contrast(lsmeans.Animals8,list(c1st,c2nd,c3rd),by=NULL)
```





# 10) Full Adjusted Model: Time x Pandemic effects on cognition and physical activity ( adjusting for baseline)

All models use normalized cognitive scores. Each model is adjusted for baseline age, sex, education, ethnicity, income level, baseline BMI, baseline CESD-10 score, smoking status, relationship status at baseline, living status at baseline, diagnosis of anxiety or mood disorder at baseline, number of chronic conditions at baseline, baseline PASE score, and baseline cognitive performance

## 10.1) RVLT Immediate Recall

### 10.1.1) Model
```{r}
modelRVLT_imm_adj10<- lmer(RVLT_Immediate_Normed~ timefactor*Pandemic + Age + Sex + Education + Ethnicity + IncomeLevel + BMI + CESD.10baseline + SmokingStatus + Relationshipstatus + 
                            Livingstatus + Anxiety + MoodDisord + Chronicconditions + PASE_TOTALbaseline + RVLT_Immediate_Normedbaseline +
                            (1|ID), data= Tracking.data_long_2)
summary(modelRVLT_imm_adj10)
```

### 10.1.2) Estimated marginal means
```{r}
lsmeans(modelRVLT_imm_adj10, ~Pandemic|timefactor)
contrast(lsmeans(modelRVLT_imm_adj10, ~Pandemic|timefactor), "pairwise", adj="none")
confint(contrast(lsmeans(modelRVLT_imm_adj10, ~Pandemic|timefactor), "pairwise", adj="none"), parm, level = 0.95)
```

### 10.1.3) Graph of estimated marginal means
```{r}
RVLTimmediate_lsmeans_adj10 <- summary(lsmeans(modelRVLT_imm_adj10, ~timefactor|Pandemic))
RVLTimmediate_lsmeans_adj10$Time<-NA
RVLTimmediate_lsmeans_adj10$Time[RVLTimmediate_lsmeans_adj10$timefactor==1]<-"Follow-up 1"
RVLTimmediate_lsmeans_adj10$Time[RVLTimmediate_lsmeans_adj10$timefactor==2]<-"Follow-up 2"
ggplot(RVLTimmediate_lsmeans_adj10, aes(x = Time, y = lsmean, fill = Pandemic)) +
  geom_bar(stat="identity", position=position_dodge()) + 
  labs(x = "Time", y = "RVLT Immediate Normalized Score", title = "RVLT Immediate Normalized Score from FU1 to FU2 by Pandemic status 
       (controlling for baseline)") +
  theme_bw()
```

### 10.1.4) Planned contrasts
```{r}
lsmeans.RVLTImm10 <- lsmeans(modelRVLT_imm_adj10, ~Pandemic|timefactor)
contrast(lsmeans.RVLTImm10,list(c4th),by=NULL)
```



## 10.2) RVLT Delayed Recall

### 10.2.1) Model
```{r}
modelRVLT_del_adj10<- lmer(RVLT_Delayed_Normed~ timefactor*Pandemic + Age + Sex + Education + Ethnicity + IncomeLevel + BMI + CESD.10baseline + SmokingStatus + Relationshipstatus + 
                            Livingstatus + Anxiety + MoodDisord + Chronicconditions + PASE_TOTALbaseline + RVLT_Delayed_Normedbaseline +
                            (1|ID), data= Tracking.data_long_2)
summary(modelRVLT_del_adj10)
```

### 10.2.2) Estimated marginal means
```{r}
lsmeans(modelRVLT_del_adj10, ~Pandemic|timefactor)
contrast(lsmeans(modelRVLT_del_adj10, ~Pandemic|timefactor), "pairwise", adj="none")
confint(contrast(lsmeans(modelRVLT_del_adj10, ~Pandemic|timefactor), "pairwise", adj="none"), parm, level = 0.95)
```

### 10.2.3) Graph of estimated marginal means
```{r}
RVLTdelayed_lsmeans_adj10 <- summary(lsmeans(modelRVLT_del_adj10, ~timefactor|Pandemic))
RVLTdelayed_lsmeans_adj10$Time<-NA
RVLTdelayed_lsmeans_adj10$Time[RVLTdelayed_lsmeans_adj10$timefactor==1]<-"Follow-up 1"
RVLTdelayed_lsmeans_adj10$Time[RVLTdelayed_lsmeans_adj10$timefactor==2]<-"Follow-up 2"
ggplot(RVLTdelayed_lsmeans_adj10, aes(x = Time, y = lsmean, fill = Pandemic)) +
  geom_bar(stat="identity", position=position_dodge()) + 
  labs(x = "Time", y = "RVLT Delayed Normalized Score", title = "RVLT Delayed Normalized Score from FU1 to FU2 by Pandemic status 
       (controlling for baseline)") +
  theme_bw()
```

### 10.2.4) Planned contrasts
```{r}
lsmeans.RVLTDel10 <- lsmeans(modelRVLT_del_adj10, ~Pandemic|timefactor)
contrast(lsmeans.RVLTDel10,list(c4th),by=NULL)
```



## 10.3) Mental Alteration Test

### 10.3.1) Model
```{r}
modelMAT_adj10<- lmer(MAT_Normed~ timefactor*Pandemic + Age + Sex + Education + Ethnicity + IncomeLevel + BMI + CESD.10baseline + SmokingStatus + Relationshipstatus + 
                            Livingstatus + Anxiety + MoodDisord + Chronicconditions + PASE_TOTALbaseline + MAT_Normedbaseline +
                      (1|ID), data= Tracking.data_long_2)
summary(modelMAT_adj10)
```

### 10.3.2) Estimated marginal means
```{r}
lsmeans(modelMAT_adj10, ~Pandemic|timefactor)
contrast(lsmeans(modelMAT_adj10, ~Pandemic|timefactor), "pairwise", adj="none")
confint(contrast(lsmeans(modelMAT_adj10, ~Pandemic|timefactor), "pairwise", adj="none"), parm, level = 0.95)
```

### 10.3.3) Graph of estimated marginal means
```{r}
MAT_lsmeans_adj10 <- summary(lsmeans(modelMAT_adj10, ~Pandemic|timefactor))
MAT_lsmeans_adj10$Time<-NA
MAT_lsmeans_adj10$Time[MAT_lsmeans_adj10$timefactor==1]<-"Follow-up 1"
MAT_lsmeans_adj10$Time[MAT_lsmeans_adj10$timefactor==2]<-"Follow-up 2"
ggplot(MAT_lsmeans_adj10, aes(x = Time, y = lsmean, fill = Pandemic)) +
  geom_bar(stat="identity", position=position_dodge()) + 
  labs(x = "Time", y = "MAT Normalized Score", title = "Mental Alteration Test Normalized Score from FU1 to FU2 by Pandemic status 
       (controlling for baseline)") +
  theme_bw()
```

### 10.3.4) Planned contrasts
```{r}
lsmeans.MAT10 <- lsmeans(modelMAT_adj10, ~Pandemic|timefactor)
contrast(lsmeans.MAT10,list(c4th),by=NULL)
```



## 10.4) Animal Fluency

### 10.4.1) Model
```{r}
modelAnimals_adj10<- lmer(Animal_Fluency_Normed ~ timefactor*Pandemic + Age + Sex + Education + Ethnicity + IncomeLevel + BMI + CESD.10baseline + SmokingStatus + Relationshipstatus + 
                            Livingstatus + Anxiety + MoodDisord + Chronicconditions + PASE_TOTALbaseline + Animal_Fluency_Normedbaseline +
                           (1|ID), data= Tracking.data_long_2)
summary(modelAnimals_adj10)
```

### 10.4.2) Estimated marginal means
```{r}
lsmeans(modelAnimals_adj10, ~Pandemic|timefactor)
contrast(lsmeans(modelAnimals_adj10, ~Pandemic|timefactor), "pairwise", adj="none")
confint(contrast(lsmeans(modelAnimals_adj10, ~Pandemic|timefactor), "pairwise", adj="none"), parm, level = 0.95)
```

### 10.4.3) Graph of estimated marginal means
```{r}
Animals_lsmeans_adj10 <- summary(lsmeans(modelAnimals_adj10, ~timefactor|Pandemic))
Animals_lsmeans_adj10$Time<-NA
Animals_lsmeans_adj10$Time[Animals_lsmeans_adj10$timefactor==1]<-"Follow-up 1"
Animals_lsmeans_adj10$Time[Animals_lsmeans_adj10$timefactor==2]<-"Follow-up 2"
ggplot(Animals_lsmeans_adj10, aes(x = Time, y = lsmean, fill = Pandemic)) +
  geom_bar(stat="identity", position=position_dodge()) + 
  labs(x = "Time", y = "Animal Fluency Normalized Score", title = "Animal Fluency Normalized Score from FU1 to FU2 by Pandemic status
       (controlling for baseline)") +
  theme_bw()
```

### 10.3.4) Planned contrasts
```{r}
lsmeans.Animals10 <- lsmeans(modelAnimals_adj10, ~Pandemic|timefactor)
contrast(lsmeans.Animals10,list(c4th),by=NULL)
```




# 11) Age and sex differences in time x pandemic effects (not adjusted for baseline; full model only)

All models use normalized cognitive scores.Each model is adjusted for baseline age, sex, education, ethnicity, income level, baseline BMI, baseline CESD-10 score, smoking status, relationship status at baseline, living status at baseline, diagnosis of anxiety or mood disorder at baseline, number of chronic conditions at baseline, and baseline PASE score

```{r}
emm_options(rg.limit = 350000)
```

Age and Sex grouping
```{r}
Tracking.data_long$Age_sex<-NA
Tracking.data_long$Age_sex[Tracking.data_long$Age<=64 & Tracking.data_long$Sex == "M"]<-"Males 45-64"
Tracking.data_long$Age_sex[Tracking.data_long$Age<=64 & Tracking.data_long$Sex == "F"]<-"Females 45-64"
Tracking.data_long$Age_sex[Tracking.data_long$Age>64 & Tracking.data_long$Sex == "M"]<-"Males 65+"
Tracking.data_long$Age_sex[Tracking.data_long$Age>64 & Tracking.data_long$Sex == "F"]<-"Females 65+"
```

## 11.1) RVLT Immediate Recall

### 11.1.1) Model
```{r}
modelRVLT_imm_11<- lmer(RVLT_Immediate_Normed~ timefactor*Pandemic*Age_sex + Education + Ethnicity + IncomeLevel + BMI + CESD.20.1 + SmokingStatus + 
                         Relationshipstatus + Livingstatus + Anxiety + MoodDisord + Chronicconditions + PASE_TOTALbaseline +
                         (1|ID), data= Tracking.data_long)
summary(modelRVLT_imm_11)
```

### 11.1.2) Estimated marginal means
Significant differences for males 45-64 and 65+, whereby post-pandemic males performed worse
```{r}
lsmeans(modelRVLT_imm_11, ~Pandemic|timefactor|Age_sex)
contrast(lsmeans(modelRVLT_imm_11, ~Pandemic|timefactor|Age_sex), "pairwise", adj="none")
confint(contrast(lsmeans(modelRVLT_imm_11, ~Pandemic|timefactor|Age_sex), "pairwise", adj="none"), parm, level = 0.95)
```

### 11.1.3) Graph of estimated marginal means
```{r}
RVLTimmediate_lsmeans_11 <- summary(lsmeans(modelRVLT_imm_11, ~timefactor|Pandemic|Age_sex))
RVLTimmediate_lsmeans_11$Time<-NA
RVLTimmediate_lsmeans_11$Time[RVLTimmediate_lsmeans_11$timefactor==1]<-"Baseline"
RVLTimmediate_lsmeans_11$Time[RVLTimmediate_lsmeans_11$timefactor==2]<-"Follow-up 1"
RVLTimmediate_lsmeans_11$Time[RVLTimmediate_lsmeans_11$timefactor==3]<-"Follow-up 2"
ggplot(RVLTimmediate_lsmeans_11, aes(x = Time, y = lsmean, group=Pandemic)) +
  geom_line(aes(linetype = Pandemic)) + facet_wrap(~Age_sex, scales = "free") +
  geom_errorbar(aes(ymin = asymp.LCL, ymax = asymp.UCL), width = 0.2) +
  geom_point(aes(y = lsmean), size = 3, shape = 21, fill = "white") +
  labs(x = "Time", y = "RVLT Immediate Score", title = "RVLT Immediate Score from Baseline to FU2 by Pandemic status") +
  theme_bw()
```


## 11.2) RVLT Delayed Recall

### 11.2.1) Model
```{r}
modelRVLT_del_11<- lmer(RVLT_Delayed_Normed ~ timefactor*Pandemic*Age_sex + Education + Ethnicity + IncomeLevel + BMI + CESD.20.1 + SmokingStatus + 
                         Relationshipstatus + Livingstatus + Anxiety + MoodDisord + Chronicconditions + PASE_TOTALbaseline +
                        (1|ID), data= Tracking.data_long)
summary(modelRVLT_del_11)
```

### 11.2.2) Estimated marginal means
```{r}
lsmeans(modelRVLT_del_11, ~Pandemic|timefactor|Age_sex)
contrast(lsmeans(modelRVLT_del_11, ~Pandemic|timefactor|Age_sex), "pairwise", adj="none")
confint(contrast(lsmeans(modelRVLT_del_11, ~Pandemic|timefactor|Age_sex), "pairwise", adj="none"), parm, level = 0.95)
```

### 11.2.3) Graph of estimated marginal means
```{r}
RVLTdelayed_lsmeans_11 <- summary(lsmeans(modelRVLT_del_11, ~timefactor|Pandemic|Age_sex))
RVLTdelayed_lsmeans_11$Time<-NA
RVLTdelayed_lsmeans_11$Time[RVLTdelayed_lsmeans_11$timefactor==1]<-"Baseline"
RVLTdelayed_lsmeans_11$Time[RVLTdelayed_lsmeans_11$timefactor==2]<-"Follow-up 1"
RVLTdelayed_lsmeans_11$Time[RVLTdelayed_lsmeans_11$timefactor==3]<-"Follow-up 2"
ggplot(RVLTdelayed_lsmeans_11, aes(x = Time, y = lsmean, group=Pandemic)) +
  geom_line(aes(linetype = Pandemic)) + facet_wrap(~Age_sex, scales = "free") +
  geom_errorbar(aes(ymin = asymp.LCL, ymax = asymp.UCL), width = 0.2) +
  geom_point(aes(y = lsmean), size = 3, shape = 21, fill = "white") +
  labs(x = "Time", y = "RVLT Delayed Score", title = "RVLT Delayed Score from Baseline to FU2 by Pandemic status") +
  theme_bw()
```



## 11.3) Mental Alteration Test

### 11.3.1) Model
```{r}
modelMAT_11<- lmer(MAT_Normed ~ timefactor*Pandemic*Age_sex + Education + Ethnicity + IncomeLevel + BMI + CESD.20.1 + SmokingStatus + 
                         Relationshipstatus + Livingstatus + Anxiety + MoodDisord + Chronicconditions + PASE_TOTALbaseline +
                    (1|ID), data= Tracking.data_long)
summary(modelMAT_11)
```

### 11.3.2) Estimated marginal means
Significant differences for males 65+
```{r}
lsmeans(modelMAT_11, ~Pandemic|timefactor|Age_sex)
contrast(lsmeans(modelMAT_11, ~Pandemic|timefactor|Age_sex), "pairwise", adj="none")
confint(contrast(lsmeans(modelMAT_11, ~Pandemic|timefactor|Age_sex), "pairwise", adj="none"), parm, level = 0.95)
```

### 11.3.3) Graph of estimated marginal means
```{r}
MAT_lsmeans_11 <- summary(lsmeans(modelMAT_11, ~timefactor|Pandemic|Age_sex))
MAT_lsmeans_11$Time<-NA
MAT_lsmeans_11$Time[MAT_lsmeans_11$timefactor==1]<-"Baseline"
MAT_lsmeans_11$Time[MAT_lsmeans_11$timefactor==2]<-"Follow-up 1"
MAT_lsmeans_11$Time[MAT_lsmeans_11$timefactor==3]<-"Follow-up 2"
ggplot(MAT_lsmeans_11, aes(x = Time, y = lsmean, group=Pandemic)) +
  geom_line(aes(linetype = Pandemic)) + facet_wrap(~Age_sex, scales = "free") +
  geom_errorbar(aes(ymin = asymp.LCL, ymax = asymp.UCL), width = 0.2) +
  geom_point(aes(y = lsmean), size = 3, shape = 21, fill = "white") +
  labs(x = "Time", y = "MAT Score", title = "Mental Alteration Test Score from Baseline to FU2 by Pandemic status") +
  theme_bw()
```

## 11.4) Animal Fluency

### 11.4.1) Model
```{r}
modelAnimals_11<- lmer(Animal_Fluency_Normed ~ timefactor*Pandemic*Age_sex + Education + Ethnicity + IncomeLevel + BMI + CESD.20.1 + SmokingStatus + 
                         Relationshipstatus + Livingstatus + Anxiety + MoodDisord + Chronicconditions + PASE_TOTALbaseline +
                        (1|ID), data= Tracking.data_long)
summary(modelAnimals_11)
```

### 11.4.2) Estimated marginal means
Significant differences for females 45-64 and 65+ and significant differences males 65+
```{r}
lsmeans(modelAnimals_11, ~Pandemic|timefactor|Age_sex)
contrast(lsmeans(modelAnimals_11, ~Pandemic|timefactor|Age_sex), "pairwise", adj="none")
confint(contrast(lsmeans(modelAnimals_11, ~Pandemic|timefactor|Age_sex), "pairwise", adj="none"), parm, level = 0.95)
```

### 11.4.3) Graph of estimated marginal means
```{r}
Animals_lsmeans_11 <- summary(lsmeans(modelAnimals_11, ~timefactor|Pandemic|Age_sex))
Animals_lsmeans_11$Time<-NA
Animals_lsmeans_11$Time[Animals_lsmeans_11$timefactor==1]<-"Baseline"
Animals_lsmeans_11$Time[Animals_lsmeans_11$timefactor==2]<-"Follow-up 1"
Animals_lsmeans_11$Time[Animals_lsmeans_11$timefactor==3]<-"Follow-up 2"
ggplot(Animals_lsmeans_11, aes(x = Time, y = lsmean, group=Pandemic)) +
  geom_line(aes(linetype = Pandemic)) + facet_wrap(~Age_sex, scales = "free") +
  geom_errorbar(aes(ymin = asymp.LCL, ymax = asymp.UCL), width = 0.2) +
  geom_point(aes(y = lsmean), size = 3, shape = 21, fill = "white") +
  labs(x = "Time", y = "Animal Fluency (words)", title = "Animal Fluency Score from Baseline to FU2 by Pandemic status") +
  theme_bw()
```




# 12) Age and sex differences in time x pandemic effects on cognitive functon ( adjusting for baseline)

All models use normalized cognitive scores. Each model is adjusted for education, ethnicity, income level, baseline BMI, baseline CESD-10 score, smoking status, relationship status at baseline, living status at baseline, diagnosis of anxiety or mood disorder at baseline, number of chronic conditions at baseline, baseline PASE score, and baseline cognitive performance

Age and Sex grouping
```{r}
Tracking.data_long_2$Age_sex<-NA
Tracking.data_long_2$Age_sex[Tracking.data_long_2$Age<=64 & Tracking.data_long_2$Sex == "M"]<-"Males 45-64"
Tracking.data_long_2$Age_sex[Tracking.data_long_2$Age<=64 & Tracking.data_long_2$Sex == "F"]<-"Females 45-64"
Tracking.data_long_2$Age_sex[Tracking.data_long_2$Age>64 & Tracking.data_long_2$Sex == "M"]<-"Males 65+"
Tracking.data_long_2$Age_sex[Tracking.data_long_2$Age>64 & Tracking.data_long_2$Sex == "F"]<-"Females 65+"
```

## 12.1) RVLT Immediate Recall

### 12.1.1) Model
```{r}
modelRVLT_imm_adj11<- lmer(RVLT_Immediate_Normed~ timefactor*Pandemic*Age_sex + Education + Ethnicity + IncomeLevel + BMI + CESD.10baseline + SmokingStatus + Relationshipstatus + 
                            Livingstatus + Anxiety + MoodDisord + Chronicconditions + PASE_TOTALbaseline + RVLT_Immediate_Normedbaseline +
                            (1|ID), data= Tracking.data_long_2)
summary(modelRVLT_imm_adj11)
```

### 12.1.2) Estimated marginal means

Significantly lower RVLT immediate for males 65+
```{r}
lsmeans(modelRVLT_imm_adj11, ~Pandemic|timefactor|Age_sex)
contrast(lsmeans(modelRVLT_imm_adj11, ~Pandemic|timefactor|Age_sex), "pairwise", adj="none")
confint(contrast(lsmeans(modelRVLT_imm_adj11, ~Pandemic|timefactor|Age_sex), "pairwise", adj="none"), parm, level = 0.95)
```

### 12.1.3) Graph of estimated marginal means
```{r}
RVLTimmediate_lsmeans_adj11 <- summary(lsmeans(modelRVLT_imm_adj11, ~timefactor|Pandemic|Age_sex))
RVLTimmediate_lsmeans_adj11$Time<-NA
RVLTimmediate_lsmeans_adj11$Time[RVLTimmediate_lsmeans_adj11$timefactor==1]<-"Follow-up 1"
RVLTimmediate_lsmeans_adj11$Time[RVLTimmediate_lsmeans_adj11$timefactor==2]<-"Follow-up 2"
ggplot(RVLTimmediate_lsmeans_adj11, aes(x = Time, y = lsmean, fill = Pandemic)) +
  geom_bar(stat="identity", position=position_dodge()) + facet_wrap(~Age_sex, scales = "free") +
  labs(x = "Time", y = "RVLT Immediate Normalized Score", title = "RVLT Immediate Normalized Score from FU1 to FU2 by Pandemic status
       (controlling for baseline)") +
  theme_bw()
```


## 12.2) RVLT Delayed Recall

### 12.2.1) Model
```{r}
modelRVLT_del_adj11<- lmer(RVLT_Delayed_Normed~ timefactor*Pandemic*Age_sex + Education + Ethnicity + IncomeLevel + BMI + CESD.10baseline + SmokingStatus + Relationshipstatus + 
                            Livingstatus + Anxiety + MoodDisord + Chronicconditions + PASE_TOTALbaseline + RVLT_Delayed_Normedbaseline +
                            (1|ID), data= Tracking.data_long_2)
summary(modelRVLT_del_adj11)
```

### 12.2.2) Estimated marginal means

No significant differences
```{r}
lsmeans(modelRVLT_del_adj11, ~Pandemic|timefactor|Age_sex)
contrast(lsmeans(modelRVLT_del_adj11, ~Pandemic|timefactor|Age_sex), "pairwise", adj="none")
confint(contrast(lsmeans(modelRVLT_del_adj11, ~Pandemic|timefactor|Age_sex), "pairwise", adj="none"), parm, level = 0.95)
```

### 12.2.3) Graph of estimated marginal means
```{r}
RVLTdelayed_lsmeans_adj11 <- summary(lsmeans(modelRVLT_del_adj11, ~timefactor|Pandemic|Age_sex))
RVLTdelayed_lsmeans_adj11$Time<-NA
RVLTdelayed_lsmeans_adj11$Time[RVLTdelayed_lsmeans_adj11$timefactor==1]<-"Follow-up 1"
RVLTdelayed_lsmeans_adj11$Time[RVLTdelayed_lsmeans_adj11$timefactor==2]<-"Follow-up 2"
ggplot(RVLTdelayed_lsmeans_adj11, aes(x = Time, y = lsmean, fill = Pandemic)) +
  geom_bar(stat="identity", position=position_dodge()) + facet_wrap(~Age_sex, scales = "free") +
  labs(x = "Time", y = "RVLT Delayed Normalized Score", title = "RVLT Delayed Normalized Score from FU1 to FU2 by Pandemic status
       (controlling for baseline)") +
  theme_bw()
```



## 12.3) Mental Alteration Test

### 12.3.1) Model
```{r}
modelMAT_adj11<- lmer(MAT_Normed~ timefactor*Pandemic*Age_sex + Education + Ethnicity + IncomeLevel + BMI + CESD.10baseline + SmokingStatus + Relationshipstatus + 
                            Livingstatus + Anxiety + MoodDisord + Chronicconditions + PASE_TOTALbaseline + MAT_Normedbaseline +
                      (1|ID), data= Tracking.data_long_2)
summary(modelMAT_adj11)
```

### 12.3.2) Estimated marginal means

Significantly lower MAT score for males and females 65+
```{r}
lsmeans(modelMAT_adj11, ~Pandemic|timefactor|Age_sex)
contrast(lsmeans(modelMAT_adj11, ~Pandemic|timefactor|Age_sex), "pairwise", adj="none")
confint(contrast(lsmeans(modelMAT_adj11, ~Pandemic|timefactor|Age_sex), "pairwise", adj="none"), parm, level = 0.95)
```

### 12.3.3) Graph of estimated marginal means
```{r}
MAT_lsmeans_adj11 <- summary(lsmeans(modelMAT_adj11, ~Pandemic|timefactor|Age_sex))
MAT_lsmeans_adj11$Time<-NA
MAT_lsmeans_adj11$Time[MAT_lsmeans_adj11$timefactor==1]<-"Follow-up 1"
MAT_lsmeans_adj11$Time[MAT_lsmeans_adj11$timefactor==2]<-"Follow-up 2"
ggplot(MAT_lsmeans_adj11, aes(x = Time, y = lsmean, fill = Pandemic)) +
  geom_bar(stat="identity", position=position_dodge()) + facet_wrap(~Age_sex, scales = "free") +
  labs(x = "Time", y = "MAT Normalized Score", title = "Mental Alteration Test Normalized Score from FU1 to FU2 by Pandemic status
       (controlling for baseline)") +
  theme_bw()
```



## 12.4) Animal Fluency

### 12.4.1) Model
```{r}
modelAnimals_adj11<- lmer(Animal_Fluency_Normed ~ timefactor*Pandemic*Age_sex + Education + Ethnicity + IncomeLevel + BMI + CESD.10baseline + SmokingStatus + Relationshipstatus + 
                            Livingstatus + Anxiety + MoodDisord + Chronicconditions + PASE_TOTALbaseline + Animal_Fluency_Normedbaseline +
                           (1|ID), data= Tracking.data_long_2)
summary(modelAnimals_adj11)
```

### 12.4.2) Estimated marginal means

Significantly lower animal fluency for males and females 65+
```{r}
lsmeans(modelAnimals_adj11, ~Pandemic|timefactor|Age_sex)
contrast(lsmeans(modelAnimals_adj11, ~Pandemic|timefactor|Age_sex), "pairwise", adj="none")
confint(contrast(lsmeans(modelAnimals_adj11, ~Pandemic|timefactor|Age_sex), "pairwise", adj="none"), parm, level = 0.95)
```

### 12.4.3) Graph of estimated marginal means
```{r}
Animals_lsmeans_adj11 <- summary(lsmeans(modelAnimals_adj11, ~timefactor|Pandemic|Age_sex))
Animals_lsmeans_adj11$Time<-NA
Animals_lsmeans_adj11$Time[Animals_lsmeans_adj11$timefactor==1]<-"Follow-up 1"
Animals_lsmeans_adj11$Time[Animals_lsmeans_adj11$timefactor==2]<-"Follow-up 2"
ggplot(Animals_lsmeans_adj11, aes(x = Time, y = lsmean, fill = Pandemic)) +
  geom_bar(stat="identity", position=position_dodge()) + facet_wrap(~Age_sex, scales = "free") +
  labs(x = "Time", y = "Animal Fluency Normalized Score", title = "Animal Fluency Normalized Score from FU1 to FU2 by Pandemic status
       (controlling for baseline)") +
  theme_bw()
```




# 13) Physical Activity Results

## 13.1) Full model unadjusted for baseline

### 13.1.1) Model
```{r}
modelPASE_1<- lmer(PASE_TOTAL~ timefactor*Pandemic + Age + Sex + Education + Ethnicity + IncomeLevel + BMI + CESD.20.1 + SmokingStatus + 
                         Relationshipstatus + Livingstatus + Anxiety + MoodDisord + Chronicconditions +
                         (1|ID), data= Tracking.data_long)
summary(modelPASE_1)
```

### 13.1.2) Estimated marginal means
Significant differences for males 45-64 and 65+, whereby post-pandemic males performed worse
```{r}
lsmeans(modelPASE_1, ~Pandemic|timefactor)
contrast(lsmeans(modelPASE_1, ~Pandemic|timefactor), "pairwise", adj="none")
confint(contrast(lsmeans(modelPASE_1, ~Pandemic|timefactor), "pairwise", adj="none"), parm, level = 0.95)
```

### 13.1.3) Graph of estimated marginal means
```{r}
PASE_lsmeans_1 <- summary(lsmeans(modelPASE_1, ~timefactor|Pandemic))
PASE_lsmeans_1$Time<-NA
PASE_lsmeans_1$Time[PASE_lsmeans_1$timefactor==1]<-"Baseline"
PASE_lsmeans_1$Time[PASE_lsmeans_1$timefactor==2]<-"Follow-up 1"
PASE_lsmeans_1$Time[PASE_lsmeans_1$timefactor==3]<-"Follow-up 2"
ggplot(PASE_lsmeans_1, aes(x = Time, y = lsmean, group=Pandemic)) +
  geom_line(aes(linetype = Pandemic)) + 
  geom_errorbar(aes(ymin = asymp.LCL, ymax = asymp.UCL), width = 0.2) +
  geom_point(aes(y = lsmean), size = 3, shape = 21, fill = "white") +
  labs(x = "Time", y = "PASE Total Score", title = "PASE Total Score from Baseline to FU2 by Pandemic status") +
  theme_bw()
```

### 13.1.4) Planned contrasts
```{r}
lsmeans.PASEtrun <- lsmeans(modelPASE_1, ~Pandemic|timefactor)
contrast(lsmeans.PASEtrun,list(c1st,c2nd,c3rd),by=NULL)
```

## 13.2) Full model adjusted for baseline

### 13.2.1) Model
```{r}
modelPASE_2<- lmer(PASE_TOTAL ~ timefactor*Pandemic + Age + Sex + Education + Ethnicity + IncomeLevel + BMI + CESD.10baseline + SmokingStatus + 
                         Relationshipstatus + Livingstatus + Anxiety + MoodDisord + Chronicconditions + PASE_TOTALbaseline +
                        (1|ID), data= Tracking.data_long_2)
summary(modelPASE_2)
```

### 13.2.2) Estimated marginal means
```{r}
lsmeans(modelPASE_2, ~Pandemic|timefactor)
contrast(lsmeans(modelPASE_2, ~Pandemic|timefactor), "pairwise", adj="none")
confint(contrast(lsmeans(modelPASE_2, ~Pandemic|timefactor), "pairwise", adj="none"), parm, level = 0.95)
```

### 13.2.3) Graph of estimated marginal means
```{r}
PASE_lsmeans_2 <- summary(lsmeans(modelPASE_2, ~timefactor|Pandemic))
PASE_lsmeans_2$Time<-NA
PASE_lsmeans_2$Time[PASE_lsmeans_2$timefactor==1]<-"Follow-up 1"
PASE_lsmeans_2$Time[PASE_lsmeans_2$timefactor==2]<-"Follow-up 2"
ggplot(PASE_lsmeans_2, aes(x = Time, y = lsmean, fill = Pandemic)) +
  geom_bar(stat="identity", position=position_dodge()) + 
  labs(x = "Time", y = "PASE Total Score", title = "PASE Total Score from FU1 to FU2 by Pandemic status
       (controlling for baseline)") +
  theme_bw()
```

### 13.2.4) Planned contrasts
```{r}
lsmeans.PASE2trun <- lsmeans(modelPASE_2, ~Pandemic|timefactor)
contrast(lsmeans.PASE2trun,list(c4th),by=NULL)
```


## 13.3) Full model unadjusted for baseline (age and sex differences)

### 13.3.1) Model
```{r}
modelPASE_3<- lmer(PASE_TOTAL ~ timefactor*Pandemic*Age_sex + Education + Ethnicity + IncomeLevel + BMI + CESD.20.1 + SmokingStatus + 
                         Relationshipstatus + Livingstatus + Anxiety + MoodDisord + Chronicconditions +
                    (1|ID), data= Tracking.data_long)
summary(modelPASE_3)
```

### 13.3.2) Estimated marginal means
Significant differences for males 65+
```{r}
lsmeans(modelPASE_3, ~Pandemic|timefactor|Age_sex)
contrast(lsmeans(modelPASE_3, ~Pandemic|timefactor|Age_sex), "pairwise", adj="none")
confint(contrast(lsmeans(modelPASE_3, ~Pandemic|timefactor|Age_sex), "pairwise", adj="none"), parm, level = 0.95)
```

### 13.3.3) Graph of estimated marginal means
```{r}
PASE_lsmeans_3 <- summary(lsmeans(modelPASE_3, ~timefactor|Pandemic|Age_sex))
PASE_lsmeans_3$Time<-NA
PASE_lsmeans_3$Time[PASE_lsmeans_3$timefactor==1]<-"Baseline"
PASE_lsmeans_3$Time[PASE_lsmeans_3$timefactor==2]<-"Follow-up 1"
PASE_lsmeans_3$Time[PASE_lsmeans_3$timefactor==3]<-"Follow-up 2"
ggplot(PASE_lsmeans_3, aes(x = Time, y = lsmean, group=Pandemic)) +
  geom_line(aes(linetype = Pandemic)) + facet_wrap(~Age_sex, scales = "free") +
  geom_errorbar(aes(ymin = asymp.LCL, ymax = asymp.UCL), width = 0.2) +
  geom_point(aes(y = lsmean), size = 3, shape = 21, fill = "white") +
  labs(x = "Time", y = "MAT Score", title = "PASE Total Score from Baseline to FU2 by Pandemic status") +
  theme_bw()
```

## 13.4) Full model adjusted for baseline (age and sex differences)

### 13.4.1) Model
```{r}
modelPASE_4<- lmer(PASE_TOTAL ~ timefactor*Pandemic*Age_sex + Education + Ethnicity + IncomeLevel + BMI + CESD.10baseline + SmokingStatus + 
                         Relationshipstatus + Livingstatus + Anxiety + MoodDisord + Chronicconditions + PASE_TOTALbaseline +
                        (1|ID), data= Tracking.data_long_2)
summary(modelPASE_4)
```

### 13.4.2) Estimated marginal means
Significant differences for females 45-64 and 65+ and significant differences males 65+
```{r}
lsmeans(modelPASE_4, ~Pandemic|timefactor|Age_sex)
contrast(lsmeans(modelPASE_4, ~Pandemic|timefactor|Age_sex), "pairwise", adj="none")
confint(contrast(lsmeans(modelPASE_4, ~Pandemic|timefactor|Age_sex), "pairwise", adj="none"), parm, level = 0.95)
```

### 13.4.3) Graph of estimated marginal means
```{r}
PASE_lsmeans_4 <- summary(lsmeans(modelPASE_4, ~timefactor|Pandemic|Age_sex))
PASE_lsmeans_4$Time<-NA
PASE_lsmeans_4$Time[PASE_lsmeans_4$timefactor==1]<-"Follow-up 1"
PASE_lsmeans_4$Time[PASE_lsmeans_4$timefactor==2]<-"Follow-up 2"
ggplot(PASE_lsmeans_4, aes(x = Time, y = lsmean, fill = Pandemic)) +
  geom_bar(stat="identity", position=position_dodge()) + facet_wrap(~Age_sex, scales = "free") +
  labs(x = "Time", y = "PASE Total Score", title = "PASE Total Score from FU1 to FU2 by Pandemic status
       (controlling for baseline)") +
  theme_bw()
```




# 14) Sedentary behaviour Results

## 14.1) Full model adjusted for baseline

Create binary variable for 4+ hrs/day of SB
```{r}
Tracking.data_long_2$SB.binary <- as.factor(ifelse(Tracking.data_long_2$PASE_Sit==10, 1, 0))
Tracking.data_long_2$SBbaseline.binary <- as.factor(ifelse(Tracking.data_long_2$PASE_Sitbaseline==10, 1, 0))
```

### 14.1.1) Model
```{r}
sit1 <- glmer(
  SB.binary ~ timefactor*Pandemic + Age + Sex + SBbaseline.binary + Education + Ethnicity + IncomeLevel + BMI + CESD.10baseline + SmokingStatus + 
    Relationshipstatus + Livingstatus + Anxiety + MoodDisord + Chronicconditions + 
    (1|ID), 
  data = Tracking.data_long_2, 
  family = binomial(link = "logit")
)

sit1
```

### 14.1.2) Predicted probabilities

```{r}
ggpredict(sit1, c("timefactor", "Pandemic"))
```

### 14.1.3) Contrasts for predicted probilities

Mean Differences and 95% CIs
```{r}
sit.test <- as.data.frame(ggpredict(sit1, c("timefactor", "Pandemic")))

mean.diff.1<-(subset(sit.test,x==1 & group == "FU2 data collected after COVID-19")$predicted - 
         subset(sit.test,x==1 & group == "FU2 data collected before COVID-19")$predicted)
         
se.1<-(sqrt(((subset(sit.test,x==1 & group == "FU2 data collected after COVID-19")$std.error)^2 +
         (subset(sit.test,x==1 & group == "FU2 data collected before COVID-19")$std.error^2))/2))

UL.1<-mean.diff.1 + se.1*1.96
LL.1<-mean.diff.1 - se.1*1.96

         
mean.diff.2<-(subset(sit.test,x==2 & group == "FU2 data collected after COVID-19")$predicted - 
         subset(sit.test,x==2 & group == "FU2 data collected before COVID-19")$predicted)
         
se.2<-(sqrt(((subset(sit.test,x==2 & group == "FU2 data collected after COVID-19")$std.error)^2 +
         (subset(sit.test,x==2 & group == "FU2 data collected before COVID-19")$std.error^2))/2))

UL.2<-mean.diff.2 + se.2*1.96
LL.2<-mean.diff.2 - se.2*1.96

#Mean differences and LL and UL
mean.diff.1
UL.1
LL.1

mean.diff.2
UL.2
LL.2
```

z-scores
```{r}
z.1<- (subset(sit.test,x==1 & group == "FU2 data collected after COVID-19")$predicted - 
         subset(sit.test,x==1 & group == "FU2 data collected before COVID-19")$predicted) / (sqrt(((subset(sit.test,x==1 & group == "FU2 data collected after COVID-19")$std.error)^2 +
     (subset(sit.test,x==1 & group == "FU2 data collected before COVID-19")$std.error^2))/2))
     
z.2<- (subset(sit.test,x==2 & group == "FU2 data collected after COVID-19")$predicted - 
         subset(sit.test,x==2 & group == "FU2 data collected before COVID-19")$predicted) / (sqrt(((subset(sit.test,x==2 & group == "FU2 data collected after COVID-19")$std.error)^2 +
         (subset(sit.test,x==2 & group == "FU2 data collected before COVID-19")$std.error^2))/2))

z.1
z.2
```

p-values for z-scores
```{r}
2*pnorm(z.1, mean = 0, sd = 1, lower.tail = FALSE)
2*pnorm(z.2, mean = 0, sd = 1, lower.tail = FALSE)
```

### 14.1.4) Graph of predicted probabilities
```{r}
ggpredict(sit1, c("timefactor", "Pandemic")) %>% plot()
```


## 14.2) Full model adjusted for baseline (age and sex differences)

### 14.2.1) Model
```{r}
sit2 <- glmer(
  SB.binary ~ timefactor*Pandemic*Age_sex + SBbaseline.binary + Education + Ethnicity + IncomeLevel + BMI + CESD.10baseline + SmokingStatus + 
    Relationshipstatus + Livingstatus + Anxiety + MoodDisord + Chronicconditions + 
    (1|ID), 
  data = Tracking.data_long_2, 
  family = binomial(link = "logit")
)

sit2
```

### 14.2.2) Predicted probabilities

```{r}
ggpredict(sit2, c("Pandemic","timefactor","Age_sex"))
```

### 14.2.3) Contrasts for predicted probilities

Mean differences and 95% CIs
```{r}
sit.test2 <- as.data.frame(ggpredict(sit2, c("timefactor", "Pandemic", "Age_sex")))

#Females 45-64 years
mean.diff.Females.Young.1<-(subset(sit.test2,x==1 & group == "FU2 data collected after COVID-19" & facet == "Females 45-64")$predicted - 
         subset(sit.test2,x==1 & group == "FU2 data collected before COVID-19" & facet == "Females 45-64")$predicted)
         
se.Females.Young.1<-(sqrt(((subset(sit.test2,x==1 & group == "FU2 data collected after COVID-19" & facet == "Females 45-64")$std.error)^2 +
     (subset(sit.test2,x==1 & group == "FU2 data collected before COVID-19" & facet == "Females 45-64")$std.error^2))/2))

UL.Females.Young.1<-mean.diff.Females.Young.1 + se.Females.Young.1*1.96
LL.Females.Young.1<-mean.diff.Females.Young.1 - se.Females.Young.1*1.96

mean.diff.Females.Young.2<-(subset(sit.test2,x==2 & group == "FU2 data collected after COVID-19" & facet == "Females 45-64")$predicted - 
         subset(sit.test2,x==2 & group == "FU2 data collected before COVID-19" & facet == "Females 45-64")$predicted)
         
se.Females.Young.2<-(sqrt(((subset(sit.test2,x==2 & group == "FU2 data collected after COVID-19" & facet == "Females 45-64")$std.error)^2 +
     (subset(sit.test2,x==2 & group == "FU2 data collected before COVID-19" & facet == "Females 45-64")$std.error^2))/2))

UL.Females.Young.2<-mean.diff.Females.Young.2 + se.Females.Young.2*1.96
LL.Females.Young.2<-mean.diff.Females.Young.2 - se.Females.Young.2*1.96

#Females 65+ years
mean.diff.Females.Old.1<-(subset(sit.test2,x==1 & group == "FU2 data collected after COVID-19" & facet == "Females 65+")$predicted - 
         subset(sit.test2,x==1 & group == "FU2 data collected before COVID-19" & facet == "Females 65+")$predicted)
         
se.Females.Old.1<-(sqrt(((subset(sit.test2,x==1 & group == "FU2 data collected after COVID-19" & facet == "Females 65+")$std.error)^2 +
     (subset(sit.test2,x==1 & group == "FU2 data collected before COVID-19" & facet == "Females 65+")$std.error^2))/2))

UL.Females.Old.1<-mean.diff.Females.Old.1 + se.Females.Old.1*1.96
LL.Females.Old.1<-mean.diff.Females.Old.1 - se.Females.Old.1*1.96

mean.diff.Females.Old.2<-(subset(sit.test2,x==2 & group == "FU2 data collected after COVID-19" & facet == "Females 65+")$predicted - 
         subset(sit.test2,x==2 & group == "FU2 data collected before COVID-19" & facet == "Females 65+")$predicted)
         
se.Females.Old.2<-(sqrt(((subset(sit.test2,x==2 & group == "FU2 data collected after COVID-19" & facet == "Females 65+")$std.error)^2 +
     (subset(sit.test2,x==2 & group == "FU2 data collected before COVID-19" & facet == "Females 65+")$std.error^2))/2))

UL.Females.Old.2<-mean.diff.Females.Old.2 + se.Females.Old.2*1.96
LL.Females.Old.2<-mean.diff.Females.Old.2 - se.Females.Old.2*1.96

#Males 45-64 years
mean.diff.Males.Young.1<-(subset(sit.test2,x==1 & group == "FU2 data collected after COVID-19" & facet == "Males 45-64")$predicted - 
         subset(sit.test2,x==1 & group == "FU2 data collected before COVID-19" & facet == "Males 45-64")$predicted)
         
se.Males.Young.1<-(sqrt(((subset(sit.test2,x==1 & group == "FU2 data collected after COVID-19" & facet == "Males 45-64")$std.error)^2 +
     (subset(sit.test2,x==1 & group == "FU2 data collected before COVID-19" & facet == "Males 45-64")$std.error^2))/2))

UL.Males.Young.1<-mean.diff.Males.Young.1 + se.Males.Young.1*1.96
LL.Males.Young.1<-mean.diff.Males.Young.1 - se.Males.Young.1*1.96

mean.diff.Males.Young.2<-(subset(sit.test2,x==2 & group == "FU2 data collected after COVID-19" & facet == "Males 45-64")$predicted - 
         subset(sit.test2,x==2 & group == "FU2 data collected before COVID-19" & facet == "Males 45-64")$predicted)
         
se.Males.Young.2<-(sqrt(((subset(sit.test2,x==2 & group == "FU2 data collected after COVID-19" & facet == "Males 45-64")$std.error)^2 +
     (subset(sit.test2,x==2 & group == "FU2 data collected before COVID-19" & facet == "Males 45-64")$std.error^2))/2))

UL.Males.Young.2<-mean.diff.Males.Young.2 + se.Males.Young.2*1.96
LL.Males.Young.2<-mean.diff.Males.Young.2 - se.Males.Young.2*1.96

#Males 65+ years
mean.diff.Males.Old.1<-(subset(sit.test2,x==1 & group == "FU2 data collected after COVID-19" & facet == "Males 65+")$predicted - 
         subset(sit.test2,x==1 & group == "FU2 data collected before COVID-19" & facet == "Males 65+")$predicted)
         
se.Males.Old.1<-(sqrt(((subset(sit.test2,x==1 & group == "FU2 data collected after COVID-19" & facet == "Males 65+")$std.error)^2 +
     (subset(sit.test2,x==1 & group == "FU2 data collected before COVID-19" & facet == "Males 65+")$std.error^2))/2))

UL.Males.Old.1<-mean.diff.Males.Old.1 + se.Males.Old.1*1.96
LL.Males.Old.1<-mean.diff.Males.Old.1 - se.Males.Old.1*1.96

mean.diff.Males.Old.2<-(subset(sit.test2,x==2 & group == "FU2 data collected after COVID-19" & facet == "Males 65+")$predicted - 
         subset(sit.test2,x==2 & group == "FU2 data collected before COVID-19" & facet == "Males 65+")$predicted)
         
se.Males.Old.2<-(sqrt(((subset(sit.test2,x==2 & group == "FU2 data collected after COVID-19" & facet == "Males 65+")$std.error)^2 +
     (subset(sit.test2,x==2 & group == "FU2 data collected before COVID-19" & facet == "Males 65+")$std.error^2))/2))

UL.Males.Old.2<-mean.diff.Males.Old.2 + se.Males.Old.2*1.96
LL.Males.Old.2<-mean.diff.Males.Old.2 - se.Males.Old.2*1.96



#Mean differences and LL and UL
mean.diff.Females.Young.1
UL.Females.Young.1
LL.Females.Young.1

mean.diff.Females.Young.2
UL.Females.Young.2
LL.Females.Young.2

mean.diff.Females.Old.1
UL.Females.Old.1
LL.Females.Old.1

mean.diff.Females.Old.2
UL.Females.Old.2
LL.Females.Old.2

mean.diff.Males.Young.1
UL.Males.Young.1
LL.Males.Young.1

mean.diff.Males.Young.2
UL.Males.Young.2
LL.Males.Young.2

mean.diff.Males.Old.1
UL.Males.Old.1
LL.Males.Old.1

mean.diff.Males.Old.2
UL.Males.Old.2
LL.Males.Old.2
```

z-scores
```{r}
z.Females.Young.1 <- (subset(sit.test2,x==1 & group == "FU2 data collected after COVID-19" & facet == "Females 45-64")$predicted - 
         subset(sit.test2,x==1 & group == "FU2 data collected before COVID-19" & facet == "Females 45-64")$predicted) / (sqrt(((subset(sit.test2,x==1 & group == "FU2 data collected after COVID-19" & facet == "Females 45-64")$std.error)^2 +
     (subset(sit.test2,x==1 & group == "FU2 data collected before COVID-19" & facet == "Females 45-64")$std.error^2))/2))
     
z.Females.Young.2 <- (subset(sit.test2,x==2 & group == "FU2 data collected after COVID-19" & facet == "Females 45-64")$predicted - 
         subset(sit.test2,x==2 & group == "FU2 data collected before COVID-19" & facet == "Females 45-64")$predicted) / (sqrt(((subset(sit.test2,x==2 & group == "FU2 data collected after COVID-19" & facet == "Females 45-64")$std.error)^2 +
         (subset(sit.test2,x==2 & group == "FU2 data collected before COVID-19" & facet == "Females 45-64")$std.error^2))/2))

z.Females.Old.1 <- (subset(sit.test2,x==1 & group == "FU2 data collected after COVID-19" & facet == "Females 65+")$predicted - 
         subset(sit.test2,x==1 & group == "FU2 data collected before COVID-19" & facet == "Females 65+")$predicted) / (sqrt(((subset(sit.test2,x==1 & group == "FU2 data collected after COVID-19" & facet == "Females 65+")$std.error)^2 +
     (subset(sit.test2,x==1 & group == "FU2 data collected before COVID-19" & facet == "Females 65+")$std.error^2))/2))
     
z.Females.Old.2 <- (subset(sit.test2,x==2 & group == "FU2 data collected after COVID-19" & facet == "Females 65+")$predicted - 
         subset(sit.test2,x==2 & group == "FU2 data collected before COVID-19" & facet == "Females 65+")$predicted) / (sqrt(((subset(sit.test2,x==2 & group == "FU2 data collected after COVID-19" & facet == "Females 65+")$std.error)^2 +
         (subset(sit.test2,x==2 & group == "FU2 data collected before COVID-19" & facet == "Females 65+")$std.error^2))/2))

z.Males.Young.1 <- (subset(sit.test2,x==1 & group == "FU2 data collected after COVID-19" & facet == "Males 45-64")$predicted - 
         subset(sit.test2,x==1 & group == "FU2 data collected before COVID-19" & facet == "Males 45-64")$predicted) / (sqrt(((subset(sit.test2,x==1 & group == "FU2 data collected after COVID-19" & facet == "Males 45-64")$std.error)^2 +
     (subset(sit.test2,x==1 & group == "FU2 data collected before COVID-19" & facet == "Males 45-64")$std.error^2))/2))
     
z.Males.Young.2 <- (subset(sit.test2,x==2 & group == "FU2 data collected after COVID-19" & facet == "Males 45-64")$predicted - 
         subset(sit.test2,x==2 & group == "FU2 data collected before COVID-19" & facet == "Males 45-64")$predicted) / (sqrt(((subset(sit.test2,x==2 & group == "FU2 data collected after COVID-19" & facet == "Males 45-64")$std.error)^2 +
         (subset(sit.test2,x==2 & group == "FU2 data collected before COVID-19" & facet == "Males 45-64")$std.error^2))/2))

z.Males.Old.1 <- (subset(sit.test2,x==1 & group == "FU2 data collected after COVID-19" & facet == "Males 65+")$predicted - 
         subset(sit.test2,x==1 & group == "FU2 data collected before COVID-19" & facet == "Males 65+")$predicted) / (sqrt(((subset(sit.test2,x==1 & group == "FU2 data collected after COVID-19" & facet == "Males 65+")$std.error)^2 +
     (subset(sit.test2,x==1 & group == "FU2 data collected before COVID-19" & facet == "Males 65+")$std.error^2))/2))
     
z.Males.Old.2 <- (subset(sit.test2,x==2 & group == "FU2 data collected after COVID-19" & facet == "Males 65+")$predicted - 
         subset(sit.test2,x==2 & group == "FU2 data collected before COVID-19" & facet == "Males 65+")$predicted) / (sqrt(((subset(sit.test2,x==2 & group == "FU2 data collected after COVID-19" & facet == "Males 65+")$std.error)^2 +
         (subset(sit.test2,x==2 & group == "FU2 data collected before COVID-19" & facet == "Males 65+")$std.error^2))/2))

#z-scores
z.Females.Young.1
z.Females.Young.2

z.Males.Young.1
z.Males.Young.2

z.Females.Old.1
z.Females.Old.2

z.Males.Old.1
z.Males.Old.2
```

p-values for z-scores
```{r}
2*pnorm(z.Females.Young.1, mean = 0, sd = 1, lower.tail = FALSE)
2*pnorm(z.Females.Young.2, mean = 0, sd = 1, lower.tail = FALSE)

2*pnorm(z.Males.Young.1, mean = 0, sd = 1, lower.tail = FALSE)
2*pnorm(z.Males.Young.2, mean = 0, sd = 1, lower.tail = FALSE)

2*pnorm(z.Females.Old.1, mean = 0, sd = 1, lower.tail = FALSE)
2*pnorm(z.Females.Old.2, mean = 0, sd = 1, lower.tail = FALSE)

2*pnorm(z.Males.Old.1, mean = 0, sd = 1, lower.tail = FALSE)
2*pnorm(z.Males.Old.2, mean = 0, sd = 1, lower.tail = FALSE)
```

### 14.2.4) Graph of predicted probabilities
```{r}
ggpredict(sit2, c("timefactor","Pandemic","Age_sex")) %>% plot()
```


# 15) Sleep Results

## 15.1) Full model adjusted for baseline


### 15.1.1) Model
```{r}
sleep1 <- glmer(
  RSTLS_Sleep ~ timefactor*Pandemic + Age + Sex + RSTLS_Sleepbaseline + Education + Ethnicity + IncomeLevel + BMI + CESD.10baseline + SmokingStatus + 
    Relationshipstatus + Livingstatus + Anxiety + MoodDisord + Chronicconditions + 
    (1|ID), 
  data = Tracking.data_long_2, 
  family = binomial(link = "logit")
)

sleep1
```

### 15.1.2) Predicted probabilities

```{r}
ggpredict(sleep1, c("timefactor", "Pandemic"))
```

### 15.1.3) Contrasts for predicted probilities

Mean Differences and 95% CIs
```{r}
sleep.test <- as.data.frame(ggpredict(sleep1, c("timefactor", "Pandemic")))

mean.diff.3<-(subset(sleep.test,x==1 & group == "FU2 data collected after COVID-19")$predicted - 
         subset(sleep.test,x==1 & group == "FU2 data collected before COVID-19")$predicted)
         
se.3<-(sqrt(((subset(sleep.test,x==1 & group == "FU2 data collected after COVID-19")$std.error)^2 +
         (subset(sleep.test,x==1 & group == "FU2 data collected before COVID-19")$std.error^2))/2))

UL.3<-mean.diff.3 + se.3*1.96
LL.3<-mean.diff.3 - se.3*1.96

         
mean.diff.4<-(subset(sleep.test,x==2 & group == "FU2 data collected after COVID-19")$predicted - 
         subset(sleep.test,x==2 & group == "FU2 data collected before COVID-19")$predicted)
         
se.4<-(sqrt(((subset(sleep.test,x==2 & group == "FU2 data collected after COVID-19")$std.error)^2 +
         (subset(sleep.test,x==2 & group == "FU2 data collected before COVID-19")$std.error^2))/2))

UL.4<-mean.diff.4 + se.4*1.96
LL.4<-mean.diff.4 - se.4*1.96

#Mean differences and LL and UL
mean.diff.3
UL.3
LL.3

mean.diff.4
UL.4
LL.4
```

z-scores
```{r}
z.3<- (subset(sleep.test,x==1 & group == "FU2 data collected after COVID-19")$predicted - 
         subset(sleep.test,x==1 & group == "FU2 data collected before COVID-19")$predicted) / (sqrt(((subset(sleep.test,x==1 & group == "FU2 data collected after COVID-19")$std.error)^2 +
                                                                                                     (subset(sleep.test,x==1 & group == "FU2 data collected before COVID-19")$std.error^2))/2))

z.4<- (subset(sleep.test,x==2 & group == "FU2 data collected after COVID-19")$predicted - 
         subset(sleep.test,x==2 & group == "FU2 data collected before COVID-19")$predicted) / (sqrt(((subset(sleep.test,x==2 & group == "FU2 data collected after COVID-19")$std.error)^2 +
                                                                                                     (subset(sleep.test,x==2 & group == "FU2 data collected before COVID-19")$std.error^2))/2))

#z-scores
z.3
z.4
```

p-values for z-scores
```{r}
2*pnorm(z.3, mean = 0, sd = 1, lower.tail = FALSE)
2*pnorm(z.4, mean = 0, sd = 1, lower.tail = FALSE)
```

### 15.1.4) Graph of predicted probabilities
```{r}
ggpredict(sleep1, c("timefactor", "Pandemic")) %>% plot()
```


## 15.2) Full model adjusted for baseline (age and sex differences)

### 15.2.1) Model
```{r}
sleep2 <- glmer(
  RSTLS_Sleep ~ timefactor*Pandemic*Age_sex + RSTLS_Sleepbaseline + Education + Ethnicity + IncomeLevel + BMI + CESD.10baseline + SmokingStatus + 
    Relationshipstatus + Livingstatus + Anxiety + MoodDisord + Chronicconditions + 
    (1|ID), 
  data = Tracking.data_long_2, 
  family = binomial(link = "logit")
)

sleep2
```

### 15.2.2) Predicted probabilities

```{r}
ggpredict(sleep2, c("Pandemic","timefactor","Age_sex"))
```

### 15.2.3) Contrasts for predicted probilities

Mean differences and 95% CIs
```{r}
sleep.test2 <- as.data.frame(ggpredict(sleep2, c("timefactor", "Pandemic", "Age_sex")))

#Females 45-64 years
mean.diff.Females.Young.3<-(subset(sleep.test2,x==1 & group == "FU2 data collected after COVID-19" & facet == "Females 45-64")$predicted - 
         subset(sleep.test2,x==1 & group == "FU2 data collected before COVID-19" & facet == "Females 45-64")$predicted)
         
se.Females.Young.3<-(sqrt(((subset(sleep.test2,x==1 & group == "FU2 data collected after COVID-19" & facet == "Females 45-64")$std.error)^2 +
     (subset(sleep.test2,x==1 & group == "FU2 data collected before COVID-19" & facet == "Females 45-64")$std.error^2))/2))

UL.Females.Young.3<-mean.diff.Females.Young.3 + se.Females.Young.3*1.96
LL.Females.Young.3<-mean.diff.Females.Young.3 - se.Females.Young.3*1.96

mean.diff.Females.Young.4<-(subset(sleep.test2,x==2 & group == "FU2 data collected after COVID-19" & facet == "Females 45-64")$predicted - 
         subset(sleep.test2,x==2 & group == "FU2 data collected before COVID-19" & facet == "Females 45-64")$predicted)
         
se.Females.Young.4<-(sqrt(((subset(sleep.test2,x==2 & group == "FU2 data collected after COVID-19" & facet == "Females 45-64")$std.error)^2 +
     (subset(sleep.test2,x==2 & group == "FU2 data collected before COVID-19" & facet == "Females 45-64")$std.error^2))/2))

UL.Females.Young.4<-mean.diff.Females.Young.4 + se.Females.Young.4*1.96
LL.Females.Young.4<-mean.diff.Females.Young.4 - se.Females.Young.4*1.96

#Females 65+ years
mean.diff.Females.Old.3<-(subset(sleep.test2,x==1 & group == "FU2 data collected after COVID-19" & facet == "Females 65+")$predicted - 
         subset(sleep.test2,x==1 & group == "FU2 data collected before COVID-19" & facet == "Females 65+")$predicted)
         
se.Females.Old.3<-(sqrt(((subset(sleep.test2,x==1 & group == "FU2 data collected after COVID-19" & facet == "Females 65+")$std.error)^2 +
     (subset(sleep.test2,x==1 & group == "FU2 data collected before COVID-19" & facet == "Females 65+")$std.error^2))/2))

UL.Females.Old.3<-mean.diff.Females.Old.3 + se.Females.Old.3*1.96
LL.Females.Old.3<-mean.diff.Females.Old.3 - se.Females.Old.3*1.96

mean.diff.Females.Old.4<-(subset(sleep.test2,x==2 & group == "FU2 data collected after COVID-19" & facet == "Females 65+")$predicted - 
         subset(sleep.test2,x==2 & group == "FU2 data collected before COVID-19" & facet == "Females 65+")$predicted)
         
se.Females.Old.4<-(sqrt(((subset(sleep.test2,x==2 & group == "FU2 data collected after COVID-19" & facet == "Females 65+")$std.error)^2 +
     (subset(sleep.test2,x==2 & group == "FU2 data collected before COVID-19" & facet == "Females 65+")$std.error^2))/2))

UL.Females.Old.4<-mean.diff.Females.Old.4 + se.Females.Old.4*1.96
LL.Females.Old.4<-mean.diff.Females.Old.4 - se.Females.Old.4*1.96

#Males 45-64 years
mean.diff.Males.Young.3<-(subset(sleep.test2,x==1 & group == "FU2 data collected after COVID-19" & facet == "Males 45-64")$predicted - 
         subset(sleep.test2,x==1 & group == "FU2 data collected before COVID-19" & facet == "Males 45-64")$predicted)
         
se.Males.Young.3<-(sqrt(((subset(sleep.test2,x==1 & group == "FU2 data collected after COVID-19" & facet == "Males 45-64")$std.error)^2 +
     (subset(sleep.test2,x==1 & group == "FU2 data collected before COVID-19" & facet == "Males 45-64")$std.error^2))/2))

UL.Males.Young.3<-mean.diff.Males.Young.3 + se.Males.Young.3*1.96
LL.Males.Young.3<-mean.diff.Males.Young.3 - se.Males.Young.3*1.96

mean.diff.Males.Young.4<-(subset(sleep.test2,x==2 & group == "FU2 data collected after COVID-19" & facet == "Males 45-64")$predicted - 
         subset(sleep.test2,x==2 & group == "FU2 data collected before COVID-19" & facet == "Males 45-64")$predicted)
         
se.Males.Young.4<-(sqrt(((subset(sleep.test2,x==2 & group == "FU2 data collected after COVID-19" & facet == "Males 45-64")$std.error)^2 +
     (subset(sleep.test2,x==2 & group == "FU2 data collected before COVID-19" & facet == "Males 45-64")$std.error^2))/2))

UL.Males.Young.4<-mean.diff.Males.Young.4 + se.Males.Young.4*1.96
LL.Males.Young.4<-mean.diff.Males.Young.4 - se.Males.Young.4*1.96

#Males 65+ years
mean.diff.Males.Old.3<-(subset(sleep.test2,x==1 & group == "FU2 data collected after COVID-19" & facet == "Males 65+")$predicted - 
         subset(sleep.test2,x==1 & group == "FU2 data collected before COVID-19" & facet == "Males 65+")$predicted)
         
se.Males.Old.3<-(sqrt(((subset(sleep.test2,x==1 & group == "FU2 data collected after COVID-19" & facet == "Males 65+")$std.error)^2 +
     (subset(sleep.test2,x==1 & group == "FU2 data collected before COVID-19" & facet == "Males 65+")$std.error^2))/2))

UL.Males.Old.3<-mean.diff.Males.Old.3 + se.Males.Old.3*1.96
LL.Males.Old.3<-mean.diff.Males.Old.3 - se.Males.Old.3*1.96

mean.diff.Males.Old.4<-(subset(sleep.test2,x==2 & group == "FU2 data collected after COVID-19" & facet == "Males 65+")$predicted - 
         subset(sleep.test2,x==2 & group == "FU2 data collected before COVID-19" & facet == "Males 65+")$predicted)
         
se.Males.Old.4<-(sqrt(((subset(sleep.test2,x==2 & group == "FU2 data collected after COVID-19" & facet == "Males 65+")$std.error)^2 +
     (subset(sleep.test2,x==2 & group == "FU2 data collected before COVID-19" & facet == "Males 65+")$std.error^2))/2))

UL.Males.Old.4<-mean.diff.Males.Old.4 + se.Males.Old.4*1.96
LL.Males.Old.4<-mean.diff.Males.Old.4 - se.Males.Old.4*1.96



#Mean differences and LL and UL
mean.diff.Females.Young.3
UL.Females.Young.3
LL.Females.Young.3

mean.diff.Females.Young.4
UL.Females.Young.4
LL.Females.Young.4

mean.diff.Females.Old.3
UL.Females.Old.3
LL.Females.Old.3

mean.diff.Females.Old.4
UL.Females.Old.4
LL.Females.Old.4

mean.diff.Males.Young.3
UL.Males.Young.3
LL.Males.Young.3

mean.diff.Males.Young.4
UL.Males.Young.4
LL.Males.Young.4

mean.diff.Males.Old.3
UL.Males.Old.3
LL.Males.Old.3

mean.diff.Males.Old.4
UL.Males.Old.4
LL.Males.Old.4
```


Z-scores
```{r}

z.Females.Young.3 <- (subset(sleep.test2,x==1 & group == "FU2 data collected after COVID-19" & facet == "Females 45-64")$predicted - 
                        subset(sleep.test2,x==1 & group == "FU2 data collected before COVID-19" & facet == "Females 45-64")$predicted) / (sqrt(((subset(sleep.test2,x==1 & group == "FU2 data collected after COVID-19" & facet == "Females 45-64")$std.error)^2 +
                                                                                                                                                (subset(sleep.test2,x==1 & group == "FU2 data collected before COVID-19" & facet == "Females 45-64")$std.error^2))/2))

z.Females.Young.4 <- (subset(sleep.test2,x==2 & group == "FU2 data collected after COVID-19" & facet == "Females 45-64")$predicted - 
                        subset(sleep.test2,x==2 & group == "FU2 data collected before COVID-19" & facet == "Females 45-64")$predicted) / (sqrt(((subset(sleep.test2,x==2 & group == "FU2 data collected after COVID-19" & facet == "Females 45-64")$std.error)^2 +
                                                                                                                                                (subset(sleep.test2,x==2 & group == "FU2 data collected before COVID-19" & facet == "Females 45-64")$std.error^2))/2))

z.Females.Old.3 <- (subset(sleep.test2,x==1 & group == "FU2 data collected after COVID-19" & facet == "Females 65+")$predicted - 
                      subset(sleep.test2,x==1 & group == "FU2 data collected before COVID-19" & facet == "Females 65+")$predicted) / (sqrt(((subset(sleep.test2,x==1 & group == "FU2 data collected after COVID-19" & facet == "Females 65+")$std.error)^2 +
                                                                                                                                            (subset(sleep.test2,x==1 & group == "FU2 data collected before COVID-19" & facet == "Females 65+")$std.error^2))/2))

z.Females.Old.4 <- (subset(sleep.test2,x==2 & group == "FU2 data collected after COVID-19" & facet == "Females 65+")$predicted - 
                      subset(sleep.test2,x==2 & group == "FU2 data collected before COVID-19" & facet == "Females 65+")$predicted) / (sqrt(((subset(sleep.test2,x==2 & group == "FU2 data collected after COVID-19" & facet == "Females 65+")$std.error)^2 +
                                                                                                                                            (subset(sleep.test2,x==2 & group == "FU2 data collected before COVID-19" & facet == "Females 65+")$std.error^2))/2))

z.Males.Young.3 <- (subset(sleep.test2,x==1 & group == "FU2 data collected after COVID-19" & facet == "Males 45-64")$predicted - 
                      subset(sleep.test2,x==1 & group == "FU2 data collected before COVID-19" & facet == "Males 45-64")$predicted) / (sqrt(((subset(sleep.test2,x==1 & group == "FU2 data collected after COVID-19" & facet == "Males 45-64")$std.error)^2 +
                                                                                                                                            (subset(sleep.test2,x==1 & group == "FU2 data collected before COVID-19" & facet == "Males 45-64")$std.error^2))/2))

z.Males.Young.4 <- (subset(sleep.test2,x==2 & group == "FU2 data collected after COVID-19" & facet == "Males 45-64")$predicted - 
                      subset(sleep.test2,x==2 & group == "FU2 data collected before COVID-19" & facet == "Males 45-64")$predicted) / (sqrt(((subset(sleep.test2,x==2 & group == "FU2 data collected after COVID-19" & facet == "Males 45-64")$std.error)^2 +
                                                                                                                                            (subset(sleep.test2,x==2 & group == "FU2 data collected before COVID-19" & facet == "Males 45-64")$std.error^2))/2))

z.Males.Old.3 <- (subset(sleep.test2,x==1 & group == "FU2 data collected after COVID-19" & facet == "Males 65+")$predicted - 
                    subset(sleep.test2,x==1 & group == "FU2 data collected before COVID-19" & facet == "Males 65+")$predicted) / (sqrt(((subset(sleep.test2,x==1 & group == "FU2 data collected after COVID-19" & facet == "Males 65+")$std.error)^2 +
                                                                                                                                        (subset(sleep.test2,x==1 & group == "FU2 data collected before COVID-19" & facet == "Males 65+")$std.error^2))/2))

z.Males.Old.4 <- (subset(sleep.test2,x==2 & group == "FU2 data collected after COVID-19" & facet == "Males 65+")$predicted - 
                    subset(sleep.test2,x==2 & group == "FU2 data collected before COVID-19" & facet == "Males 65+")$predicted) / (sqrt(((subset(sleep.test2,x==2 & group == "FU2 data collected after COVID-19" & facet == "Males 65+")$std.error)^2 +
                                                                                                                                        (subset(sleep.test2,x==2 & group == "FU2 data collected before COVID-19" & facet == "Males 65+")$std.error^2))/2))

#z-scores
z.Females.Young.3
z.Females.Young.4

z.Males.Young.3
z.Males.Young.4

z.Females.Old.3
z.Females.Old.4

z.Males.Old.3
z.Males.Old.4
```

p-values for z-scores
```{r}
2*pnorm(z.Females.Young.3, mean = 0, sd = 1, lower.tail = FALSE)
2*pnorm(z.Females.Young.4, mean = 0, sd = 1, lower.tail = FALSE)

2*pnorm(z.Males.Young.3, mean = 0, sd = 1, lower.tail = FALSE)
2*pnorm(z.Males.Young.4, mean = 0, sd = 1, lower.tail = FALSE)

2*pnorm(z.Females.Old.3, mean = 0, sd = 1, lower.tail = FALSE)
2*pnorm(z.Females.Old.4, mean = 0, sd = 1, lower.tail = FALSE)

2*pnorm(z.Males.Old.3, mean = 0, sd = 1, lower.tail = FALSE)
2*pnorm(z.Males.Old.4, mean = 0, sd = 1, lower.tail = FALSE)
```

### 15.2.4) Graph of predicted probabilities
```{r}
ggpredict(sleep2, c("timefactor","Pandemic","Age_sex")) %>% plot()
```



# 16) Sensitivity Analyses 

## 16.1) Truncated Sample Development

For this sensitivity analysis, we only include participants w/ data collected in 2019 onward (N=16,649)
```{r}
startdate <- as.POSIXct("2019-01-01 00:00:00", tz = "EST")
truncated <- subset(Tracking.Adjusted_Final, timestamp>startdate)
```

Linear mixed model set-up
```{r}
truncated.short<-truncated[c(1,4:12,14,15,18:21,146,147,98,115,132,102,119,136,106,123,140,110,127,144,13,44,75,22,53,84,23,54,85)]

truncated.short2<-rename(truncated.short, c("Age"="Age_0","Sex"="Sex_0","Ethnicity"="Ethnicity_0","Relationshipstatus"="Relationship_status_0",
                             "Education"="Education4_0", "IncomeLevel"="Income_Level_0", "Livingstatus"="Living_status_0", 
                             "Alcohol"="Alcohol_0", "SmokingStatus"="Smoking_Status_0","Anxiety"="Anxiety_0","MoodDisord"="Mood_Disord_0",
                             "Chronicconditions"="Chronic_conditions_0", "BMI"="BMI_0","PASE_Sit_0"="PASE_Q1B_0","PASE_Sit_1"="PASE_Q1B_1","PASE_Sit_2"="PASE_Q1B_2"))

truncated.short2$PASE_TOTALbaseline <- truncated.short2$PASE_TOTAL_0

truncated.short3<-truncated.short2[c(1:18,40,19:39)]

truncated.short4<-truncated.short3[c(1:18,20,23,26,29,32,35,38,21:22,24:25,27:28,30:31,33:34,36:37,39:40)]

colnames(truncated.short3) <- (gsub("_2",".3",colnames(truncated.short3)))
colnames(truncated.short3) <- (gsub("_1",".2",colnames(truncated.short3)))
colnames(truncated.short3) <- (gsub("_0",".1",colnames(truncated.short3)))

colnames(truncated.short4) <- (gsub("_2",".2",colnames(truncated.short4)))
colnames(truncated.short4) <- (gsub("_1",".1",colnames(truncated.short4)))
colnames(truncated.short4) <- (gsub("_0","baseline",colnames(truncated.short4)))


truncated.data_long <- reshape(as.data.frame(truncated.short3),idvar="ID",varying=20:40,direction="long",sep=".") #reshape data into long format (3 timepoints)
truncated.data_long_2 <- reshape(as.data.frame(truncated.short4),idvar="ID",varying=26:39,direction="long",sep=".") #reshape data into long format (3 timepoints)
```

Indexed time as a categorical factor
```{r}
#Treat time as a fixed effect
truncated.data_long$timefactor<-as.factor(truncated.data_long$time)
truncated.data_long_2$timefactor<-as.factor(truncated.data_long_2$time)
```

Age and Sex grouping
```{r}
truncated.data_long$Age_sex<-NA
truncated.data_long$Age_sex[truncated.data_long$Age<=64 & truncated.data_long$Sex == "M"]<-"Males 45-64"
truncated.data_long$Age_sex[truncated.data_long$Age<=64 & truncated.data_long$Sex == "F"]<-"Females 45-64"
truncated.data_long$Age_sex[truncated.data_long$Age>64 & truncated.data_long$Sex == "M"]<-"Males 65+"
truncated.data_long$Age_sex[truncated.data_long$Age>64 & truncated.data_long$Sex == "F"]<-"Females 65+"

truncated.data_long_2$Age_sex<-NA
truncated.data_long_2$Age_sex[truncated.data_long_2$Age<=64 & truncated.data_long_2$Sex == "M"]<-"Males 45-64"
truncated.data_long_2$Age_sex[truncated.data_long_2$Age<=64 & truncated.data_long_2$Sex == "F"]<-"Females 45-64"
truncated.data_long_2$Age_sex[truncated.data_long_2$Age>64 & truncated.data_long_2$Sex == "M"]<-"Males 65+"
truncated.data_long_2$Age_sex[truncated.data_long_2$Age>64 & truncated.data_long_2$Sex == "F"]<-"Females 65+"
```

## 16.2) Truncated Sample Characteristics

Truncated full sample (N= 16,649)
```{r}
Baseline<-dput(names(truncated[c(5,4,14,12,6,7,8,9,10,11,15,18,19,20,13,28,30,26,23)]))
Table1_truncated<-CreateTableOne(vars=Baseline, data=truncated)
print(Table1_truncated,contDigits=2,missing=TRUE,quote=TRUE)
```

Final baseline sample stratified by whether FU2 data was collected before (N= 7132) or after (N= 6898) the start of the COVID-19 pandemic
```{r}
Table1_truncated_stratify<-CreateTableOne(vars=Baseline, strata="Pandemic", data=truncated)
print(Table1_truncated_stratify,contDigits=2,missing=TRUE,quote=TRUE)
```


## 16.3) Full Adjusted Model: Time x Pandemic effects on cognition, physical activity, and sleep duration (not adjusting for baseline)

All models use normalized cognitive scores.Each model is adjusted for baseline age, sex, education, ethnicity, income level, baseline BMI, baseline CESD-10 score, smoking status, relationship status at baseline, living status at baseline, diagnosis of anxiety or mood disorder at baseline, number of chronic conditions at baseline, and baseline PASE score

### 16.3.1) RVLT Immediate Recall

#### 16.3.1.1) Model
```{r}
modelRVLT_imm_8_trun<- lmer(RVLT_Immediate_Normed~ timefactor*Pandemic + Age + Sex + Education + Ethnicity + IncomeLevel + BMI + CESD.20.1 + SmokingStatus + 
                         Relationshipstatus + Livingstatus + Anxiety + MoodDisord + Chronicconditions + PASE_TOTALbaseline +
                         (1|ID), data= truncated.data_long)
summary(modelRVLT_imm_8_trun)
```

#### 16.3.1.2) Estimated marginal means
```{r}
lsmeans(modelRVLT_imm_8_trun, ~Pandemic|timefactor)
contrast(lsmeans(modelRVLT_imm_8_trun, ~Pandemic|timefactor), "pairwise", adj="none")
confint(contrast(lsmeans(modelRVLT_imm_8_trun, ~Pandemic|timefactor), "pairwise", adj="none"), parm, level = 0.95)
```

#### 16.3.1.3) Graph of estimated marginal means
```{r}
RVLTimmediate_lsmeans_8trun <- summary(lsmeans(modelRVLT_imm_8_trun, ~timefactor|Pandemic))
RVLTimmediate_lsmeans_8trun$Time<-NA
RVLTimmediate_lsmeans_8trun$Time[RVLTimmediate_lsmeans_8trun$timefactor==1]<-"Baseline"
RVLTimmediate_lsmeans_8trun$Time[RVLTimmediate_lsmeans_8trun$timefactor==2]<-"Follow-up 1"
RVLTimmediate_lsmeans_8trun$Time[RVLTimmediate_lsmeans_8trun$timefactor==3]<-"Follow-up 2"
ggplot(RVLTimmediate_lsmeans_8trun, aes(x = Time, y = lsmean, group=Pandemic)) +
  geom_line(aes(linetype = Pandemic)) + 
  geom_errorbar(aes(ymin = asymp.LCL, ymax = asymp.UCL), width = 0.2) +
  geom_point(aes(y = lsmean), size = 3, shape = 21, fill = "white") +
  labs(x = "Time", y = "RVLT Immediate Score", title = "RVLT Immediate Score from Baseline to FU2 by Pandemic status") +
  theme_bw()
```


### 16.3.2) RVLT Delayed Recall

#### 16.3.2.1) Model
```{r}
modelRVLT_del_8trun<- lmer(RVLT_Delayed_Normed ~ timefactor*Pandemic + Age + Sex + Education + Ethnicity + IncomeLevel + BMI + CESD.20.1 + SmokingStatus + 
                         Relationshipstatus + Livingstatus + Anxiety + MoodDisord + Chronicconditions + PASE_TOTALbaseline +
                        (1|ID), data= truncated.data_long)
summary(modelRVLT_del_8trun)
```

#### 16.3.2.2) Estimated marginal means
```{r}
lsmeans(modelRVLT_del_8trun, ~Pandemic|timefactor)
contrast(lsmeans(modelRVLT_del_8trun, ~Pandemic|timefactor), "pairwise", adj="none")
confint(contrast(lsmeans(modelRVLT_del_8trun, ~Pandemic|timefactor), "pairwise", adj="none"), parm, level = 0.95)
```

#### 16.3.2.3) Graph of estimated marginal means
```{r}
RVLTdelayed_lsmeans_8trun <- summary(lsmeans(modelRVLT_del_8trun, ~timefactor|Pandemic))
RVLTdelayed_lsmeans_8trun$Time<-NA
RVLTdelayed_lsmeans_8trun$Time[RVLTdelayed_lsmeans_8trun$timefactor==1]<-"Baseline"
RVLTdelayed_lsmeans_8trun$Time[RVLTdelayed_lsmeans_8trun$timefactor==2]<-"Follow-up 1"
RVLTdelayed_lsmeans_8trun$Time[RVLTdelayed_lsmeans_8trun$timefactor==3]<-"Follow-up 2"
ggplot(RVLTdelayed_lsmeans_8trun, aes(x = Time, y = lsmean, group=Pandemic)) +
  geom_line(aes(linetype = Pandemic)) + 
  geom_errorbar(aes(ymin = asymp.LCL, ymax = asymp.UCL), width = 0.2) +
  geom_point(aes(y = lsmean), size = 3, shape = 21, fill = "white") +
  labs(x = "Time", y = "RVLT Delayed Score", title = "RVLT Delayed Score from Baseline to FU2 by Pandemic status") +
  theme_bw()
```



### 16.3.3) Mental Alteration Test

#### 16.3.3.1) Model
```{r}
modelMAT_8trun<- lmer(MAT_Normed ~ timefactor*Pandemic + Age + Sex + Education + Ethnicity + IncomeLevel + BMI + CESD.20.1 + SmokingStatus + 
                         Relationshipstatus + Livingstatus + Anxiety + MoodDisord + Chronicconditions + PASE_TOTALbaseline +
                    (1|ID), data= truncated.data_long)
summary(modelMAT_8trun)
```

#### 16.3.3.2) Estimated marginal means
```{r}
lsmeans(modelMAT_8trun, ~Pandemic|timefactor)
contrast(lsmeans(modelMAT_8trun, ~Pandemic|timefactor), "pairwise", adj="none")
confint(contrast(lsmeans(modelMAT_8trun, ~Pandemic|timefactor), "pairwise", adj="none"), parm, level = 0.95)
```

#### 16.3.3.3) Graph of estimated marginal means
```{r}
MAT_lsmeans_8trun <- summary(lsmeans(modelMAT_8trun, ~timefactor|Pandemic))
MAT_lsmeans_8trun$Time<-NA
MAT_lsmeans_8trun$Time[MAT_lsmeans_8trun$timefactor==1]<-"Baseline"
MAT_lsmeans_8trun$Time[MAT_lsmeans_8trun$timefactor==2]<-"Follow-up 1"
MAT_lsmeans_8trun$Time[MAT_lsmeans_8trun$timefactor==3]<-"Follow-up 2"
ggplot(MAT_lsmeans_8trun, aes(x = Time, y = lsmean, group=Pandemic)) +
  geom_line(aes(linetype = Pandemic)) + 
  geom_errorbar(aes(ymin = asymp.LCL, ymax = asymp.UCL), width = 0.2) +
  geom_point(aes(y = lsmean), size = 3, shape = 21, fill = "white") +
  labs(x = "Time", y = "MAT Score", title = "Mental Alteration Test Score from Baseline to FU2 by Pandemic status") +
  theme_bw()
```




### 16.3.4) Animal Fluency

#### 16.3.4.1) Model
```{r}
modelAnimals_8trun<- lmer(Animal_Fluency_Normed ~ timefactor*Pandemic + Age + Sex + Education + Ethnicity + IncomeLevel + BMI + CESD.20.1 + SmokingStatus + 
                         Relationshipstatus + Livingstatus + Anxiety + MoodDisord + Chronicconditions + PASE_TOTALbaseline +
                        (1|ID), data= truncated.data_long)
summary(modelAnimals_8trun)
```

#### 16.3.4.2) Estimated marginal means
```{r}
lsmeans(modelAnimals_8trun, ~Pandemic|timefactor)
contrast(lsmeans(modelAnimals_8trun, ~Pandemic|timefactor), "pairwise", adj="none")
confint(contrast(lsmeans(modelAnimals_8trun, ~Pandemic|timefactor), "pairwise", adj="none"), parm, level = 0.95)
```

#### 16.3.4.3) Graph of estimated marginal means
```{r}
Animals_lsmeans_8trun <- summary(lsmeans(modelAnimals_8trun, ~timefactor|Pandemic))
Animals_lsmeans_8trun$Time<-NA
Animals_lsmeans_8trun$Time[Animals_lsmeans_8trun$timefactor==1]<-"Baseline"
Animals_lsmeans_8trun$Time[Animals_lsmeans_8trun$timefactor==2]<-"Follow-up 1"
Animals_lsmeans_8trun$Time[Animals_lsmeans_8trun$timefactor==3]<-"Follow-up 2"
ggplot(Animals_lsmeans_8trun, aes(x = Time, y = lsmean, group=Pandemic)) +
  geom_line(aes(linetype = Pandemic)) + 
  geom_errorbar(aes(ymin = asymp.LCL, ymax = asymp.UCL), width = 0.2) +
  geom_point(aes(y = lsmean), size = 3, shape = 21, fill = "white") +
  labs(x = "Time", y = "Animal Fluency (words)", title = "Animal Fluency Score from Baseline to FU2 by Pandemic status") +
  theme_bw()
```




## 16.4) Full Adjusted Model: Time x Pandemic effects on cognition and physical activity ( adjusting for baseline)

All models use normalized cognitive scores. Each model is adjusted for baseline age, sex, education, ethnicity, income level, baseline BMI, baseline CESD-10 score, smoking status, relationship status at baseline, living status at baseline, diagnosis of anxiety or mood disorder at baseline, number of chronic conditions at baseline, baseline PASE score, and baseline cognitive performance


### 16.4.1) RVLT Immediate Recall

#### 16.4.1.1) Model
```{r}
modelRVLT_imm_adj10trun<- lmer(RVLT_Immediate_Normed~ timefactor*Pandemic + Age + Sex + Education + Ethnicity + IncomeLevel + BMI + CESD.10baseline + SmokingStatus + Relationshipstatus + 
                            Livingstatus + Anxiety + MoodDisord + Chronicconditions + PASE_TOTALbaseline + RVLT_Immediate_Normedbaseline +
                            (1|ID), data= truncated.data_long_2)
summary(modelRVLT_imm_adj10trun)
```

#### 16.4.1.2) Estimated marginal means
```{r}
lsmeans(modelRVLT_imm_adj10trun, ~Pandemic|timefactor)
contrast(lsmeans(modelRVLT_imm_adj10trun, ~Pandemic|timefactor), "pairwise", adj="none")
confint(contrast(lsmeans(modelRVLT_imm_adj10trun, ~Pandemic|timefactor), "pairwise", adj="none"), parm, level = 0.95)
```

#### 16.4.1.3) Graph of estimated marginal means
```{r}
RVLTimmediate_lsmeans_adj10trun <- summary(lsmeans(modelRVLT_imm_adj10trun, ~timefactor|Pandemic))
RVLTimmediate_lsmeans_adj10trun$Time<-NA
RVLTimmediate_lsmeans_adj10trun$Time[RVLTimmediate_lsmeans_adj10trun$timefactor==1]<-"Follow-up 1"
RVLTimmediate_lsmeans_adj10trun$Time[RVLTimmediate_lsmeans_adj10trun$timefactor==2]<-"Follow-up 2"
ggplot(RVLTimmediate_lsmeans_adj10trun, aes(x = Time, y = lsmean, fill = Pandemic)) +
  geom_bar(stat="identity", position=position_dodge()) + 
  labs(x = "Time", y = "RVLT Immediate Normalized Score", title = "RVLT Immediate Normalized Score from FU1 to FU2 by Pandemic status 
       (controlling for baseline)") +
  theme_bw()
```



### 16.4.2) RVLT Delayed Recall

#### 16.4.2.1) Model
```{r}
modelRVLT_del_adj10trun<- lmer(RVLT_Delayed_Normed~ timefactor*Pandemic + Age + Sex + Education + Ethnicity + IncomeLevel + BMI + CESD.10baseline + SmokingStatus + Relationshipstatus + 
                            Livingstatus + Anxiety + MoodDisord + Chronicconditions + PASE_TOTALbaseline + RVLT_Delayed_Normedbaseline +
                            (1|ID), data= truncated.data_long_2)
summary(modelRVLT_del_adj10trun)
```

#### 16.4.2.2) Estimated marginal means
```{r}
lsmeans(modelRVLT_del_adj10trun, ~Pandemic|timefactor)
contrast(lsmeans(modelRVLT_del_adj10trun, ~Pandemic|timefactor), "pairwise", adj="none")
confint(contrast(lsmeans(modelRVLT_del_adj10trun, ~Pandemic|timefactor), "pairwise", adj="none"), parm, level = 0.95)
```

#### 16.4.2.3) Graph of estimated marginal means
```{r}
RVLTdelayed_lsmeans_adj10trun <- summary(lsmeans(modelRVLT_del_adj10trun, ~timefactor|Pandemic))
RVLTdelayed_lsmeans_adj10trun$Time<-NA
RVLTdelayed_lsmeans_adj10trun$Time[RVLTdelayed_lsmeans_adj10trun$timefactor==1]<-"Follow-up 1"
RVLTdelayed_lsmeans_adj10trun$Time[RVLTdelayed_lsmeans_adj10trun$timefactor==2]<-"Follow-up 2"
ggplot(RVLTdelayed_lsmeans_adj10trun, aes(x = Time, y = lsmean, fill = Pandemic)) +
  geom_bar(stat="identity", position=position_dodge()) + 
  labs(x = "Time", y = "RVLT Delayed Normalized Score", title = "RVLT Delayed Normalized Score from FU1 to FU2 by Pandemic status 
       (controlling for baseline)") +
  theme_bw()
```




### 16.4.3) Mental Alteration Test

#### 16.4.3.1) Model
```{r}
modelMAT_adj10trun<- lmer(MAT_Normed~ timefactor*Pandemic + Age + Sex + Education + Ethnicity + IncomeLevel + BMI + CESD.10baseline + SmokingStatus + Relationshipstatus + 
                            Livingstatus + Anxiety + MoodDisord + Chronicconditions + PASE_TOTALbaseline + MAT_Normedbaseline +
                      (1|ID), data= truncated.data_long_2)
summary(modelMAT_adj10trun)
```

#### 16.4.3.2) Estimated marginal means
```{r}
lsmeans(modelMAT_adj10trun, ~Pandemic|timefactor)
contrast(lsmeans(modelMAT_adj10trun, ~Pandemic|timefactor), "pairwise", adj="none")
confint(contrast(lsmeans(modelMAT_adj10trun, ~Pandemic|timefactor), "pairwise", adj="none"), parm, level = 0.95)
```

#### 16.4.3.3) Graph of estimated marginal means
```{r}
MAT_lsmeans_adj10trun <- summary(lsmeans(modelMAT_adj10trun, ~Pandemic|timefactor))
MAT_lsmeans_adj10trun$Time<-NA
MAT_lsmeans_adj10trun$Time[MAT_lsmeans_adj10trun$timefactor==1]<-"Follow-up 1"
MAT_lsmeans_adj10trun$Time[MAT_lsmeans_adj10trun$timefactor==2]<-"Follow-up 2"
ggplot(MAT_lsmeans_adj10trun, aes(x = Time, y = lsmean, fill = Pandemic)) +
  geom_bar(stat="identity", position=position_dodge()) + 
  labs(x = "Time", y = "MAT Normalized Score", title = "Mental Alteration Test Normalized Score from FU1 to FU2 by Pandemic status 
       (controlling for baseline)") +
  theme_bw()
```




### 16.4.4) Animal Fluency

#### 16.4.4.1) Model
```{r}
modelAnimals_adj10trun<- lmer(Animal_Fluency_Normed ~ timefactor*Pandemic + Age + Sex + Education + Ethnicity + IncomeLevel + BMI + CESD.10baseline + SmokingStatus + Relationshipstatus + 
                            Livingstatus + Anxiety + MoodDisord + Chronicconditions + PASE_TOTALbaseline + Animal_Fluency_Normedbaseline +
                           (1|ID), data= truncated.data_long_2)
summary(modelAnimals_adj10trun)
```

#### 16.4.4.2) Estimated marginal means
```{r}
lsmeans(modelAnimals_adj10trun, ~Pandemic|timefactor)
contrast(lsmeans(modelAnimals_adj10trun, ~Pandemic|timefactor), "pairwise", adj="none")
confint(contrast(lsmeans(modelAnimals_adj10trun, ~Pandemic|timefactor), "pairwise", adj="none"), parm, level = 0.95)
```

#### 16.4.4.3) Graph of estimated marginal means
```{r}
Animals_lsmeans_adj10trun <- summary(lsmeans(modelAnimals_adj10trun, ~timefactor|Pandemic))
Animals_lsmeans_adj10trun$Time<-NA
Animals_lsmeans_adj10trun$Time[Animals_lsmeans_adj10trun$timefactor==1]<-"Follow-up 1"
Animals_lsmeans_adj10trun$Time[Animals_lsmeans_adj10trun$timefactor==2]<-"Follow-up 2"
ggplot(Animals_lsmeans_adj10trun, aes(x = Time, y = lsmean, fill = Pandemic)) +
  geom_bar(stat="identity", position=position_dodge()) + 
  labs(x = "Time", y = "Animal Fluency Normalized Score", title = "Animal Fluency Normalized Score from FU1 to FU2 by Pandemic status
       (controlling for baseline)") +
  theme_bw()
```

## 16.5) Age and Sex Differences (not adjusted for baseline)

### 16.5.1) RVLT Immediate Recall

#### 16.5.1.1) Model
```{r}
modelRVLT_imm_11<- lmer(RVLT_Immediate_Normed~ timefactor*Pandemic*Age_sex + Education + Ethnicity + IncomeLevel + BMI + CESD.20.1 + SmokingStatus + 
                         Relationshipstatus + Livingstatus + Anxiety + MoodDisord + Chronicconditions + PASE_TOTALbaseline +
                         (1|ID), data= truncated.data_long)
summary(modelRVLT_imm_11)
```

#### 16.5.1.2) Estimated marginal means
```{r}
lsmeans(modelRVLT_imm_11, ~Pandemic|timefactor|Age_sex)
contrast(lsmeans(modelRVLT_imm_11, ~Pandemic|timefactor|Age_sex), "pairwise", adj="none")
confint(contrast(lsmeans(modelRVLT_imm_11, ~Pandemic|timefactor|Age_sex), "pairwise", adj="none"), parm, level = 0.95)
```

#### 16.5.1.3) Graph of estimated marginal means
```{r}
RVLTimmediate_lsmeans_11 <- summary(lsmeans(modelRVLT_imm_11, ~timefactor|Pandemic|Age_sex))
RVLTimmediate_lsmeans_11$Time<-NA
RVLTimmediate_lsmeans_11$Time[RVLTimmediate_lsmeans_11$timefactor==1]<-"Baseline"
RVLTimmediate_lsmeans_11$Time[RVLTimmediate_lsmeans_11$timefactor==2]<-"Follow-up 1"
RVLTimmediate_lsmeans_11$Time[RVLTimmediate_lsmeans_11$timefactor==3]<-"Follow-up 2"
ggplot(RVLTimmediate_lsmeans_11, aes(x = Time, y = lsmean, group=Pandemic)) +
  geom_line(aes(linetype = Pandemic)) + facet_wrap(~Age_sex, scales = "free") +
  geom_errorbar(aes(ymin = asymp.LCL, ymax = asymp.UCL), width = 0.2) +
  geom_point(aes(y = lsmean), size = 3, shape = 21, fill = "white") +
  labs(x = "Time", y = "RVLT Immediate Score", title = "RVLT Immediate Score from Baseline to FU2 by Pandemic status") +
  theme_bw()
```


### 16.5.2) RVLT Delayed Recall

#### 16.5.2.1) Model
```{r}
modelRVLT_del_11<- lmer(RVLT_Delayed_Normed ~ timefactor*Pandemic*Age_sex + Education + Ethnicity + IncomeLevel + BMI + CESD.20.1 + SmokingStatus + 
                         Relationshipstatus + Livingstatus + Anxiety + MoodDisord + Chronicconditions + PASE_TOTALbaseline +
                        (1|ID), data= truncated.data_long)
summary(modelRVLT_del_11)
```

#### 16.5.2.2) Estimated marginal means
```{r}
lsmeans(modelRVLT_del_11, ~Pandemic|timefactor|Age_sex)
contrast(lsmeans(modelRVLT_del_11, ~Pandemic|timefactor|Age_sex), "pairwise", adj="none")
confint(contrast(lsmeans(modelRVLT_del_11, ~Pandemic|timefactor|Age_sex), "pairwise", adj="none"), parm, level = 0.95)
```

#### 16.5.2.3) Graph of estimated marginal means
```{r}
RVLTdelayed_lsmeans_11 <- summary(lsmeans(modelRVLT_del_11, ~timefactor|Pandemic|Age_sex))
RVLTdelayed_lsmeans_11$Time<-NA
RVLTdelayed_lsmeans_11$Time[RVLTdelayed_lsmeans_11$timefactor==1]<-"Baseline"
RVLTdelayed_lsmeans_11$Time[RVLTdelayed_lsmeans_11$timefactor==2]<-"Follow-up 1"
RVLTdelayed_lsmeans_11$Time[RVLTdelayed_lsmeans_11$timefactor==3]<-"Follow-up 2"
ggplot(RVLTdelayed_lsmeans_11, aes(x = Time, y = lsmean, group=Pandemic)) +
  geom_line(aes(linetype = Pandemic)) + facet_wrap(~Age_sex, scales = "free") +
  geom_errorbar(aes(ymin = asymp.LCL, ymax = asymp.UCL), width = 0.2) +
  geom_point(aes(y = lsmean), size = 3, shape = 21, fill = "white") +
  labs(x = "Time", y = "RVLT Delayed Score", title = "RVLT Delayed Score from Baseline to FU2 by Pandemic status") +
  theme_bw()
```



### 16.5.3) Mental Alteration Test

#### 16.5.3.1) Model
```{r}
modelMAT_11<- lmer(MAT_Normed ~ timefactor*Pandemic*Age_sex + Education + Ethnicity + IncomeLevel + BMI + CESD.20.1 + SmokingStatus + 
                         Relationshipstatus + Livingstatus + Anxiety + MoodDisord + Chronicconditions + PASE_TOTALbaseline +
                    (1|ID), data= truncated.data_long)
summary(modelMAT_11)
```

#### 16.5.3.2) Estimated marginal means
```{r}
lsmeans(modelMAT_11, ~Pandemic|timefactor|Age_sex)
contrast(lsmeans(modelMAT_11, ~Pandemic|timefactor|Age_sex), "pairwise", adj="none")
confint(contrast(lsmeans(modelMAT_11, ~Pandemic|timefactor|Age_sex), "pairwise", adj="none"), parm, level = 0.95)
```

#### 16.5.3.3) Graph of estimated marginal means
```{r}
MAT_lsmeans_11 <- summary(lsmeans(modelMAT_11, ~timefactor|Pandemic|Age_sex))
MAT_lsmeans_11$Time<-NA
MAT_lsmeans_11$Time[MAT_lsmeans_11$timefactor==1]<-"Baseline"
MAT_lsmeans_11$Time[MAT_lsmeans_11$timefactor==2]<-"Follow-up 1"
MAT_lsmeans_11$Time[MAT_lsmeans_11$timefactor==3]<-"Follow-up 2"
ggplot(MAT_lsmeans_11, aes(x = Time, y = lsmean, group=Pandemic)) +
  geom_line(aes(linetype = Pandemic)) + facet_wrap(~Age_sex, scales = "free") +
  geom_errorbar(aes(ymin = asymp.LCL, ymax = asymp.UCL), width = 0.2) +
  geom_point(aes(y = lsmean), size = 3, shape = 21, fill = "white") +
  labs(x = "Time", y = "MAT Score", title = "Mental Alteration Test Score from Baseline to FU2 by Pandemic status") +
  theme_bw()
```

### 16.5.4) Animal Fluency

#### 16.5.4.1) Model
```{r}
modelAnimals_11<- lmer(Animal_Fluency_Normed ~ timefactor*Pandemic*Age_sex + Education + Ethnicity + IncomeLevel + BMI + CESD.20.1 + SmokingStatus + 
                         Relationshipstatus + Livingstatus + Anxiety + MoodDisord + Chronicconditions + PASE_TOTALbaseline +
                        (1|ID), data= truncated.data_long)
summary(modelAnimals_11)
```

#### 16.5.4.2) Estimated marginal means
Significant differences for females 45-64 and 65+ and significant differences males 65+
```{r}
lsmeans(modelAnimals_11, ~Pandemic|timefactor|Age_sex)
contrast(lsmeans(modelAnimals_11, ~Pandemic|timefactor|Age_sex), "pairwise", adj="none")
confint(contrast(lsmeans(modelAnimals_11, ~Pandemic|timefactor|Age_sex), "pairwise", adj="none"), parm, level = 0.95)
```

#### 16.5.4.3) Graph of estimated marginal means
```{r}
Animals_lsmeans_11 <- summary(lsmeans(modelAnimals_11, ~timefactor|Pandemic|Age_sex))
Animals_lsmeans_11$Time<-NA
Animals_lsmeans_11$Time[Animals_lsmeans_11$timefactor==1]<-"Baseline"
Animals_lsmeans_11$Time[Animals_lsmeans_11$timefactor==2]<-"Follow-up 1"
Animals_lsmeans_11$Time[Animals_lsmeans_11$timefactor==3]<-"Follow-up 2"
ggplot(Animals_lsmeans_11, aes(x = Time, y = lsmean, group=Pandemic)) +
  geom_line(aes(linetype = Pandemic)) + facet_wrap(~Age_sex, scales = "free") +
  geom_errorbar(aes(ymin = asymp.LCL, ymax = asymp.UCL), width = 0.2) +
  geom_point(aes(y = lsmean), size = 3, shape = 21, fill = "white") +
  labs(x = "Time", y = "Animal Fluency (words)", title = "Animal Fluency Score from Baseline to FU2 by Pandemic status") +
  theme_bw()
```




## 16.6) Age and sex differences in time x pandemic effects on cognitive functon ( adjusting for baseline)

All models use normalized cognitive scores. Each model is adjusted for education, ethnicity, income level, baseline BMI, baseline CESD-10 score, smoking status, relationship status at baseline, living status at baseline, diagnosis of anxiety or mood disorder at baseline, number of chronic conditions at baseline, baseline PASE score, and baseline cognitive performance

### 16.6.1) RVLT Immediate Recall

#### 16.6.1.1) Model
```{r}
modelRVLT_imm_adj11<- lmer(RVLT_Immediate_Normed~ timefactor*Pandemic*Age_sex + Education + Ethnicity + IncomeLevel + BMI + CESD.10baseline + SmokingStatus + Relationshipstatus + 
                            Livingstatus + Anxiety + MoodDisord + Chronicconditions + PASE_TOTALbaseline + RVLT_Immediate_Normedbaseline +
                            (1|ID), data= truncated.data_long_2)
summary(modelRVLT_imm_adj11)
```

#### 16.6.1.2) Estimated marginal means

Significantly lower RVLT immediate for males 65+
```{r}
lsmeans(modelRVLT_imm_adj11, ~Pandemic|timefactor|Age_sex)
contrast(lsmeans(modelRVLT_imm_adj11, ~Pandemic|timefactor|Age_sex), "pairwise", adj="none")
confint(contrast(lsmeans(modelRVLT_imm_adj11, ~Pandemic|timefactor|Age_sex), "pairwise", adj="none"), parm, level = 0.95)
```

#### 16.6.1.3) Graph of estimated marginal means
```{r}
RVLTimmediate_lsmeans_adj11 <- summary(lsmeans(modelRVLT_imm_adj11, ~timefactor|Pandemic|Age_sex))
RVLTimmediate_lsmeans_adj11$Time<-NA
RVLTimmediate_lsmeans_adj11$Time[RVLTimmediate_lsmeans_adj11$timefactor==1]<-"Follow-up 1"
RVLTimmediate_lsmeans_adj11$Time[RVLTimmediate_lsmeans_adj11$timefactor==2]<-"Follow-up 2"
ggplot(RVLTimmediate_lsmeans_adj11, aes(x = Time, y = lsmean, fill = Pandemic)) +
  geom_bar(stat="identity", position=position_dodge()) + facet_wrap(~Age_sex, scales = "free") +
  labs(x = "Time", y = "RVLT Immediate Normalized Score", title = "RVLT Immediate Normalized Score from FU1 to FU2 by Pandemic status
       (controlling for baseline)") +
  theme_bw()
```


### 16.6.2) RVLT Delayed Recall

#### 16.6.2.1) Model
```{r}
modelRVLT_del_adj11<- lmer(RVLT_Delayed_Normed~ timefactor*Pandemic*Age_sex + Education + Ethnicity + IncomeLevel + BMI + CESD.10baseline + SmokingStatus + Relationshipstatus + 
                            Livingstatus + Anxiety + MoodDisord + Chronicconditions + PASE_TOTALbaseline + RVLT_Delayed_Normedbaseline +
                            (1|ID), data= truncated.data_long_2)
summary(modelRVLT_del_adj11)
```

#### 16.6.2.2) Estimated marginal means
```{r}
lsmeans(modelRVLT_del_adj11, ~Pandemic|timefactor|Age_sex)
contrast(lsmeans(modelRVLT_del_adj11, ~Pandemic|timefactor|Age_sex), "pairwise", adj="none")
confint(contrast(lsmeans(modelRVLT_del_adj11, ~Pandemic|timefactor|Age_sex), "pairwise", adj="none"), parm, level = 0.95)
```

#### 16.6.2.3) Graph of estimated marginal means
```{r}
RVLTdelayed_lsmeans_adj11 <- summary(lsmeans(modelRVLT_del_adj11, ~timefactor|Pandemic|Age_sex))
RVLTdelayed_lsmeans_adj11$Time<-NA
RVLTdelayed_lsmeans_adj11$Time[RVLTdelayed_lsmeans_adj11$timefactor==1]<-"Follow-up 1"
RVLTdelayed_lsmeans_adj11$Time[RVLTdelayed_lsmeans_adj11$timefactor==2]<-"Follow-up 2"
ggplot(RVLTdelayed_lsmeans_adj11, aes(x = Time, y = lsmean, fill = Pandemic)) +
  geom_bar(stat="identity", position=position_dodge()) + facet_wrap(~Age_sex, scales = "free") +
  labs(x = "Time", y = "RVLT Delayed Normalized Score", title = "RVLT Delayed Normalized Score from FU1 to FU2 by Pandemic status
       (controlling for baseline)") +
  theme_bw()
```



### 16.6.3) Mental Alteration Test

#### 16.6.3.1) Model
```{r}
modelMAT_adj11<- lmer(MAT_Normed~ timefactor*Pandemic*Age_sex + Education + Ethnicity + IncomeLevel + BMI + CESD.10baseline + SmokingStatus + Relationshipstatus + 
                            Livingstatus + Anxiety + MoodDisord + Chronicconditions + PASE_TOTALbaseline + MAT_Normedbaseline +
                      (1|ID), data= truncated.data_long_2)
summary(modelMAT_adj11)
```

#### 16.6.3.2) Estimated marginal means
```{r}
lsmeans(modelMAT_adj11, ~Pandemic|timefactor|Age_sex)
contrast(lsmeans(modelMAT_adj11, ~Pandemic|timefactor|Age_sex), "pairwise", adj="none")
confint(contrast(lsmeans(modelMAT_adj11, ~Pandemic|timefactor|Age_sex), "pairwise", adj="none"), parm, level = 0.95)
```

#### 16.6.3.3) Graph of estimated marginal means
```{r}
MAT_lsmeans_adj11 <- summary(lsmeans(modelMAT_adj11, ~Pandemic|timefactor|Age_sex))
MAT_lsmeans_adj11$Time<-NA
MAT_lsmeans_adj11$Time[MAT_lsmeans_adj11$timefactor==1]<-"Follow-up 1"
MAT_lsmeans_adj11$Time[MAT_lsmeans_adj11$timefactor==2]<-"Follow-up 2"
ggplot(MAT_lsmeans_adj11, aes(x = Time, y = lsmean, fill = Pandemic)) +
  geom_bar(stat="identity", position=position_dodge()) + facet_wrap(~Age_sex, scales = "free") +
  labs(x = "Time", y = "MAT Normalized Score", title = "Mental Alteration Test Normalized Score from FU1 to FU2 by Pandemic status
       (controlling for baseline)") +
  theme_bw()
```



### 16.6.4) Animal Fluency

#### 16.6.4.1) Model
```{r}
modelAnimals_adj11<- lmer(Animal_Fluency_Normed ~ timefactor*Pandemic*Age_sex + Education + Ethnicity + IncomeLevel + BMI + CESD.10baseline + SmokingStatus + Relationshipstatus + 
                            Livingstatus + Anxiety + MoodDisord + Chronicconditions + PASE_TOTALbaseline + Animal_Fluency_Normedbaseline +
                           (1|ID), data= truncated.data_long_2)
summary(modelAnimals_adj11)
```

#### 16.6.4.2) Estimated marginal means
```{r}
lsmeans(modelAnimals_adj11, ~Pandemic|timefactor|Age_sex)
contrast(lsmeans(modelAnimals_adj11, ~Pandemic|timefactor|Age_sex), "pairwise", adj="none")
confint(contrast(lsmeans(modelAnimals_adj11, ~Pandemic|timefactor|Age_sex), "pairwise", adj="none"), parm, level = 0.95)
```

#### 16.6.4.3) Graph of estimated marginal means
```{r}
Animals_lsmeans_adj11 <- summary(lsmeans(modelAnimals_adj11, ~timefactor|Pandemic|Age_sex))
Animals_lsmeans_adj11$Time<-NA
Animals_lsmeans_adj11$Time[Animals_lsmeans_adj11$timefactor==1]<-"Follow-up 1"
Animals_lsmeans_adj11$Time[Animals_lsmeans_adj11$timefactor==2]<-"Follow-up 2"
ggplot(Animals_lsmeans_adj11, aes(x = Time, y = lsmean, fill = Pandemic)) +
  geom_bar(stat="identity", position=position_dodge()) + facet_wrap(~Age_sex, scales = "free") +
  labs(x = "Time", y = "Animal Fluency Normalized Score", title = "Animal Fluency Normalized Score from FU1 to FU2 by Pandemic status
       (controlling for baseline)") +
  theme_bw()
```




## 16.7) Physical Activity Results

### 16.7.1) Full model unadjusted for baseline

#### 16.7.1.1) Model
```{r}
modelPASE_5<- lmer(PASE_TOTAL~ timefactor*Pandemic + Age + Sex + Education + Ethnicity + IncomeLevel + BMI + CESD.20.1 + SmokingStatus + 
                         Relationshipstatus + Livingstatus + Anxiety + MoodDisord + Chronicconditions +
                         (1|ID), data= truncated.data_long)
summary(modelPASE_5)
```

#### 16.7.1.2) Estimated marginal means
```{r}
lsmeans(modelPASE_5, ~Pandemic|timefactor)
contrast(lsmeans(modelPASE_5, ~Pandemic|timefactor), "pairwise", adj="none")
confint(contrast(lsmeans(modelPASE_5, ~Pandemic|timefactor), "pairwise", adj="none"), parm, level = 0.95)
```

#### 16.7.1.3) Graph of estimated marginal means
```{r}
PASE_lsmeans_5 <- summary(lsmeans(modelPASE_5, ~timefactor|Pandemic))
PASE_lsmeans_5$Time<-NA
PASE_lsmeans_5$Time[PASE_lsmeans_5$timefactor==1]<-"Baseline"
PASE_lsmeans_5$Time[PASE_lsmeans_5$timefactor==2]<-"Follow-up 1"
PASE_lsmeans_5$Time[PASE_lsmeans_5$timefactor==3]<-"Follow-up 2"
ggplot(PASE_lsmeans_5, aes(x = Time, y = lsmean, group=Pandemic)) +
  geom_line(aes(linetype = Pandemic)) + 
  geom_errorbar(aes(ymin = asymp.LCL, ymax = asymp.UCL), width = 0.2) +
  geom_point(aes(y = lsmean), size = 3, shape = 21, fill = "white") +
  labs(x = "Time", y = "PASE Total Score", title = "PASE Total Score from Baseline to FU2 by Pandemic status") +
  theme_bw()
```


### 16.7.2) Full model adjusted for baseline

#### 16.7.2.1) Model
```{r}
modelPASE_6<- lmer(PASE_TOTAL ~ timefactor*Pandemic + Age + Sex + Education + Ethnicity + IncomeLevel + BMI + CESD.10baseline + SmokingStatus + 
                         Relationshipstatus + Livingstatus + Anxiety + MoodDisord + Chronicconditions + PASE_TOTALbaseline +
                        (1|ID), data= truncated.data_long_2)
summary(modelPASE_6)
```

#### 16.7.2.2) Estimated marginal means
```{r}
lsmeans(modelPASE_6, ~Pandemic|timefactor)
contrast(lsmeans(modelPASE_6, ~Pandemic|timefactor), "pairwise", adj="none")
confint(contrast(lsmeans(modelPASE_6, ~Pandemic|timefactor), "pairwise", adj="none"), parm, level = 0.95)
```

#### 16.7.2.3) Graph of estimated marginal means
```{r}
PASE_lsmeans_6 <- summary(lsmeans(modelPASE_6, ~timefactor|Pandemic))
PASE_lsmeans_6$Time<-NA
PASE_lsmeans_6$Time[PASE_lsmeans_6$timefactor==1]<-"Follow-up 1"
PASE_lsmeans_6$Time[PASE_lsmeans_6$timefactor==2]<-"Follow-up 2"
ggplot(PASE_lsmeans_6, aes(x = Time, y = lsmean, fill = Pandemic)) +
  geom_bar(stat="identity", position=position_dodge()) + 
  labs(x = "Time", y = "PASE Total Score", title = "PASE Total Score from FU1 to FU2 by Pandemic status
       (controlling for baseline)") +
  theme_bw()
```



### 16.7.3) Full model unadjusted for baseline (age and sex differences)

#### 16.7.3.1) Model
```{r}
modelPASE_7<- lmer(PASE_TOTAL ~ timefactor*Pandemic*Age_sex + Education + Ethnicity + IncomeLevel + BMI + CESD.20.1 + SmokingStatus + 
                         Relationshipstatus + Livingstatus + Anxiety + MoodDisord + Chronicconditions +
                    (1|ID), data= truncated.data_long)
summary(modelPASE_7)
```

#### 16.7.3.2) Estimated marginal means
```{r}
lsmeans(modelPASE_7, ~Pandemic|timefactor|Age_sex)
contrast(lsmeans(modelPASE_7, ~Pandemic|timefactor|Age_sex), "pairwise", adj="none")
confint(contrast(lsmeans(modelPASE_7, ~Pandemic|timefactor|Age_sex), "pairwise", adj="none"), parm, level = 0.95)
```

#### 16.7.3.3) Graph of estimated marginal means
```{r}
PASE_lsmeans_7 <- summary(lsmeans(modelPASE_7, ~timefactor|Pandemic|Age_sex))
PASE_lsmeans_7$Time<-NA
PASE_lsmeans_7$Time[PASE_lsmeans_7$timefactor==1]<-"Baseline"
PASE_lsmeans_7$Time[PASE_lsmeans_7$timefactor==2]<-"Follow-up 1"
PASE_lsmeans_7$Time[PASE_lsmeans_7$timefactor==3]<-"Follow-up 2"
ggplot(PASE_lsmeans_7, aes(x = Time, y = lsmean, group=Pandemic)) +
  geom_line(aes(linetype = Pandemic)) + facet_wrap(~Age_sex, scales = "free") +
  geom_errorbar(aes(ymin = asymp.LCL, ymax = asymp.UCL), width = 0.2) +
  geom_point(aes(y = lsmean), size = 3, shape = 21, fill = "white") +
  labs(x = "Time", y = "MAT Score", title = "PASE Total Score from Baseline to FU2 by Pandemic status") +
  theme_bw()
```

### 16.7.4) Full model adjusted for baseline (age and sex differences)

#### 16.7.4.1) Model
```{r}
modelPASE_8<- lmer(PASE_TOTAL ~ timefactor*Pandemic*Age_sex + Education + Ethnicity + IncomeLevel + BMI + CESD.10baseline + SmokingStatus + 
                         Relationshipstatus + Livingstatus + Anxiety + MoodDisord + Chronicconditions + PASE_TOTALbaseline +
                        (1|ID), data= truncated.data_long_2)
summary(modelPASE_8)
```

#### 16.7.4.2) Estimated marginal means
```{r}
lsmeans(modelPASE_8, ~Pandemic|timefactor|Age_sex)
contrast(lsmeans(modelPASE_8, ~Pandemic|timefactor|Age_sex), "pairwise", adj="none")
confint(contrast(lsmeans(modelPASE_8, ~Pandemic|timefactor|Age_sex), "pairwise", adj="none"), parm, level = 0.95)
```

#### 16.7.4.3) Graph of estimated marginal means
```{r}
PASE_lsmeans_8 <- summary(lsmeans(modelPASE_8, ~timefactor|Pandemic|Age_sex))
PASE_lsmeans_8$Time<-NA
PASE_lsmeans_8$Time[PASE_lsmeans_8$timefactor==1]<-"Follow-up 1"
PASE_lsmeans_8$Time[PASE_lsmeans_8$timefactor==2]<-"Follow-up 2"
ggplot(PASE_lsmeans_8, aes(x = Time, y = lsmean, fill = Pandemic)) +
  geom_bar(stat="identity", position=position_dodge()) + facet_wrap(~Age_sex, scales = "free") +
  labs(x = "Time", y = "PASE Total Score", title = "PASE Total Score from FU1 to FU2 by Pandemic status
       (controlling for baseline)") +
  theme_bw()
```




## 16.8) Sedentary behaviour Results

### 16.8.1) Full model adjusted for baseline

Create binary variable for 4+ hrs/day of SB
```{r}
truncated.data_long_2$SB.binary <- as.factor(ifelse(truncated.data_long_2$PASE_Sit==10, 1, 0))
truncated.data_long_2$SBbaseline.binary <- as.factor(ifelse(truncated.data_long_2$PASE_Sitbaseline==10, 1, 0))
```

#### 16.8.1.1) Model
```{r}
sit3 <- glmer(
  SB.binary ~ timefactor*Pandemic + Age + Sex + SBbaseline.binary + Education + Ethnicity + IncomeLevel + BMI + CESD.10baseline + SmokingStatus + 
    Relationshipstatus + Livingstatus + Anxiety + MoodDisord + Chronicconditions + 
    (1|ID), 
  data = truncated.data_long_2, 
  family = binomial(link = "logit")
)

sit3
```

#### 16.8.1.2) Predicted probabilities

```{r}
ggpredict(sit3, c("timefactor", "Pandemic"))
```

#### 16.8.1.3) Contrasts for predicted probilities

Mean Differences and 95% CIs
```{r}
sit3.test <- as.data.frame(ggpredict(sit3, c("timefactor", "Pandemic")))

mean.diff.5<-(subset(sit3.test,x==1 & group == "FU2 data collected after COVID-19")$predicted - 
         subset(sit3.test,x==1 & group == "FU2 data collected before COVID-19")$predicted)
         
se.5<-(sqrt(((subset(sit3.test,x==1 & group == "FU2 data collected after COVID-19")$std.error)^2 +
         (subset(sit3.test,x==1 & group == "FU2 data collected before COVID-19")$std.error^2))/2))

UL.5<-mean.diff.5 + se.5*1.96
LL.5<-mean.diff.5 - se.5*1.96

         
mean.diff.6<-(subset(sit3.test,x==2 & group == "FU2 data collected after COVID-19")$predicted - 
         subset(sit3.test,x==2 & group == "FU2 data collected before COVID-19")$predicted)
         
se.6<-(sqrt(((subset(sit3.test,x==2 & group == "FU2 data collected after COVID-19")$std.error)^2 +
         (subset(sit3.test,x==2 & group == "FU2 data collected before COVID-19")$std.error^2))/2))

UL.6<-mean.diff.6 + se.6*1.96
LL.6<-mean.diff.6 - se.6*1.96

#Mean differences and LL and UL
mean.diff.5
UL.5
LL.5

mean.diff.6
UL.6
LL.6
```

Z-Scores
```{r}
sit3.test <- as.data.frame(ggpredict(sit3, c("timefactor", "Pandemic")))

z.5<- (subset(sit3.test,x==1 & group == "FU2 data collected after COVID-19")$predicted - 
         subset(sit3.test,x==1 & group == "FU2 data collected before COVID-19")$predicted) / (sqrt(((subset(sit3.test,x==1 & group == "FU2 data collected after COVID-19")$std.error)^2 +
     (subset(sit3.test,x==1 & group == "FU2 data collected before COVID-19")$std.error^2))/2))
     
z.6<- (subset(sit3.test,x==2 & group == "FU2 data collected after COVID-19")$predicted - 
         subset(sit3.test,x==2 & group == "FU2 data collected before COVID-19")$predicted) / (sqrt(((subset(sit3.test,x==2 & group == "FU2 data collected after COVID-19")$std.error)^2 +
         (subset(sit3.test,x==2 & group == "FU2 data collected before COVID-19")$std.error^2))/2))

#z-scores
z.5
z.6
```

p-values for z-scores
```{r}
2*pnorm(z.5, mean = 0, sd = 1, lower.tail = FALSE)
2*pnorm(z.6, mean = 0, sd = 1, lower.tail = FALSE)
```

#### 16.8.1.4) Graph of predicted probabilities
```{r}
ggpredict(sit3, c("timefactor", "Pandemic")) %>% plot()
```


### 16.8.2) Full model adjusted for baseline (age and sex differences)

#### 16.8.2.1) Model
```{r}
sit4 <- glmer(
  SB.binary ~ timefactor*Pandemic*Age_sex + SBbaseline.binary + Education + Ethnicity + IncomeLevel + BMI + CESD.10baseline + SmokingStatus + 
    Relationshipstatus + Livingstatus + Anxiety + MoodDisord + Chronicconditions + 
    (1|ID), 
  data = truncated.data_long_2, 
  family = binomial(link = "logit")
)

sit2
```

#### 16.8.2.2) Predicted probabilities

```{r}
ggpredict(sit4, c("Pandemic","timefactor","Age_sex"))
```

#### 16.8.2.3) Contrasts for predicted probilities

Mean differences and 95% CIs
```{r}
sit.test4 <- as.data.frame(ggpredict(sit4, c("timefactor", "Pandemic", "Age_sex")))

#Females 45-64 years
mean.diff.Females.Young.5<-(subset(sit.test4,x==1 & group == "FU2 data collected after COVID-19" & facet == "Females 45-64")$predicted - 
         subset(sit.test4,x==1 & group == "FU2 data collected before COVID-19" & facet == "Females 45-64")$predicted)
         
se.Females.Young.5<-(sqrt(((subset(sit.test4,x==1 & group == "FU2 data collected after COVID-19" & facet == "Females 45-64")$std.error)^2 +
     (subset(sit.test4,x==1 & group == "FU2 data collected before COVID-19" & facet == "Females 45-64")$std.error^2))/2))

UL.Females.Young.5<-mean.diff.Females.Young.5 + se.Females.Young.5*1.96
LL.Females.Young.5<-mean.diff.Females.Young.5 - se.Females.Young.5*1.96

mean.diff.Females.Young.6<-(subset(sit.test4,x==2 & group == "FU2 data collected after COVID-19" & facet == "Females 45-64")$predicted - 
         subset(sit.test4,x==2 & group == "FU2 data collected before COVID-19" & facet == "Females 45-64")$predicted)
         
se.Females.Young.6<-(sqrt(((subset(sit.test4,x==2 & group == "FU2 data collected after COVID-19" & facet == "Females 45-64")$std.error)^2 +
     (subset(sit.test4,x==2 & group == "FU2 data collected before COVID-19" & facet == "Females 45-64")$std.error^2))/2))

UL.Females.Young.6<-mean.diff.Females.Young.6 + se.Females.Young.6*1.96
LL.Females.Young.6<-mean.diff.Females.Young.6 - se.Females.Young.6*1.96

#Females 65+ years
mean.diff.Females.Old.5<-(subset(sit.test4,x==1 & group == "FU2 data collected after COVID-19" & facet == "Females 65+")$predicted - 
         subset(sit.test4,x==1 & group == "FU2 data collected before COVID-19" & facet == "Females 65+")$predicted)
         
se.Females.Old.5<-(sqrt(((subset(sit.test4,x==1 & group == "FU2 data collected after COVID-19" & facet == "Females 65+")$std.error)^2 +
     (subset(sit.test4,x==1 & group == "FU2 data collected before COVID-19" & facet == "Females 65+")$std.error^2))/2))

UL.Females.Old.5<-mean.diff.Females.Old.5 + se.Females.Old.5*1.96
LL.Females.Old.5<-mean.diff.Females.Old.5 - se.Females.Old.5*1.96

mean.diff.Females.Old.6<-(subset(sit.test4,x==2 & group == "FU2 data collected after COVID-19" & facet == "Females 65+")$predicted - 
         subset(sit.test4,x==2 & group == "FU2 data collected before COVID-19" & facet == "Females 65+")$predicted)
         
se.Females.Old.6<-(sqrt(((subset(sit.test4,x==2 & group == "FU2 data collected after COVID-19" & facet == "Females 65+")$std.error)^2 +
     (subset(sit.test4,x==2 & group == "FU2 data collected before COVID-19" & facet == "Females 65+")$std.error^2))/2))

UL.Females.Old.6<-mean.diff.Females.Old.6 + se.Females.Old.6*1.96
LL.Females.Old.6<-mean.diff.Females.Old.6 - se.Females.Old.6*1.96

#Males 45-64 years
mean.diff.Males.Young.5<-(subset(sit.test4,x==1 & group == "FU2 data collected after COVID-19" & facet == "Males 45-64")$predicted - 
         subset(sit.test4,x==1 & group == "FU2 data collected before COVID-19" & facet == "Males 45-64")$predicted)
         
se.Males.Young.5<-(sqrt(((subset(sit.test4,x==1 & group == "FU2 data collected after COVID-19" & facet == "Males 45-64")$std.error)^2 +
     (subset(sit.test4,x==1 & group == "FU2 data collected before COVID-19" & facet == "Males 45-64")$std.error^2))/2))

UL.Males.Young.5<-mean.diff.Males.Young.5 + se.Males.Young.5*1.96
LL.Males.Young.5<-mean.diff.Males.Young.5 - se.Males.Young.5*1.96

mean.diff.Males.Young.6<-(subset(sit.test4,x==2 & group == "FU2 data collected after COVID-19" & facet == "Males 45-64")$predicted - 
         subset(sit.test4,x==2 & group == "FU2 data collected before COVID-19" & facet == "Males 45-64")$predicted)
         
se.Males.Young.6<-(sqrt(((subset(sit.test4,x==2 & group == "FU2 data collected after COVID-19" & facet == "Males 45-64")$std.error)^2 +
     (subset(sit.test4,x==2 & group == "FU2 data collected before COVID-19" & facet == "Males 45-64")$std.error^2))/2))

UL.Males.Young.6<-mean.diff.Males.Young.6 + se.Males.Young.6*1.96
LL.Males.Young.6<-mean.diff.Males.Young.6 - se.Males.Young.6*1.96

#Males 65+ years
mean.diff.Males.Old.5<-(subset(sit.test4,x==1 & group == "FU2 data collected after COVID-19" & facet == "Males 65+")$predicted - 
         subset(sit.test4,x==1 & group == "FU2 data collected before COVID-19" & facet == "Males 65+")$predicted)
         
se.Males.Old.5<-(sqrt(((subset(sit.test4,x==1 & group == "FU2 data collected after COVID-19" & facet == "Males 65+")$std.error)^2 +
     (subset(sit.test4,x==1 & group == "FU2 data collected before COVID-19" & facet == "Males 65+")$std.error^2))/2))

UL.Males.Old.5<-mean.diff.Males.Old.5 + se.Males.Old.5*1.96
LL.Males.Old.5<-mean.diff.Males.Old.5 - se.Males.Old.5*1.96

mean.diff.Males.Old.6<-(subset(sit.test4,x==2 & group == "FU2 data collected after COVID-19" & facet == "Males 65+")$predicted - 
         subset(sit.test4,x==2 & group == "FU2 data collected before COVID-19" & facet == "Males 65+")$predicted)
         
se.Males.Old.6<-(sqrt(((subset(sit.test4,x==2 & group == "FU2 data collected after COVID-19" & facet == "Males 65+")$std.error)^2 +
     (subset(sit.test4,x==2 & group == "FU2 data collected before COVID-19" & facet == "Males 65+")$std.error^2))/2))

UL.Males.Old.6<-mean.diff.Males.Old.6 + se.Males.Old.6*1.96
LL.Males.Old.6<-mean.diff.Males.Old.6 - se.Males.Old.6*1.96



#Mean differences and LL and UL
mean.diff.Females.Young.5
UL.Females.Young.5
LL.Females.Young.5

mean.diff.Females.Young.6
UL.Females.Young.6
LL.Females.Young.6

mean.diff.Females.Old.5
UL.Females.Old.5
LL.Females.Old.5

mean.diff.Females.Old.6
UL.Females.Old.6
LL.Females.Old.6

mean.diff.Males.Young.5
UL.Males.Young.5
LL.Males.Young.5

mean.diff.Males.Young.6
UL.Males.Young.6
LL.Males.Young.6

mean.diff.Males.Old.5
UL.Males.Old.5
LL.Males.Old.5

mean.diff.Males.Old.6
UL.Males.Old.6
LL.Males.Old.6
```

Z-scores
```{r}
z.Females.Young.5 <- (subset(sit.test4,x==1 & group == "FU2 data collected after COVID-19" & facet == "Females 45-64")$predicted - 
         subset(sit.test4,x==1 & group == "FU2 data collected before COVID-19" & facet == "Females 45-64")$predicted) / (sqrt(((subset(sit.test4,x==1 & group == "FU2 data collected after COVID-19" & facet == "Females 45-64")$std.error)^2 +
     (subset(sit.test4,x==1 & group == "FU2 data collected before COVID-19" & facet == "Females 45-64")$std.error^2))/2))
     
z.Females.Young.6 <- (subset(sit.test4,x==2 & group == "FU2 data collected after COVID-19" & facet == "Females 45-64")$predicted - 
         subset(sit.test4,x==2 & group == "FU2 data collected before COVID-19" & facet == "Females 45-64")$predicted) / (sqrt(((subset(sit.test4,x==2 & group == "FU2 data collected after COVID-19" & facet == "Females 45-64")$std.error)^2 +
         (subset(sit.test4,x==2 & group == "FU2 data collected before COVID-19" & facet == "Females 45-64")$std.error^2))/2))

z.Females.Old.5 <- (subset(sit.test4,x==1 & group == "FU2 data collected after COVID-19" & facet == "Females 65+")$predicted - 
         subset(sit.test4,x==1 & group == "FU2 data collected before COVID-19" & facet == "Females 65+")$predicted) / (sqrt(((subset(sit.test4,x==1 & group == "FU2 data collected after COVID-19" & facet == "Females 65+")$std.error)^2 +
     (subset(sit.test4,x==1 & group == "FU2 data collected before COVID-19" & facet == "Females 65+")$std.error^2))/2))
     
z.Females.Old.6 <- (subset(sit.test4,x==2 & group == "FU2 data collected after COVID-19" & facet == "Females 65+")$predicted - 
         subset(sit.test4,x==2 & group == "FU2 data collected before COVID-19" & facet == "Females 65+")$predicted) / (sqrt(((subset(sit.test4,x==2 & group == "FU2 data collected after COVID-19" & facet == "Females 65+")$std.error)^2 +
         (subset(sit.test4,x==2 & group == "FU2 data collected before COVID-19" & facet == "Females 65+")$std.error^2))/2))

z.Males.Young.5 <- (subset(sit.test4,x==1 & group == "FU2 data collected after COVID-19" & facet == "Males 45-64")$predicted - 
         subset(sit.test4,x==1 & group == "FU2 data collected before COVID-19" & facet == "Males 45-64")$predicted) / (sqrt(((subset(sit.test4,x==1 & group == "FU2 data collected after COVID-19" & facet == "Males 45-64")$std.error)^2 +
     (subset(sit.test4,x==1 & group == "FU2 data collected before COVID-19" & facet == "Males 45-64")$std.error^2))/2))
     
z.Males.Young.6 <- (subset(sit.test4,x==2 & group == "FU2 data collected after COVID-19" & facet == "Males 45-64")$predicted - 
         subset(sit.test4,x==2 & group == "FU2 data collected before COVID-19" & facet == "Males 45-64")$predicted) / (sqrt(((subset(sit.test4,x==2 & group == "FU2 data collected after COVID-19" & facet == "Males 45-64")$std.error)^2 +
         (subset(sit.test4,x==2 & group == "FU2 data collected before COVID-19" & facet == "Males 45-64")$std.error^2))/2))

z.Males.Old.5 <- (subset(sit.test4,x==1 & group == "FU2 data collected after COVID-19" & facet == "Males 65+")$predicted - 
         subset(sit.test4,x==1 & group == "FU2 data collected before COVID-19" & facet == "Males 65+")$predicted) / (sqrt(((subset(sit.test4,x==1 & group == "FU2 data collected after COVID-19" & facet == "Males 65+")$std.error)^2 +
     (subset(sit.test4,x==1 & group == "FU2 data collected before COVID-19" & facet == "Males 65+")$std.error^2))/2))
     
z.Males.Old.6 <- (subset(sit.test4,x==2 & group == "FU2 data collected after COVID-19" & facet == "Males 65+")$predicted - 
         subset(sit.test4,x==2 & group == "FU2 data collected before COVID-19" & facet == "Males 65+")$predicted) / (sqrt(((subset(sit.test4,x==2 & group == "FU2 data collected after COVID-19" & facet == "Males 65+")$std.error)^2 +
         (subset(sit.test4,x==2 & group == "FU2 data collected before COVID-19" & facet == "Males 65+")$std.error^2))/2))

#z-scores
z.Females.Young.5
z.Females.Young.6

z.Males.Young.5
z.Males.Young.6

z.Females.Old.5
z.Females.Old.6

z.Males.Old.5
z.Males.Old.6
```

p-values for z-scores
```{r}
2*pnorm(z.Females.Young.5, mean = 0, sd = 1, lower.tail = FALSE)
2*pnorm(z.Females.Young.6, mean = 0, sd = 1, lower.tail = FALSE)

2*pnorm(z.Males.Young.5, mean = 0, sd = 1, lower.tail = FALSE)
2*pnorm(z.Males.Young.6, mean = 0, sd = 1, lower.tail = FALSE)

2*pnorm(z.Females.Old.5, mean = 0, sd = 1, lower.tail = FALSE)
2*pnorm(z.Females.Old.6, mean = 0, sd = 1, lower.tail = FALSE)

2*pnorm(z.Males.Old.5, mean = 0, sd = 1, lower.tail = FALSE)
2*pnorm(z.Males.Old.6, mean = 0, sd = 1, lower.tail = FALSE)
```

#### 16.8.2.4) Graph of predicted probabilities
```{r}
ggpredict(sit4, c("timefactor","Pandemic","Age_sex")) %>% plot()
```


## 16.9) Sleep Results

### 16.9.1) Full model adjusted for baseline

#### 16.9.1.1) Model
```{r}
sleep3 <- glmer(
  RSTLS_Sleep ~ timefactor*Pandemic + Age + Sex + RSTLS_Sleepbaseline + Education + Ethnicity + IncomeLevel + BMI + CESD.10baseline + SmokingStatus + 
    Relationshipstatus + Livingstatus + Anxiety + MoodDisord + Chronicconditions + 
    (1|ID), 
  data = truncated.data_long_2, 
  family = binomial(link = "logit")
)

sleep3
```

#### 16.9.1.2) Predicted probabilities

```{r}
ggpredict(sleep3, c("timefactor", "Pandemic"))
```

#### 16.9.1.3) Contrasts for predicted probilities

Mean Differences and 95% CIs
```{r}
sleep3.test <- as.data.frame(ggpredict(sleep3, c("timefactor", "Pandemic")))

mean.diff.7<-(subset(sleep3.test,x==1 & group == "FU2 data collected after COVID-19")$predicted - 
         subset(sleep3.test,x==1 & group == "FU2 data collected before COVID-19")$predicted)
         
se.7<-(sqrt(((subset(sleep3.test,x==1 & group == "FU2 data collected after COVID-19")$std.error)^2 +
         (subset(sleep3.test,x==1 & group == "FU2 data collected before COVID-19")$std.error^2))/2))

UL.7<-mean.diff.7 + se.7*1.96
LL.7<-mean.diff.7 - se.7*1.96

         
mean.diff.8<-(subset(sleep3.test,x==2 & group == "FU2 data collected after COVID-19")$predicted - 
         subset(sleep3.test,x==2 & group == "FU2 data collected before COVID-19")$predicted)
         
se.8<-(sqrt(((subset(sleep3.test,x==2 & group == "FU2 data collected after COVID-19")$std.error)^2 +
         (subset(sleep3.test,x==2 & group == "FU2 data collected before COVID-19")$std.error^2))/2))

UL.8<-mean.diff.8 + se.6*1.96
LL.8<-mean.diff.8 - se.6*1.96

#Mean differences and LL and UL
mean.diff.7
UL.7
LL.7

mean.diff.8
UL.8
LL.8
```

```{r}
sleep3.test <- as.data.frame(ggpredict(sleep3, c("timefactor", "Pandemic")))

z.7<- (subset(sleep3.test,x==1 & group == "FU2 data collected after COVID-19")$predicted - 
         subset(sleep3.test,x==1 & group == "FU2 data collected before COVID-19")$predicted) / (sqrt(((subset(sleep3.test,x==1 & group == "FU2 data collected after COVID-19")$std.error)^2 +
                                                                                                     (subset(sleep3.test,x==1 & group == "FU2 data collected before COVID-19")$std.error^2))/2))

z.8<- (subset(sleep3.test,x==2 & group == "FU2 data collected after COVID-19")$predicted - 
         subset(sleep3.test,x==2 & group == "FU2 data collected before COVID-19")$predicted) / (sqrt(((subset(sleep3.test,x==2 & group == "FU2 data collected after COVID-19")$std.error)^2 +
                                                                                                     (subset(sleep3.test,x==2 & group == "FU2 data collected before COVID-19")$std.error^2))/2))

#z-scores
z.7
z.8
```

p-values for z-scores
```{r}
2*pnorm(z.7, mean = 0, sd = 1, lower.tail = FALSE)
2*pnorm(z.8, mean = 0, sd = 1, lower.tail = FALSE)
```

#### 16.9.1.4) Graph of predicted probabilities
```{r}
ggpredict(sleep3, c("timefactor", "Pandemic")) %>% plot()
```


### 16.9.2) Full model adjusted for baseline (age and sex differences)

#### 16.9.2.1) Model
```{r}
sleep4 <- glmer(
  RSTLS_Sleep ~ timefactor*Pandemic*Age_sex + RSTLS_Sleepbaseline + Education + Ethnicity + IncomeLevel + BMI + CESD.10baseline + SmokingStatus + 
    Relationshipstatus + Livingstatus + Anxiety + MoodDisord + Chronicconditions + 
    (1|ID), 
  data = truncated.data_long_2, 
  family = binomial(link = "logit")
)

sleep4
```

#### 16.9.2.2) Predicted probabilities

```{r}
ggpredict(sleep4, c("Pandemic","timefactor","Age_sex"))
```

#### 16.9.2.3) Contrasts for predicted probilities

Mean differences and 95% CIs
```{r}
sleep.test4 <- as.data.frame(ggpredict(sleep4, c("timefactor", "Pandemic", "Age_sex")))

#Females 45-64 years
mean.diff.Females.Young.7<-(subset(sleep.test4,x==1 & group == "FU2 data collected after COVID-19" & facet == "Females 45-64")$predicted - 
         subset(sleep.test4,x==1 & group == "FU2 data collected before COVID-19" & facet == "Females 45-64")$predicted)
         
se.Females.Young.7<-(sqrt(((subset(sleep.test4,x==1 & group == "FU2 data collected after COVID-19" & facet == "Females 45-64")$std.error)^2 +
     (subset(sleep.test4,x==1 & group == "FU2 data collected before COVID-19" & facet == "Females 45-64")$std.error^2))/2))

UL.Females.Young.7<-mean.diff.Females.Young.7 + se.Females.Young.7*1.96
LL.Females.Young.7<-mean.diff.Females.Young.7 - se.Females.Young.7*1.96

mean.diff.Females.Young.8<-(subset(sleep.test4,x==2 & group == "FU2 data collected after COVID-19" & facet == "Females 45-64")$predicted - 
         subset(sleep.test4,x==2 & group == "FU2 data collected before COVID-19" & facet == "Females 45-64")$predicted)
         
se.Females.Young.8<-(sqrt(((subset(sleep.test4,x==2 & group == "FU2 data collected after COVID-19" & facet == "Females 45-64")$std.error)^2 +
     (subset(sleep.test4,x==2 & group == "FU2 data collected before COVID-19" & facet == "Females 45-64")$std.error^2))/2))

UL.Females.Young.8<-mean.diff.Females.Young.8 + se.Females.Young.8*1.96
LL.Females.Young.8<-mean.diff.Females.Young.8 - se.Females.Young.8*1.96

#Females 65+ years
mean.diff.Females.Old.7<-(subset(sleep.test4,x==1 & group == "FU2 data collected after COVID-19" & facet == "Females 65+")$predicted - 
         subset(sleep.test4,x==1 & group == "FU2 data collected before COVID-19" & facet == "Females 65+")$predicted)
         
se.Females.Old.7<-(sqrt(((subset(sleep.test4,x==1 & group == "FU2 data collected after COVID-19" & facet == "Females 65+")$std.error)^2 +
     (subset(sleep.test4,x==1 & group == "FU2 data collected before COVID-19" & facet == "Females 65+")$std.error^2))/2))

UL.Females.Old.7<-mean.diff.Females.Old.7 + se.Females.Old.7*1.96
LL.Females.Old.7<-mean.diff.Females.Old.7 - se.Females.Old.7*1.96

mean.diff.Females.Old.8<-(subset(sleep.test4,x==2 & group == "FU2 data collected after COVID-19" & facet == "Females 65+")$predicted - 
         subset(sleep.test4,x==2 & group == "FU2 data collected before COVID-19" & facet == "Females 65+")$predicted)
         
se.Females.Old.8<-(sqrt(((subset(sleep.test4,x==2 & group == "FU2 data collected after COVID-19" & facet == "Females 65+")$std.error)^2 +
     (subset(sleep.test4,x==2 & group == "FU2 data collected before COVID-19" & facet == "Females 65+")$std.error^2))/2))

UL.Females.Old.8<-mean.diff.Females.Old.8 + se.Females.Old.8*1.96
LL.Females.Old.8<-mean.diff.Females.Old.8 - se.Females.Old.8*1.96

#Males 45-64 years
mean.diff.Males.Young.7<-(subset(sleep.test4,x==1 & group == "FU2 data collected after COVID-19" & facet == "Males 45-64")$predicted - 
         subset(sleep.test4,x==1 & group == "FU2 data collected before COVID-19" & facet == "Males 45-64")$predicted)
         
se.Males.Young.7<-(sqrt(((subset(sleep.test4,x==1 & group == "FU2 data collected after COVID-19" & facet == "Males 45-64")$std.error)^2 +
     (subset(sleep.test4,x==1 & group == "FU2 data collected before COVID-19" & facet == "Males 45-64")$std.error^2))/2))

UL.Males.Young.7<-mean.diff.Males.Young.7 + se.Males.Young.7*1.96
LL.Males.Young.7<-mean.diff.Males.Young.7 - se.Males.Young.7*1.96

mean.diff.Males.Young.8<-(subset(sleep.test4,x==2 & group == "FU2 data collected after COVID-19" & facet == "Males 45-64")$predicted - 
         subset(sleep.test4,x==2 & group == "FU2 data collected before COVID-19" & facet == "Males 45-64")$predicted)
         
se.Males.Young.8<-(sqrt(((subset(sleep.test4,x==2 & group == "FU2 data collected after COVID-19" & facet == "Males 45-64")$std.error)^2 +
     (subset(sleep.test4,x==2 & group == "FU2 data collected before COVID-19" & facet == "Males 45-64")$std.error^2))/2))

UL.Males.Young.8<-mean.diff.Males.Young.8 + se.Males.Young.8*1.96
LL.Males.Young.8<-mean.diff.Males.Young.8 - se.Males.Young.8*1.96

#Males 65+ years
mean.diff.Males.Old.7<-(subset(sleep.test4,x==1 & group == "FU2 data collected after COVID-19" & facet == "Males 65+")$predicted - 
         subset(sleep.test4,x==1 & group == "FU2 data collected before COVID-19" & facet == "Males 65+")$predicted)
         
se.Males.Old.7<-(sqrt(((subset(sleep.test4,x==1 & group == "FU2 data collected after COVID-19" & facet == "Males 65+")$std.error)^2 +
     (subset(sleep.test4,x==1 & group == "FU2 data collected before COVID-19" & facet == "Males 65+")$std.error^2))/2))

UL.Males.Old.7<-mean.diff.Males.Old.7 + se.Males.Old.7*1.96
LL.Males.Old.7<-mean.diff.Males.Old.7 - se.Males.Old.7*1.96

mean.diff.Males.Old.8<-(subset(sleep.test4,x==2 & group == "FU2 data collected after COVID-19" & facet == "Males 65+")$predicted - 
         subset(sleep.test4,x==2 & group == "FU2 data collected before COVID-19" & facet == "Males 65+")$predicted)
         
se.Males.Old.8<-(sqrt(((subset(sleep.test4,x==2 & group == "FU2 data collected after COVID-19" & facet == "Males 65+")$std.error)^2 +
     (subset(sleep.test4,x==2 & group == "FU2 data collected before COVID-19" & facet == "Males 65+")$std.error^2))/2))

UL.Males.Old.8<-mean.diff.Males.Old.8 + se.Males.Old.8*1.96
LL.Males.Old.8<-mean.diff.Males.Old.8 - se.Males.Old.8*1.96



#Mean differences and LL and UL
mean.diff.Females.Young.7
UL.Females.Young.7
LL.Females.Young.7

mean.diff.Females.Young.8
UL.Females.Young.8
LL.Females.Young.8

mean.diff.Females.Old.7
UL.Females.Old.7
LL.Females.Old.7

mean.diff.Females.Old.8
UL.Females.Old.8
LL.Females.Old.8

mean.diff.Males.Young.7
UL.Males.Young.7
LL.Males.Young.7

mean.diff.Males.Young.8
UL.Males.Young.8
LL.Males.Young.8

mean.diff.Males.Old.7
UL.Males.Old.7
LL.Males.Old.7

mean.diff.Males.Old.8
UL.Males.Old.8
LL.Males.Old.8
```

Z-scores
```{r}

z.Females.Young.7 <- (subset(sleep.test4,x==1 & group == "FU2 data collected after COVID-19" & facet == "Females 45-64")$predicted - 
                        subset(sleep.test4,x==1 & group == "FU2 data collected before COVID-19" & facet == "Females 45-64")$predicted) / (sqrt(((subset(sleep.test4,x==1 & group == "FU2 data collected after COVID-19" & facet == "Females 45-64")$std.error)^2 +
                                                                                                                                                (subset(sleep.test4,x==1 & group == "FU2 data collected before COVID-19" & facet == "Females 45-64")$std.error^2))/2))

z.Females.Young.8 <- (subset(sleep.test4,x==2 & group == "FU2 data collected after COVID-19" & facet == "Females 45-64")$predicted - 
                        subset(sleep.test4,x==2 & group == "FU2 data collected before COVID-19" & facet == "Females 45-64")$predicted) / (sqrt(((subset(sleep.test4,x==2 & group == "FU2 data collected after COVID-19" & facet == "Females 45-64")$std.error)^2 +
                                                                                                                                                (subset(sleep.test4,x==2 & group == "FU2 data collected before COVID-19" & facet == "Females 45-64")$std.error^2))/2))

z.Females.Old.7 <- (subset(sleep.test4,x==1 & group == "FU2 data collected after COVID-19" & facet == "Females 65+")$predicted - 
                      subset(sleep.test4,x==1 & group == "FU2 data collected before COVID-19" & facet == "Females 65+")$predicted) / (sqrt(((subset(sleep.test4,x==1 & group == "FU2 data collected after COVID-19" & facet == "Females 65+")$std.error)^2 +
                                                                                                                                            (subset(sleep.test4,x==1 & group == "FU2 data collected before COVID-19" & facet == "Females 65+")$std.error^2))/2))

z.Females.Old.8 <- (subset(sleep.test4,x==2 & group == "FU2 data collected after COVID-19" & facet == "Females 65+")$predicted - 
                      subset(sleep.test4,x==2 & group == "FU2 data collected before COVID-19" & facet == "Females 65+")$predicted) / (sqrt(((subset(sleep.test4,x==2 & group == "FU2 data collected after COVID-19" & facet == "Females 65+")$std.error)^2 +
                                                                                                                                            (subset(sleep.test4,x==2 & group == "FU2 data collected before COVID-19" & facet == "Females 65+")$std.error^2))/2))

z.Males.Young.7 <- (subset(sleep.test4,x==1 & group == "FU2 data collected after COVID-19" & facet == "Males 45-64")$predicted - 
                      subset(sleep.test4,x==1 & group == "FU2 data collected before COVID-19" & facet == "Males 45-64")$predicted) / (sqrt(((subset(sleep.test4,x==1 & group == "FU2 data collected after COVID-19" & facet == "Males 45-64")$std.error)^2 +
                                                                                                                                            (subset(sleep.test4,x==1 & group == "FU2 data collected before COVID-19" & facet == "Males 45-64")$std.error^2))/2))

z.Males.Young.8 <- (subset(sleep.test4,x==2 & group == "FU2 data collected after COVID-19" & facet == "Males 45-64")$predicted - 
                      subset(sleep.test4,x==2 & group == "FU2 data collected before COVID-19" & facet == "Males 45-64")$predicted) / (sqrt(((subset(sleep.test4,x==2 & group == "FU2 data collected after COVID-19" & facet == "Males 45-64")$std.error)^2 +
                                                                                                                                            (subset(sleep.test4,x==2 & group == "FU2 data collected before COVID-19" & facet == "Males 45-64")$std.error^2))/2))

z.Males.Old.7 <- (subset(sleep.test4,x==1 & group == "FU2 data collected after COVID-19" & facet == "Males 65+")$predicted - 
                    subset(sleep.test4,x==1 & group == "FU2 data collected before COVID-19" & facet == "Males 65+")$predicted) / (sqrt(((subset(sleep.test4,x==1 & group == "FU2 data collected after COVID-19" & facet == "Males 65+")$std.error)^2 +
                                                                                                                                        (subset(sleep.test4,x==1 & group == "FU2 data collected before COVID-19" & facet == "Males 65+")$std.error^2))/2))

z.Males.Old.8 <- (subset(sleep.test4,x==2 & group == "FU2 data collected after COVID-19" & facet == "Males 65+")$predicted - 
                    subset(sleep.test4,x==2 & group == "FU2 data collected before COVID-19" & facet == "Males 65+")$predicted) / (sqrt(((subset(sleep.test4,x==2 & group == "FU2 data collected after COVID-19" & facet == "Males 65+")$std.error)^2 +
                                                                                                                                        (subset(sleep.test4,x==2 & group == "FU2 data collected before COVID-19" & facet == "Males 65+")$std.error^2))/2))

#z-scores
z.Females.Young.7
z.Females.Young.8

z.Males.Young.7
z.Males.Young.8

z.Females.Old.7
z.Females.Old.8

z.Males.Old.7
z.Males.Old.8
```

p-values for z-scores
```{r}
2*pnorm(z.Females.Young.7, mean = 0, sd = 1, lower.tail = FALSE)
2*pnorm(z.Females.Young.8, mean = 0, sd = 1, lower.tail = FALSE)

2*pnorm(z.Males.Young.7, mean = 0, sd = 1, lower.tail = FALSE)
2*pnorm(z.Males.Young.8, mean = 0, sd = 1, lower.tail = FALSE)

2*pnorm(z.Females.Old.7, mean = 0, sd = 1, lower.tail = FALSE)
2*pnorm(z.Females.Old.8, mean = 0, sd = 1, lower.tail = FALSE)

2*pnorm(z.Males.Old.7, mean = 0, sd = 1, lower.tail = FALSE)
2*pnorm(z.Males.Old.8, mean = 0, sd = 1, lower.tail = FALSE)
```

#### 16.9.2.4) Graph of predicted probabilities
```{r}
ggpredict(sleep4, c("timefactor","Pandemic","Age_sex")) %>% plot()
```




